(function(){function a(a,b){return a.set(b[0],b[1]),a}function b(a,b){return a.add(b),a}function c(a,b,c){switch(c.length){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}function d(a,b,c,d){for(var e=-1,f=a.length;++e<f;){var g=a[e];b(d,g,c(g),a)}return d}function e(a,b){for(var c=-1,d=a.length,e=-1,f=b.length,g=Array(d+f);++c<d;)g[c]=a[c];for(;++e<f;)g[c++]=b[e];return g}function f(a,b){for(var c=-1,d=a.length;++c<d&&!1!==b(a[c],c,a););return a}function g(a,b){for(var c=a.length;c--&&!1!==b(a[c],c,a););return a}function h(a,b){for(var c=-1,d=a.length;++c<d;)if(!b(a[c],c,a))return!1;return!0}function i(a,b){for(var c=-1,d=a.length,e=0,f=[];++c<d;){var g=a[c];b(g,c,a)&&(f[e++]=g)}return f}function j(a,b){return!!a.length&&t(a,b,0)>-1}function k(a,b,c){for(var d=-1,e=a.length;++d<e;)if(c(b,a[d]))return!0;return!1}function l(a,b){for(var c=-1,d=a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function m(a,b){for(var c=-1,d=b.length,e=a.length;++c<d;)a[e+c]=b[c];return a}function n(a,b,c,d){var e=-1,f=a.length;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}function o(a,b,c,d){var e=a.length;for(d&&e&&(c=a[--e]);e--;)c=b(c,a[e],e,a);return c}function p(a,b){for(var c=-1,d=a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}function q(a,b,c){for(var d=-1,e=a.length;++d<e;){var f=a[d],g=b(f);if(null!=g&&(h===W?g===g:c(g,h)))var h=g,i=f}return i}function r(a,b,c,d){var e;return c(a,function(a,c,f){if(b(a,c,f))return e=d?c:a,!1}),e}function s(a,b,c){for(var d=a.length,e=c?d:-1;c?e--:++e<d;)if(b(a[e],e,a))return e;return-1}function t(a,b,c){if(b!==b)return L(a,c);for(var d=c-1,e=a.length;++d<e;)if(a[d]===b)return d;return-1}function u(a,b,c,d){for(var e=c-1,f=a.length;++e<f;)if(d(a[e],b))return e;return-1}function v(a,b,c,d,e){return e(a,function(a,e,f){c=d?(d=!1,a):b(c,a,e,f)}),c}function w(a,b){var c=a.length;for(a.sort(b);c--;)a[c]=a[c].value;return a}function x(a,b){for(var c,d=-1,e=a.length;++d<e;){var f=b(a[d]);f!==W&&(c=c===W?f:c+f)}return c}function y(a,b){for(var c=-1,d=Array(a);++c<a;)d[c]=b(c);return d}function z(a,b){return l(b,function(b){return[b,a[b]]})}function A(a){return function(b){return a(b)}}function B(a,b){return l(b,function(b){return a[b]})}function C(a,b){for(var c=-1,d=a.length;++c<d&&t(b,a[c],0)>-1;);return c}function D(a,b){for(var c=a.length;c--&&t(b,a[c],0)>-1;);return c}function E(a){return a&&a.Object===Object?a:null}function F(a,b){if(a!==b){var c=null===a,d=a===W,e=a===a,f=null===b,g=b===W,h=b===b;if(a>b&&!f||!e||c&&!g&&h||d&&h)return 1;if(a<b&&!c||!h||f&&!d&&e||g&&e)return-1}return 0}function G(a,b,c){for(var d=-1,e=a.criteria,f=b.criteria,g=e.length,h=c.length;++d<g;){var i=F(e[d],f[d]);if(i){if(d>=h)return i;return i*("desc"==c[d]?-1:1)}}return a.index-b.index}function H(a,b){for(var c=a.length,d=0;c--;)a[c]===b&&d++;return d}function I(a){return _b[a]}function J(a){return ac[a]}function K(a){return"\\"+dc[a]}function L(a,b,c){for(var d=a.length,e=b+(c?0:-1);c?e--:++e<d;){var f=a[e];if(f!==f)return e}return-1}function M(a){var b=!1;if(null!=a&&"function"!=typeof a.toString)try{b=!!(a+"")}catch(a){}return b}function N(a,b){return a="number"==typeof a||yb.test(a)?+a:-1,b=null==b?ua:b,a>-1&&a%1==0&&a<b}function O(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function P(a){var b=-1,c=Array(a.size);return a.forEach(function(a,d){c[++b]=[d,a]}),c}function Q(a,b){for(var c=-1,d=a.length,e=0,f=[];++c<d;){var g=a[c];g!==b&&g!==_||(a[c]=_,f[e++]=c)}return f}function R(a){var b=-1,c=Array(a.size);return a.forEach(function(a){c[++b]=a}),c}function S(a){if(!a||!Tb.test(a))return a.length;for(var b=Sb.lastIndex=0;Sb.test(a);)b++;return b}function T(a){return a.match(Sb)}function U(a){return bc[a]}function V(E){function yb(a){if(Og(a)&&!zk(a)&&!(a instanceof Eb)){if(a instanceof Db)return a;if(Vi.call(a,"__wrapped__"))return He(a)}return new Db(a)}function Cb(){}function Db(a,b){this.__wrapped__=a,this.__actions__=[],this.__chain__=!!b,this.__index__=0,this.__values__=W}function Eb(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=xa,this.__views__=[]}function Fb(){var a=new Eb(this.__wrapped__);return a.__actions__=Md(this.__actions__),a.__dir__=this.__dir__,a.__filtered__=this.__filtered__,a.__iteratees__=Md(this.__iteratees__),a.__takeCount__=this.__takeCount__,a.__views__=Md(this.__views__),a}function Gb(){if(this.__filtered__){var a=new Eb(this);a.__dir__=-1,a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a}function Hb(){var a=this.__wrapped__.value(),b=this.__dir__,c=zk(a),d=b<0,e=c?a.length:0,f=qe(0,e,this.__views__),g=f.start,h=f.end,i=h-g,j=d?h:g-1,k=this.__iteratees__,l=k.length,m=0,n=sj(i,this.__takeCount__);if(!c||e<Y||e==i&&n==i)return Ad(a,this.__actions__);var o=[];a:for(;i--&&m<n;){j+=b;for(var p=-1,q=a[j];++p<l;){var r=k[p],s=r.iteratee,t=r.type,u=s(q);if(t==ra)q=u;else if(!u){if(t==qa)continue a;break a}}o[m++]=q}return o}function Ib(){}function Jb(a,b){return Lb(a,b)&&delete a[b]}function Kb(a,b){if(zj){var c=a[b];return c===$?W:c}return Vi.call(a,b)?a[b]:W}function Lb(a,b){return zj?a[b]!==W:Vi.call(a,b)}function Mb(a,b,c){a[b]=zj&&c===W?$:c}function Nb(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Ob(){this.__data__={hash:new Ib,map:wj?new wj:[],string:new Ib}}function Pb(a){var b=this.__data__;return ye(a)?Jb("string"==typeof a?b.string:b.hash,a):wj?b.map.delete(a):mc(b.map,a)}function Qb(a){var b=this.__data__;return ye(a)?Kb("string"==typeof a?b.string:b.hash,a):wj?b.map.get(a):pc(b.map,a)}function Sb(a){var b=this.__data__;return ye(a)?Lb("string"==typeof a?b.string:b.hash,a):wj?b.map.has(a):qc(b.map,a)}function _b(a,b){var c=this.__data__;return ye(a)?Mb("string"==typeof a?c.string:c.hash,a,b):wj?c.map.set(a,b):sc(c.map,a,b),this}function ac(a){var b=-1,c=a?a.length:0;for(this.__data__=new Nb;++b<c;)this.push(a[b])}function bc(a,b){var c=a.__data__;if(ye(b)){var d=c.__data__;return("string"==typeof b?d.string:d.hash)[b]===$}return c.has(b)}function cc(a){var b=this.__data__;if(ye(a)){var c=b.__data__;("string"==typeof a?c.string:c.hash)[a]=$}else b.set(a,$)}function dc(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function gc(){this.__data__={array:[],map:null}}function hc(a){var b=this.__data__,c=b.array;return c?mc(c,a):b.map.delete(a)}function jc(a){var b=this.__data__,c=b.array;return c?pc(c,a):b.map.get(a)}function kc(a){var b=this.__data__,c=b.array;return c?qc(c,a):b.map.has(a)}function lc(a,b){var c=this.__data__,d=c.array;d&&(d.length<Y-1?sc(d,a,b):(c.array=null,c.map=new Nb(d)));var e=c.map;return e&&e.set(a,b),this}function mc(a,b){var c=rc(a,b);return!(c<0)&&(c==a.length-1?a.pop():lj.call(a,c,1),!0)}function pc(a,b){var c=rc(a,b);return c<0?W:a[c][1]}function qc(a,b){return rc(a,b)>-1}function rc(a,b){for(var c=a.length;c--;)if(vg(a[c][0],b))return c;return-1}function sc(a,b,c){var d=rc(a,b);d<0?a.push([b,c]):a[d][1]=c}function tc(a,b,c,d){return a===W||vg(a,Ti[c])&&!Vi.call(d,c)?b:a}function uc(a,b,c){(c===W||vg(a[b],c))&&("number"!=typeof b||c!==W||b in a)||(a[b]=c)}function vc(a,b,c){var d=a[b];Vi.call(a,b)&&vg(d,c)&&(c!==W||b in a)||(a[b]=c)}function wc(a,b,c,d){return Jj(a,function(a,e,f){b(d,a,c(a),f)}),d}function xc(a,b){return a&&Nd(b,Ah(b),a)}function yc(a,b){for(var c=-1,d=null==a,e=b.length,f=Array(e);++c<e;)f[c]=d?W:xh(a,b[c]);return f}function zc(a){return Bg(a)?a:[]}function Ac(a){return"function"==typeof a?a:ri}function Bc(a){return zk(a)?a:Ge(a)}function Cc(a,b,c){return a===a&&(c!==W&&(a=a<=c?a:c),b!==W&&(a=a>=b?a:b)),a}function Dc(a,b,c,d,e,g,h){var i;if(d&&(i=g?d(a,e,g,h):d(a)),i!==W)return i;if(!Ng(a))return a;var j=zk(a);if(j){if(i=se(a),!b)return Md(a,i)}else{var k=pe(a),l=k==Fa||k==Ga;if(Ak(a))return Dd(a,b);if(k==Ja||k==Aa||l&&!g){if(M(a))return g?a:{};if(i=te(l?{}:a),!b)return i=xc(i,a),c?Pd(a,i):i}else{if(!$b[k])return g?a:{};i=ue(a,k,b)}}h||(h=new dc);var m=h.get(a);return m||(h.set(a,i),(j?f:Nc)(a,function(e,f){vc(i,f,Dc(e,b,c,d,f,a,h))}),c&&!j?Pd(a,i):i)}function Ec(a){var b=Ah(a),c=b.length;return function(d){if(null==d)return!c;for(var e=c;e--;){var f=b[e],g=a[f],h=d[f];if(h===W&&!(f in Object(d))||!g(h))return!1}return!0}}function Fc(a){return Ng(a)?ij(a):{}}function Gc(a,b,c){if("function"!=typeof a)throw new Ri(Z);return kj(function(){a.apply(W,c)},b)}function Hc(a,b,c,d){var e=-1,f=j,g=!0,h=a.length,i=[],m=b.length;if(!h)return i;c&&(b=l(b,A(c))),d?(f=k,g=!1):b.length>=Y&&(f=bc,g=!1,b=new ac(b));a:for(;++e<h;){var n=a[e],o=c?c(n):n;if(g&&o===o){for(var p=m;p--;)if(b[p]===o)continue a;i.push(n)}else f(b,o,d)||i.push(n)}return i}function Ic(a,b){var c=!0;return Jj(a,function(a,d,e){return c=!!b(a,d,e)}),c}function Jc(a,b,c,d){var e=a.length;for(c=ih(c),c<0&&(c=-c>e?0:e+c),d=d===W||d>e?e:ih(d),d<0&&(d+=e),d=c>d?0:jh(d);c<d;)a[c++]=b;return a}function Kc(a,b){var c=[];return Jj(a,function(a,d,e){b(a,d,e)&&c.push(a)}),c}function Lc(a,b,c,d){d||(d=[]);for(var e=-1,f=a.length;++e<f;){var g=a[e];b>0&&Bg(g)&&(c||zk(g)||yg(g))?b>1?Lc(g,b-1,c,d):m(d,g):c||(d[d.length]=g)}return d}function Mc(a,b){return null==a?a:Lj(a,b,Bh)}function Nc(a,b){return a&&Lj(a,b,Ah)}function Oc(a,b){return a&&Mj(a,b,Ah)}function Pc(a,b){return i(b,function(b){return Kg(a[b])})}function Qc(a,b){b=xe(b,a)?[b+""]:Bc(b);for(var c=0,d=b.length;null!=a&&c<d;)a=a[b[c++]];return c&&c==d?a:W}function Rc(a,b){return Vi.call(a,b)||"object"==typeof a&&b in a&&null===fj(a)}function Sc(a,b){return b in Object(a)}function Tc(a,b,c){return a>=sj(b,c)&&a<rj(b,c)}function Uc(a,b,c){for(var d=c?k:j,e=a[0].length,f=a.length,g=f,h=Array(f),i=1/0,m=[];g--;){var n=a[g];g&&b&&(n=l(n,A(b))),i=sj(n.length,i),h[g]=!c&&(b||e>=120&&n.length>=120)?new ac(g&&n):W}n=a[0];var o=-1,p=h[0];a:for(;++o<e&&m.length<i;){var q=n[o],r=b?b(q):q;if(!(p?bc(p,r):d(m,r,c))){for(g=f;--g;){var s=h[g];if(!(s?bc(s,r):d(a[g],r,c)))continue a}p&&p.push(r),m.push(q)}}return m}function Vc(a,b,c,d){return Nc(a,function(a,e,f){b(d,c(a),e,f)}),d}function Wc(a,b,d){xe(b,a)||(b=Bc(b),a=Ee(a,b),b=Ze(b));var e=null==a?a:a[b];return null==e?W:c(e,a,d)}function Xc(a,b,c,d,e){return a===b||(null==a||null==b||!Ng(a)&&!Og(b)?a!==a&&b!==b:Yc(a,b,Xc,c,d,e))}function Yc(a,b,c,d,e,f){var g=zk(a),h=zk(b),i=Ba,j=Ba;g||(i=pe(a),i=i==Aa?Ja:i),h||(j=pe(b),j=j==Aa?Ja:j);var k=i==Ja&&!M(a),l=j==Ja&&!M(b),m=i==j;if(m&&!k)return f||(f=new dc),g||bh(a)?he(a,b,c,d,e,f):ie(a,b,i,c,d,e,f);if(!(e&la)){var n=k&&Vi.call(a,"__wrapped__"),o=l&&Vi.call(b,"__wrapped__");if(n||o)return f||(f=new dc),c(n?a.value():a,o?b.value():b,d,e,f)}return!!m&&(f||(f=new dc),je(a,b,c,d,e,f))}function Zc(a,b,c,d){var e=c.length,f=e,g=!d;if(null==a)return!f;for(a=Object(a);e--;){var h=c[e];if(g&&h[2]?h[1]!==a[h[0]]:!(h[0]in a))return!1}for(;++e<f;){h=c[e];var i=h[0],j=a[i],k=h[1];if(g&&h[2]){if(j===W&&!(i in a))return!1}else{var l=new dc,m=d?d(j,k,i,a,b,l):W;if(!(m===W?Xc(k,j,d,ka|la,l):m))return!1}}return!0}function $c(a){var b=typeof a;return"function"==b?a:null==a?ri:"object"==b?zk(a)?dd(a[0],a[1]):cd(a):zi(a)}function _c(a){return qj(Object(a))}function ad(a){a=null==a?a:Object(a);var b=[];for(var c in a)b.push(c);return b}function bd(a,b){var c=-1,d=Ag(a)?Array(a.length):[];return Jj(a,function(a,e,f){d[++c]=b(a,e,f)}),d}function cd(a){var b=me(a);if(1==b.length&&b[0][2]){var c=b[0][0],d=b[0][1];return function(a){return null!=a&&(a[c]===d&&(d!==W||c in Object(a)))}}return function(c){return c===a||Zc(c,a,b)}}function dd(a,b){return function(c){var d=xh(c,a);return d===W&&d===b?zh(c,a):Xc(b,d,W,ka|la)}}function ed(a,b,c,d,e){if(a!==b){var g=zk(b)||bh(b)?W:Bh(b);f(g||b,function(f,h){if(g&&(h=f,f=b[h]),Ng(f))e||(e=new dc),fd(a,b,h,c,ed,d,e);else{var i=d?d(a[h],f,h+"",a,b,e):W;i===W&&(i=f),uc(a,h,i)}})}}function fd(a,b,c,d,e,f,g){var h=a[c],i=b[c],j=g.get(i);if(j)return void uc(a,c,j);var k=f?f(h,i,c+"",a,b,g):W,l=k===W;l&&(k=i,zk(i)||bh(i)?zk(h)?k=h:Bg(h)?k=Md(h):(l=!1,k=Dc(i,!f)):Xg(i)||yg(i)?yg(h)?k=lh(h):!Ng(h)||d&&Kg(h)?(l=!1,k=Dc(i,!f)):k=h:l=!1),g.set(i,k),l&&e(k,i,d,f,g),g.delete(i),uc(a,c,k)}function gd(a,b,c){var d=-1;return b=l(b.length?b:Array(1),le()),w(bd(a,function(a,c,e){return{criteria:l(b,function(b){return b(a)}),index:++d,value:a}}),function(a,b){return G(a,b,c)})}function hd(a,b){return a=Object(a),n(b,function(b,c){return c in a&&(b[c]=a[c]),b},{})}function id(a,b){var c={};return Mc(a,function(a,d){b(a,d)&&(c[d]=a)}),c}function jd(a){return function(b){return null==b?W:b[a]}}function kd(a){return function(b){return Qc(b,a)}}function ld(a,b,c,d){var e=d?u:t,f=-1,g=b.length,h=a;for(c&&(h=l(a,A(c)));++f<g;)for(var i=0,j=b[f],k=c?c(j):j;(i=e(h,k,i,d))>-1;)h!==a&&lj.call(h,i,1),lj.call(a,i,1);return a}function md(a,b){for(var c=a?b.length:0,d=c-1;c--;){var e=b[c];if(d==c||e!=f){var f=e;if(N(e))lj.call(a,e,1);else if(xe(e,a))delete a[e];else{var g=Bc(e),h=Ee(a,g);null!=h&&delete h[Ze(g)]}}}return a}function nd(a,b){return a+nj(uj()*(b-a+1))}function od(a,b,c,d){for(var e=-1,f=rj(mj((b-a)/(c||1)),0),g=Array(f);f--;)g[d?f:++e]=a,a+=c;return g}function pd(a,b,c,d){b=xe(b,a)?[b+""]:Bc(b);for(var e=-1,f=b.length,g=f-1,h=a;null!=h&&++e<f;){var i=b[e];if(Ng(h)){var j=c;if(e!=g){var k=h[i];j=d?d(k,i,h):W,j===W&&(j=null==k?N(b[e+1])?[]:{}:k)}vc(h,i,j)}h=h[i]}return a}function qd(a,b,c){var d=-1,e=a.length;b<0&&(b=-b>e?0:e+b),c=c>e?e:c,c<0&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=Array(e);++d<e;)f[d]=a[d+b];return f}function rd(a,b){var c;return Jj(a,function(a,d,e){return!(c=b(a,d,e))}),!!c}function sd(a,b,c){var d=0,e=a?a.length:d;if("number"==typeof b&&b===b&&e<=za){for(;d<e;){var f=d+e>>>1,g=a[f];(c?g<=b:g<b)&&null!==g?d=f+1:e=f}return e}return td(a,b,ri,c)}function td(a,b,c,d){b=c(b);for(var e=0,f=a?a.length:0,g=b!==b,h=null===b,i=b===W;e<f;){var j=nj((e+f)/2),k=c(a[j]),l=k!==W,m=k===k;if(g)var n=m||d;else n=h?m&&l&&(d||null!=k):i?m&&(d||l):null!=k&&(d?k<=b:k<b);n?e=j+1:f=j}return sj(f,ya)}function ud(a){return vd(a)}function vd(a,b){for(var c=0,d=a.length,e=a[0],f=b?b(e):e,g=f,h=1,i=[e];++c<d;)e=a[c],f=b?b(e):e,vg(f,g)||(g=f,i[h++]=e);return i}function wd(a,b,c){var d=-1,e=j,f=a.length,g=!0,h=[],i=h;if(c)g=!1,e=k;else if(f>=Y){var l=b?null:Oj(a);if(l)return R(l);g=!1,e=bc,i=new ac}else i=b?[]:h;a:for(;++d<f;){var m=a[d],n=b?b(m):m;if(g&&n===n){for(var o=i.length;o--;)if(i[o]===n)continue a;b&&i.push(n),h.push(m)}else e(i,n,c)||(i!==h&&i.push(n),h.push(m))}return h}function xd(a,b){b=xe(b,a)?[b+""]:Bc(b),a=Ee(a,b);var c=Ze(b);return null==a||!yh(a,c)||delete a[c]}function yd(a,b,c,d){return pd(a,b,c(Qc(a,b)),d)}function zd(a,b,c,d){for(var e=a.length,f=d?e:-1;(d?f--:++f<e)&&b(a[f],f,a););return c?qd(a,d?0:f,d?f+1:e):qd(a,d?f+1:0,d?e:f)}function Ad(a,b){var c=a;return c instanceof Eb&&(c=c.value()),n(b,function(a,b){return b.func.apply(b.thisArg,m([a],b.args))},c)}function Bd(a,b,c){for(var d=-1,e=a.length;++d<e;)var f=f?m(Hc(f,a[d],b,c),Hc(a[d],f,b,c)):a[d];return f&&f.length?wd(f,b,c):[]}function Cd(a,b,c){for(var d=-1,e=a.length,f=b.length,g={};++d<e;)c(g,a[d],d<f?b[d]:W);return g}function Dd(a,b){if(b)return a.slice();var c=new a.constructor(a.length);return a.copy(c),c}function Ed(a){var b=new a.constructor(a.byteLength);return new cj(b).set(new cj(a)),b}function Fd(b){return n(P(b),a,new b.constructor)}function Gd(a){var b=new a.constructor(a.source,sb.exec(a));return b.lastIndex=a.lastIndex,b}function Hd(a){return n(R(a),b,new a.constructor)}function Id(a){return Hj?Object(Hj.call(a)):{}}function Jd(a,b){var c=b?Ed(a.buffer):a.buffer;return new a.constructor(c,a.byteOffset,a.length)}function Kd(a,b,c,d){for(var e=-1,f=a.length,g=c.length,h=-1,i=b.length,j=rj(f-g,0),k=Array(i+j),l=!d;++h<i;)k[h]=b[h];for(;++e<g;)(l||e<f)&&(k[c[e]]=a[e]);for(;j--;)k[h++]=a[e++];return k}function Ld(a,b,c,d){for(var e=-1,f=a.length,g=-1,h=c.length,i=-1,j=b.length,k=rj(f-h,0),l=Array(k+j),m=!d;++e<k;)l[e]=a[e];for(var n=e;++i<j;)l[n+i]=b[i];for(;++g<h;)(m||e<f)&&(l[n+c[g]]=a[e++]);return l}function Md(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}function Nd(a,b,c){return Od(a,b,c)}function Od(a,b,c,d){c||(c={});for(var e=-1,f=b.length;++e<f;){var g=b[e];vc(c,g,d?d(c[g],a[g],g,c,a):a[g])}return c}function Pd(a,b){return Nd(a,Rj(a),b)}function Qd(a,b){return function(c,e){var f=zk(c)?d:wc,g=b?b():{};return f(c,a,le(e),g)}}function Rd(a){return lg(function(b,c){var d=-1,e=c.length,f=e>1?c[e-1]:W,g=e>2?c[2]:W;for(f="function"==typeof f?(e--,f):W,g&&we(c[0],c[1],g)&&(f=e<3?W:f,e=1),b=Object(b);++d<e;){var h=c[d];h&&a(b,h,d,f)}return b})}function Sd(a,b){return function(c,d){if(null==c)return c;if(!Ag(c))return a(c,d);for(var e=c.length,f=b?e:-1,g=Object(c);(b?f--:++f<e)&&!1!==d(g[f],f,g););return c}}function Td(a){return function(b,c,d){for(var e=-1,f=Object(b),g=d(b),h=g.length;h--;){var i=g[a?h:++e];if(!1===c(f[i],i,f))break}return b}}function Ud(a,b,c){function d(){return(this&&this!==nc&&this instanceof d?f:a).apply(e?c:this,arguments)}var e=b&aa,f=Xd(a);return d}function Vd(a){return function(b){b=nh(b);var c=Tb.test(b)?T(b):W,d=c?c[0]:b.charAt(0),e=c?c.slice(1).join(""):b.slice(1);return d[a]()+e}}function Wd(a){return function(b){return n(ni(Vh(b)),a,"")}}function Xd(a){return function(){var b=arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var c=Fc(a.prototype),d=a.apply(c,b);return Ng(d)?d:c}}function Yd(a,b,d){function e(){for(var g=arguments.length,h=Array(g),i=g,j=oe(e);i--;)h[i]=arguments[i];var k=g<3&&h[0]!==j&&h[g-1]!==j?[]:Q(h,j);return(g-=k.length)<d?ee(a,b,$d,e.placeholder,W,h,k,W,W,d-g):c(this&&this!==nc&&this instanceof e?f:a,this,h)}var f=Xd(a);return e}function Zd(a){return lg(function(b){b=Lc(b,1);var c=b.length,d=c,e=Db.prototype.thru;for(a&&b.reverse();d--;){var f=b[d];if("function"!=typeof f)throw new Ri(Z);if(e&&!g&&"wrapper"==ke(f))var g=new Db([],!0)}for(d=g?d:c;++d<c;){f=b[d];var h=ke(f),i="wrapper"==h?Pj(f):W;g=i&&ze(i[0])&&i[1]==(ha|da|fa|ia)&&!i[4].length&&1==i[9]?g[ke(i[0])].apply(g,i[3]):1==f.length&&ze(f)?g[h]():g.thru(f)}return function(){var a=arguments,d=a[0];if(g&&1==a.length&&zk(d)&&d.length>=Y)return g.plant(d).value();for(var e=0,f=c?b[e].apply(this,a):d;++e<c;)f=b[e].call(this,f);return f}})}function $d(a,b,c,d,e,f,g,h,i,j){function k(){for(var r=arguments.length,s=r,t=Array(r);s--;)t[s]=arguments[s];if(o)var u=oe(k),v=H(t,u);if(d&&(t=Kd(t,d,e,o)),f&&(t=Ld(t,f,g,o)),r-=v,o&&r<j){var w=Q(t,u);return ee(a,b,$d,k.placeholder,c,t,w,h,i,j-r)}var x=m?c:this,y=n?x[a]:a;return r=t.length,h?t=Fe(t,h):p&&r>1&&t.reverse(),l&&i<r&&(t.length=i),this&&this!==nc&&this instanceof k&&(y=q||Xd(y)),y.apply(x,t)}var l=b&ha,m=b&aa,n=b&ba,o=b&(da|ea),p=b&ja,q=n?W:Xd(a);return k}function _d(a,b){return function(c,d){return Vc(c,a,b(d),{})}}function ae(a){return lg(function(b){return b=l(Lc(b,1),le()),lg(function(d){var e=this;return a(b,function(a){return c(a,e,d)})})})}function be(a,b,c){b=ih(b);var d=S(a);if(!b||d>=b)return"";var e=b-d;c=c===W?" ":c+"";var f=bi(c,mj(e/S(c)));return Tb.test(c)?T(f).slice(0,e).join(""):f.slice(0,e)}function ce(a,b,d,e){function f(){for(var b=-1,i=arguments.length,j=-1,k=e.length,l=Array(k+i),m=this&&this!==nc&&this instanceof f?h:a;++j<k;)l[j]=e[j];for(;i--;)l[j++]=arguments[++b];return c(m,g?d:this,l)}var g=b&aa,h=Xd(a);return f}function de(a){return function(b,c,d){return d&&"number"!=typeof d&&we(b,c,d)&&(c=d=W),b=kh(b),b=b===b?b:0,c===W?(c=b,b=0):c=kh(c)||0,d=d===W?b<c?1:-1:kh(d)||0,od(b,c,d,a)}}function ee(a,b,c,d,e,f,g,h,i,j){var k=b&da,l=h?Md(h):W,m=k?g:W,n=k?W:g,o=k?f:W,p=k?W:f;b|=k?fa:ga,(b&=~(k?ga:fa))&ca||(b&=~(aa|ba));var q=[a,b,e,o,m,p,n,l,i,j],r=c.apply(W,q);return ze(a)&&Sj(r,q),r.placeholder=d,r}function fe(a){var b=Pi[a];return function(a,c){if(a=kh(a),c=ih(c)){var d=(nh(a)+"e").split("e");return d=(nh(b(d[0]+"e"+(+d[1]+c)))+"e").split("e"),+(d[0]+"e"+(+d[1]-c))}return b(a)}}function ge(a,b,c,d,e,f,g,h){var i=b&ba;if(!i&&"function"!=typeof a)throw new Ri(Z);var j=d?d.length:0;if(j||(b&=~(fa|ga),d=e=W),g=g===W?g:rj(ih(g),0),h=h===W?h:ih(h),j-=e?e.length:0,b&ga){var k=d,l=e;d=e=W}var m=i?W:Pj(a),n=[a,b,c,d,e,k,l,f,g,h];if(m&&Ce(n,m),a=n[0],b=n[1],c=n[2],d=n[3],e=n[4],h=n[9]=null==n[9]?i?0:a.length:rj(n[9]-j,0),!h&&b&(da|ea)&&(b&=~(da|ea)),b&&b!=aa)o=b==da||b==ea?Yd(a,b,h):b!=fa&&b!=(aa|fa)||e.length?$d.apply(W,n):ce(a,b,c,d);else var o=Ud(a,b,c);return(m?Nj:Sj)(o,n)}function he(a,b,c,d,e,f){var g=-1,h=e&la,i=e&ka,j=a.length,k=b.length;if(j!=k&&!(h&&k>j))return!1;var l=f.get(a);if(l)return l==b;var m=!0;for(f.set(a,b);++g<j;){var n=a[g],o=b[g];if(d)var q=h?d(o,n,g,b,a,f):d(n,o,g,a,b,f);if(q!==W){if(q)continue;m=!1;break}if(i){if(!p(b,function(a){return n===a||c(n,a,d,e,f)})){m=!1;break}}else if(n!==o&&!c(n,o,d,e,f)){m=!1;break}}return f.delete(a),m}function ie(a,b,c,d,e,f,g){switch(c){case Qa:return!(a.byteLength!=b.byteLength||!d(new cj(a),new cj(b)));case Ca:case Da:return+a==+b;case Ea:return a.name==b.name&&a.message==b.message;case Ia:return a!=+a?b!=+b:a==+b;case Ka:case Ma:return a==b+"";case Ha:var h=P;case La:var i=f&la;if(h||(h=R),a.size!=b.size&&!i)return!1;var j=g.get(a);return j?j==b:he(h(a),h(b),d,e,f|ka,g.set(a,b));case Na:if(Hj)return Hj.call(a)==Hj.call(b)}return!1}function je(a,b,c,d,e,f){var g=e&la,h=Ah(a),i=h.length;if(i!=Ah(b).length&&!g)return!1;for(var j=i;j--;){var k=h[j];if(!(g?k in b:Rc(b,k)))return!1}var l=f.get(a);if(l)return l==b;var m=!0;f.set(a,b);for(var n=g;++j<i;){k=h[j];var o=a[k],p=b[k];if(d)var q=g?d(p,o,k,b,a,f):d(o,p,k,a,b,f);if(!(q===W?o===p||c(o,p,d,e,f):q)){m=!1;break}n||(n="constructor"==k)}if(m&&!n){var r=a.constructor,s=b.constructor;r!=s&&"constructor"in a&&"constructor"in b&&!("function"==typeof r&&r instanceof r&&"function"==typeof s&&s instanceof s)&&(m=!1)}return f.delete(a),m}function ke(a){for(var b=a.name+"",c=Cj[b],d=Vi.call(Cj,b)?c.length:0;d--;){var e=c[d],f=e.func;if(null==f||f==a)return e.name}return b}function le(){var a=yb.iteratee||si;return a=a===si?$c:a,arguments.length?a(arguments[0],arguments[1]):a}function me(a){for(var b=Jh(a),c=b.length;c--;)b[c][2]=Be(b[c][1]);return b}function ne(a,b){var c=a[b];return Tg(c)?c:W}function oe(a){return(Vi.call(yb,"placeholder")?yb:a).placeholder}function pe(a){return Yi.call(a)}function qe(a,b,c){for(var d=-1,e=c.length;++d<e;){var f=c[d],g=f.size;switch(f.type){case"drop":a+=g;break;case"dropRight":b-=g;break;case"take":b=sj(b,a+g);break;case"takeRight":a=rj(a,b-g)}}return{start:a,end:b}}function re(a,b,c){if(null==a)return!1;var d=c(a,b);d||xe(b)||(b=Bc(b),null!=(a=Ee(a,b))&&(b=Ze(b),d=c(a,b)));var e=a?a.length:W;return d||!!e&&Mg(e)&&N(b,e)&&(zk(a)||_g(a)||yg(a))}function se(a){var b=a.length,c=a.constructor(b);return b&&"string"==typeof a[0]&&Vi.call(a,"index")&&(c.index=a.index,c.input=a.input),c}function te(a){return"function"!=typeof a.constructor||Ae(a)?{}:Fc(fj(a))}function ue(a,b,c){var d=a.constructor;switch(b){case Qa:return Ed(a);case Ca:case Da:return new d(+a);case Ra:case Sa:case Ta:case Ua:case Va:case Wa:case Xa:case Ya:case Za:return Jd(a,c);case Ha:return Fd(a);case Ia:case Ma:return new d(a);case Ka:return Gd(a);case La:return Hd(a);case Na:return Id(a)}}function ve(a){var b=a?a.length:W;return Mg(b)&&(zk(a)||_g(a)||yg(a))?y(b,String):null}function we(a,b,c){if(!Ng(c))return!1;var d=typeof b;return!!("number"==d?Ag(c)&&N(b,c.length):"string"==d&&b in c)&&vg(c[b],a)}function xe(a,b){return"number"==typeof a||!zk(a)&&(jb.test(a)||!ib.test(a)||null!=b&&a in Object(b))}function ye(a){var b=typeof a;return"number"==b||"boolean"==b||"string"==b&&"__proto__"!=a||null==a}function ze(a){var b=ke(a),c=yb[b];if("function"!=typeof c||!(b in Eb.prototype))return!1;if(a===c)return!0;var d=Pj(c);return!!d&&a===d[0]}function Ae(a){var b=a&&a.constructor;return a===("function"==typeof b&&b.prototype||Ti)}function Be(a){return a===a&&!Ng(a)}function Ce(a,b){var c=a[1],d=b[1],e=c|d,f=e<(aa|ba|ha),g=d==ha&&c==da||d==ha&&c==ia&&a[7].length<=b[8]||d==(ha|ia)&&b[7].length<=b[8]&&c==da;if(!f&&!g)return a;d&aa&&(a[2]=b[2],e|=c&aa?0:ca);var h=b[3];if(h){var i=a[3];a[3]=i?Kd(i,h,b[4]):Md(h),a[4]=i?Q(a[3],_):Md(b[4])}return h=b[5],h&&(i=a[5],a[5]=i?Ld(i,h,b[6]):Md(h),a[6]=i?Q(a[5],_):Md(b[6])),h=b[7],h&&(a[7]=Md(h)),d&ha&&(a[8]=null==a[8]?b[8]:sj(a[8],b[8])),null==a[9]&&(a[9]=b[9]),a[0]=b[0],a[1]=e,a}function De(a,b,c,d,e,f){return Ng(a)&&Ng(b)&&ed(a,b,W,De,f.set(b,a)),a}function Ee(a,b){return 1==b.length?a:xh(a,qd(b,0,-1))}function Fe(a,b){for(var c=a.length,d=sj(b.length,c),e=Md(a);d--;){var f=b[d];a[d]=N(f,c)?e[f]:W}return a}function Ge(a){var b=[];return nh(a).replace(kb,function(a,c,d,e){b.push(d?e.replace(qb,"$1"):c||a)}),b}function He(a){if(a instanceof Eb)return a.clone();var b=new Db(a.__wrapped__,a.__chain__);return b.__actions__=Md(a.__actions__),b.__index__=a.__index__,b.__values__=a.__values__,b}function Ie(a,b){b=rj(ih(b),0);var c=a?a.length:0;if(!c||b<1)return[];for(var d=0,e=0,f=Array(mj(c/b));d<c;)f[e++]=qd(a,d,d+=b);return f}function Je(a){for(var b=-1,c=a?a.length:0,d=0,e=[];++b<c;){var f=a[b];f&&(e[d++]=f)}return e}function Ke(a,b,c){var d=a?a.length:0;return d?(b=c||b===W?1:ih(b),qd(a,b<0?0:b,d)):[]}function Le(a,b,c){var d=a?a.length:0;return d?(b=c||b===W?1:ih(b),b=d-b,qd(a,0,b<0?0:b)):[]}function Me(a,b){return a&&a.length?zd(a,le(b,3),!0,!0):[]}function Ne(a,b){return a&&a.length?zd(a,le(b,3),!0):[]}function Oe(a,b,c,d){var e=a?a.length:0;return e?(c&&"number"!=typeof c&&we(a,b,c)&&(c=0,d=e),Jc(a,b,c,d)):[]}function Pe(a,b){return a&&a.length?s(a,le(b,3)):-1}function Qe(a,b){return a&&a.length?s(a,le(b,3),!0):-1}function Re(a){return(a?a.length:0)?Lc(a,1):[]}function Se(a){return(a?a.length:0)?Lc(a,ta):[]}function Te(a,b){return(a?a.length:0)?(b=b===W?1:ih(b),Lc(a,b)):[]}function Ue(a){for(var b=-1,c=a?a.length:0,d={};++b<c;){var e=a[b];d[e[0]]=e[1]}return d}function Ve(a){return a?a[0]:W}function We(a,b,c){var d=a?a.length:0;return d?(c=ih(c),c<0&&(c=rj(d+c,0)),t(a,b,c)):-1}function Xe(a){return Le(a,1)}function Ye(a,b){return a?pj.call(a,b):""}function Ze(a){var b=a?a.length:0;return b?a[b-1]:W}function $e(a,b,c){var d=a?a.length:0;if(!d)return-1;var e=d;if(c!==W&&(e=ih(c),e=(e<0?rj(d+e,0):sj(e,d-1))+1),b!==b)return L(a,e,!0);for(;e--;)if(a[e]===b)return e;return-1}function _e(a,b){return a&&a.length&&b&&b.length?ld(a,b):a}function af(a,b,c){return a&&a.length&&b&&b.length?ld(a,b,le(c)):a}function bf(a,b,c){return a&&a.length&&b&&b.length?ld(a,b,W,c):a}function cf(a,b){var c=[];if(!a||!a.length)return c;var d=-1,e=[],f=a.length;for(b=le(b,3);++d<f;){var g=a[d];b(g,d,a)&&(c.push(g),e.push(d))}return md(a,e),c}function df(a){return a?vj.call(a):a}function ef(a,b,c){var d=a?a.length:0;return d?(c&&"number"!=typeof c&&we(a,b,c)?(b=0,c=d):(b=null==b?0:ih(b),c=c===W?d:ih(c)),qd(a,b,c)):[]}function ff(a,b){return sd(a,b)}function gf(a,b,c){return td(a,b,le(c))}function hf(a,b){var c=a?a.length:0;if(c){var d=sd(a,b);if(d<c&&vg(a[d],b))return d}return-1}function jf(a,b){return sd(a,b,!0)}function kf(a,b,c){return td(a,b,le(c),!0)}function lf(a,b){if(a?a.length:0){var c=sd(a,b,!0)-1;if(vg(a[c],b))return c}return-1}function mf(a){return a&&a.length?ud(a):[]}function nf(a,b){return a&&a.length?vd(a,le(b)):[]}function of(a){return Ke(a,1)}function pf(a,b,c){return a&&a.length?(b=c||b===W?1:ih(b),qd(a,0,b<0?0:b)):[]}function qf(a,b,c){var d=a?a.length:0;return d?(b=c||b===W?1:ih(b),b=d-b,qd(a,b<0?0:b,d)):[]}function rf(a,b){return a&&a.length?zd(a,le(b,3),!1,!0):[]}function sf(a,b){return a&&a.length?zd(a,le(b,3)):[]}function tf(a){return a&&a.length?wd(a):[]}function uf(a,b){return a&&a.length?wd(a,le(b)):[]}function vf(a,b){return a&&a.length?wd(a,W,b):[]}function wf(a){if(!a||!a.length)return[];var b=0;return a=i(a,function(a){if(Bg(a))return b=rj(a.length,b),!0}),y(b,function(b){return l(a,jd(b))})}function xf(a,b){if(!a||!a.length)return[];var d=wf(a);return null==b?d:l(d,function(a){return c(b,W,a)})}function yf(a,b){return Cd(a||[],b||[],vc)}function zf(a,b){return Cd(a||[],b||[],pd)}function Af(a){var b=yb(a);return b.__chain__=!0,b}function Bf(a,b){return b(a),a}function Cf(a,b){return b(a)}function Df(){return Af(this)}function Ef(){return new Db(this.value(),this.__chain__)}function Ff(a){return this.map(a).flatten()}function Gf(){this.__values__===W&&(this.__values__=hh(this.value()));var a=this.__index__>=this.__values__.length;return{done:a,value:a?W:this.__values__[this.__index__++]}}function Hf(){return this}function If(a){for(var b,c=this;c instanceof Cb;){var d=He(c);d.__index__=0,d.__values__=W,b?e.__wrapped__=d:b=d;var e=d;c=c.__wrapped__}return e.__wrapped__=a,b}function Jf(){var a=this.__wrapped__;if(a instanceof Eb){var b=a;return this.__actions__.length&&(b=new Eb(this)),b=b.reverse(),b.__actions__.push({func:Cf,args:[df],thisArg:W}),new Db(b,this.__chain__)}return this.thru(df)}function Kf(){return Ad(this.__wrapped__,this.__actions__)}function Lf(a,b,c){var d=zk(a)?h:Ic;return c&&we(a,b,c)&&(b=W),d(a,le(b,3))}function Mf(a,b){return(zk(a)?i:Kc)(a,le(b,3))}function Nf(a,b){if(b=le(b,3),zk(a)){var c=s(a,b);return c>-1?a[c]:W}return r(a,b,Jj)}function Of(a,b){if(b=le(b,3),zk(a)){var c=s(a,b,!0);return c>-1?a[c]:W}return r(a,b,Kj)}function Pf(a,b){return Lc(Tf(a,b),1)}function Qf(a,b){return"function"==typeof b&&zk(a)?f(a,b):Jj(a,Ac(b))}function Rf(a,b){return"function"==typeof b&&zk(a)?g(a,b):Kj(a,Ac(b))}function Sf(a,b,c,d){a=Ag(a)?a:Ph(a),c=c&&!d?ih(c):0;var e=a.length;return c<0&&(c=rj(e+c,0)),_g(a)?c<=e&&a.indexOf(b,c)>-1:!!e&&t(a,b,c)>-1}function Tf(a,b){return(zk(a)?l:bd)(a,le(b,3))}function Uf(a,b,c,d){return null==a?[]:(zk(b)||(b=null==b?[]:[b]),c=d?W:c,zk(c)||(c=null==c?[]:[c]),gd(a,b,c))}function Vf(a,b,c){var d=zk(a)?n:v,e=arguments.length<3;return d(a,le(b,4),c,e,Jj)}function Wf(a,b,c){var d=zk(a)?o:v,e=arguments.length<3;return d(a,le(b,4),c,e,Kj)}function Xf(a,b){var c=zk(a)?i:Kc;return b=le(b,3),c(a,function(a,c,d){return!b(a,c,d)})}function Yf(a){var b=Ag(a)?a:Ph(a),c=b.length;return c>0?b[nd(0,c-1)]:W}function Zf(a,b){var c=-1,d=hh(a),e=d.length,f=e-1;for(b=Cc(ih(b),0,e);++c<b;){var g=nd(c,f),h=d[g];d[g]=d[c],d[c]=h}return d.length=b,d}function $f(a){return Zf(a,xa)}function _f(a){if(null==a)return 0;if(Ag(a)){var b=a.length;return b&&_g(a)?S(a):b}return Ah(a).length}function ag(a,b,c){var d=zk(a)?p:rd;return c&&we(a,b,c)&&(b=W),d(a,le(b,3))}function bg(a,b){if("function"!=typeof b)throw new Ri(Z);return a=ih(a),function(){if(--a<1)return b.apply(this,arguments)}}function cg(a,b,c){return b=c?W:b,b=a&&null==b?a.length:b,ge(a,ha,W,W,W,W,b)}function dg(a,b){var c;if("function"!=typeof b)throw new Ri(Z);return a=ih(a),function(){return--a>0&&(c=b.apply(this,arguments)),a<=1&&(b=W),c}}function eg(a,b,c){b=c?W:b;var d=ge(a,da,W,W,W,W,W,b);return d.placeholder=eg.placeholder,d}function fg(a,b,c){b=c?W:b;var d=ge(a,ea,W,W,W,W,W,b);return d.placeholder=fg.placeholder,d}function gg(a,b,c){function d(){o&&dj(o),k&&dj(k),q=0,j=k=n=o=p=W}function e(b,c){c&&dj(c),k=o=p=W,b&&(q=qk(),l=a.apply(n,j),o||k||(j=n=W))}function f(){var a=b-(qk()-m);a<=0||a>b?e(p,k):o=kj(f,a)}function g(){return(o&&p||k&&t)&&(l=a.apply(n,j)),d(),l}function h(){e(t,o)}function i(){if(j=arguments,m=qk(),n=this,p=t&&(o||!r),!1===s)var c=r&&!o;else{q||k||r||(q=m);var d=s-(m-q),e=(d<=0||d>s)&&(r||k);e?(k&&(k=dj(k)),q=m,l=a.apply(n,j)):k||(k=kj(h,d))}return e&&o?o=dj(o):o||b===s||(o=kj(f,b)),c&&(e=!0,l=a.apply(n,j)),!e||o||k||(j=n=W),l}var j,k,l,m,n,o,p,q=0,r=!1,s=!1,t=!0;if("function"!=typeof a)throw new Ri(Z);return b=kh(b)||0,Ng(c)&&(r=!!c.leading,s="maxWait"in c&&rj(kh(c.maxWait)||0,b),t="trailing"in c?!!c.trailing:t),i.cancel=d,i.flush=g,i}function hg(a){return ge(a,ja)}function ig(a,b){if("function"!=typeof a||b&&"function"!=typeof b)throw new Ri(Z);var c=function(){
var d=arguments,e=b?b.apply(this,d):d[0],f=c.cache;if(f.has(e))return f.get(e);var g=a.apply(this,d);return c.cache=f.set(e,g),g};return c.cache=new ig.Cache,c}function jg(a){if("function"!=typeof a)throw new Ri(Z);return function(){return!a.apply(this,arguments)}}function kg(a){return dg(2,a)}function lg(a,b){if("function"!=typeof a)throw new Ri(Z);return b=rj(b===W?a.length-1:ih(b),0),function(){for(var d=arguments,e=-1,f=rj(d.length-b,0),g=Array(f);++e<f;)g[e]=d[b+e];switch(b){case 0:return a.call(this,g);case 1:return a.call(this,d[0],g);case 2:return a.call(this,d[0],d[1],g)}var h=Array(b+1);for(e=-1;++e<b;)h[e]=d[e];return h[b]=g,c(a,this,h)}}function mg(a,b){if("function"!=typeof a)throw new Ri(Z);return b=b===W?0:rj(ih(b),0),lg(function(d){var e=d[b],f=d.slice(0,b);return e&&m(f,e),c(a,this,f)})}function ng(a,b,c){var d=!0,e=!0;if("function"!=typeof a)throw new Ri(Z);return Ng(c)&&(d="leading"in c?!!c.leading:d,e="trailing"in c?!!c.trailing:e),gg(a,b,{leading:d,maxWait:b,trailing:e})}function og(a){return cg(a,1)}function pg(a,b){return b=null==b?ri:b,wk(b,a)}function qg(){if(!arguments.length)return[];var a=arguments[0];return zk(a)?a:[a]}function rg(a){return Dc(a,!1,!0)}function sg(a,b){return Dc(a,!1,!0,b)}function tg(a){return Dc(a,!0,!0)}function ug(a,b){return Dc(a,!0,!0,b)}function vg(a,b){return a===b||a!==a&&b!==b}function wg(a,b){return a>b}function xg(a,b){return a>=b}function yg(a){return Bg(a)&&Vi.call(a,"callee")&&(!jj.call(a,"callee")||Yi.call(a)==Aa)}function zg(a){return Og(a)&&Yi.call(a)==Qa}function Ag(a){return null!=a&&Mg(Qj(a))&&!Kg(a)}function Bg(a){return Og(a)&&Ag(a)}function Cg(a){return!0===a||!1===a||Og(a)&&Yi.call(a)==Ca}function Dg(a){return Og(a)&&Yi.call(a)==Da}function Eg(a){return!!a&&1===a.nodeType&&Og(a)&&!Xg(a)}function Fg(a){if(Ag(a)&&(zk(a)||_g(a)||Kg(a.splice)||yg(a)))return!a.length;for(var b in a)if(Vi.call(a,b))return!1;return!0}function Gg(a,b){return Xc(a,b)}function Hg(a,b,c){c="function"==typeof c?c:W;var d=c?c(a,b):W;return d===W?Xc(a,b,c):!!d}function Ig(a){return!!Og(a)&&(Yi.call(a)==Ea||"string"==typeof a.message&&"string"==typeof a.name)}function Jg(a){return"number"==typeof a&&oj(a)}function Kg(a){var b=Ng(a)?Yi.call(a):"";return b==Fa||b==Ga}function Lg(a){return"number"==typeof a&&a==ih(a)}function Mg(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=ua}function Ng(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function Og(a){return!!a&&"object"==typeof a}function Pg(a){return Og(a)&&pe(a)==Ha}function Qg(a,b){return a===b||Zc(a,b,me(b))}function Rg(a,b,c){return c="function"==typeof c?c:W,Zc(a,b,me(b),c)}function Sg(a){return Wg(a)&&a!=+a}function Tg(a){return null!=a&&(Kg(a)?$i.test(Ui.call(a)):Og(a)&&(M(a)?$i:wb).test(a))}function Ug(a){return null===a}function Vg(a){return null==a}function Wg(a){return"number"==typeof a||Og(a)&&Yi.call(a)==Ia}function Xg(a){if(!Og(a)||Yi.call(a)!=Ja||M(a))return!1;var b=fj(a);if(null===b)return!0;var c=b.constructor;return"function"==typeof c&&c instanceof c&&Ui.call(c)==Xi}function Yg(a){return Ng(a)&&Yi.call(a)==Ka}function Zg(a){return Lg(a)&&a>=-ua&&a<=ua}function $g(a){return Og(a)&&pe(a)==La}function _g(a){return"string"==typeof a||!zk(a)&&Og(a)&&Yi.call(a)==Ma}function ah(a){return"symbol"==typeof a||Og(a)&&Yi.call(a)==Na}function bh(a){return Og(a)&&Mg(a.length)&&!!Zb[Yi.call(a)]}function ch(a){return a===W}function dh(a){return Og(a)&&pe(a)==Oa}function eh(a){return Og(a)&&Yi.call(a)==Pa}function fh(a,b){return a<b}function gh(a,b){return a<=b}function hh(a){if(!a)return[];if(Ag(a))return _g(a)?T(a):Md(a);if(hj&&a[hj])return O(a[hj]());var b=pe(a);return(b==Ha?P:b==La?R:Ph)(a)}function ih(a){if(!a)return 0===a?a:0;if((a=kh(a))===ta||a===-ta){return(a<0?-1:1)*va}var b=a%1;return a===a?b?a-b:a:0}function jh(a){return a?Cc(ih(a),0,xa):0}function kh(a){if(Ng(a)){var b=Kg(a.valueOf)?a.valueOf():a;a=Ng(b)?b+"":b}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(nb,"");var c=vb.test(a);return c||xb.test(a)?fc(a.slice(2),c?2:8):ub.test(a)?wa:+a}function lh(a){return Nd(a,Bh(a))}function mh(a){return Cc(ih(a),-ua,ua)}function nh(a){if("string"==typeof a)return a;if(null==a)return"";if(ah(a))return Ij?Ij.call(a):"";var b=a+"";return"0"==b&&1/a==-ta?"-0":b}function oh(a,b){var c=Fc(a);return b?xc(c,b):c}function ph(a,b){return r(a,le(b,3),Nc,!0)}function qh(a,b){return r(a,le(b,3),Oc,!0)}function rh(a,b){return null==a?a:Lj(a,Ac(b),Bh)}function sh(a,b){return null==a?a:Mj(a,Ac(b),Bh)}function th(a,b){return a&&Nc(a,Ac(b))}function uh(a,b){return a&&Oc(a,Ac(b))}function vh(a){return null==a?[]:Pc(a,Ah(a))}function wh(a){return null==a?[]:Pc(a,Bh(a))}function xh(a,b,c){var d=null==a?W:Qc(a,b);return d===W?c:d}function yh(a,b){return re(a,b,Rc)}function zh(a,b){return re(a,b,Sc)}function Ah(a){var b=Ae(a);if(!b&&!Ag(a))return _c(a);var c=ve(a),d=!!c,e=c||[],f=e.length;for(var g in a)!Rc(a,g)||d&&("length"==g||N(g,f))||b&&"constructor"==g||e.push(g);return e}function Bh(a){for(var b=-1,c=Ae(a),d=ad(a),e=d.length,f=ve(a),g=!!f,h=f||[],i=h.length;++b<e;){var j=d[b];g&&("length"==j||N(j,i))||"constructor"==j&&(c||!Vi.call(a,j))||h.push(j)}return h}function Ch(a,b){var c={};return b=le(b,3),Nc(a,function(a,d,e){c[b(a,d,e)]=a}),c}function Dh(a,b){var c={};return b=le(b,3),Nc(a,function(a,d,e){c[d]=b(a,d,e)}),c}function Eh(a,b){return b=le(b),id(a,function(a,c){return!b(a,c)})}function Fh(a,b){return null==a?{}:id(a,le(b))}function Gh(a,b,c){if(xe(b,a))d=null==a?W:a[b];else{b=Bc(b);var d=xh(a,b);a=Ee(a,b)}return d===W&&(d=c),Kg(d)?d.call(a):d}function Hh(a,b,c){return null==a?a:pd(a,b,c)}function Ih(a,b,c,d){return d="function"==typeof d?d:W,null==a?a:pd(a,b,c,d)}function Jh(a){return z(a,Ah(a))}function Kh(a){return z(a,Bh(a))}function Lh(a,b,c){var d=zk(a)||bh(a);if(b=le(b,4),null==c)if(d||Ng(a)){var e=a.constructor;c=d?zk(a)?new e:[]:Kg(e)?Fc(fj(a)):{}}else c={};return(d?f:Nc)(a,function(a,d,e){return b(c,a,d,e)}),c}function Mh(a,b){return null==a||xd(a,b)}function Nh(a,b,c){return null==a?a:yd(a,b,Ac(c))}function Oh(a,b,c,d){return d="function"==typeof d?d:W,null==a?a:yd(a,b,Ac(c),d)}function Ph(a){return a?B(a,Ah(a)):[]}function Qh(a){return null==a?[]:B(a,Bh(a))}function Rh(a,b,c){return c===W&&(c=b,b=W),c!==W&&(c=kh(c),c=c===c?c:0),b!==W&&(b=kh(b),b=b===b?b:0),Cc(kh(a),b,c)}function Sh(a,b,c){return b=kh(b)||0,c===W?(c=b,b=0):c=kh(c)||0,a=kh(a),Tc(a,b,c)}function Th(a,b,c){if(c&&"boolean"!=typeof c&&we(a,b,c)&&(b=c=W),c===W&&("boolean"==typeof b?(c=b,b=W):"boolean"==typeof a&&(c=a,a=W)),a===W&&b===W?(a=0,b=1):(a=kh(a)||0,b===W?(b=a,a=0):b=kh(b)||0),a>b){var d=a;a=b,b=d}if(c||a%1||b%1){var e=uj();return sj(a+e*(b-a+ec("1e-"+((e+"").length-1))),b)}return nd(a,b)}function Uh(a){return Tk(nh(a).toLowerCase())}function Vh(a){return(a=nh(a))&&a.replace(zb,I).replace(Rb,"")}function Wh(a,b,c){a=nh(a),b="string"==typeof b?b:b+"";var d=a.length;return c=c===W?d:Cc(ih(c),0,d),(c-=b.length)>=0&&a.indexOf(b,c)==c}function Xh(a){return a=nh(a),a&&eb.test(a)?a.replace(cb,J):a}function Yh(a){return a=nh(a),a&&mb.test(a)?a.replace(lb,"\\$&"):a}function Zh(a,b,c){a=nh(a),b=ih(b);var d=S(a);if(!b||d>=b)return a;var e=(b-d)/2,f=nj(e),g=mj(e);return be("",f,c)+a+be("",g,c)}function $h(a,b,c){return(a=nh(a))+be(a,b,c)}function _h(a,b,c){return a=nh(a),be(a,b,c)+a}function ai(a,b,c){return c||null==b?b=0:b&&(b=+b),a=nh(a).replace(nb,""),tj(a,b||(tb.test(a)?16:10))}function bi(a,b){a=nh(a),b=ih(b);var c="";if(!a||b<1||b>ua)return c;do{b%2&&(c+=a),b=nj(b/2),a+=a}while(b);return c}function ci(){var a=arguments,b=nh(a[0]);return a.length<3?b:b.replace(a[1],a[2])}function di(a,b,c){return nh(a).split(b,c)}function ei(a,b,c){return a=nh(a),c=Cc(ih(c),0,a.length),a.lastIndexOf(b,c)==c}function fi(a,b,c){var d=yb.templateSettings;c&&we(a,b,c)&&(b=W),a=nh(a),b=Dk({},b,d,tc);var e,f,g=Dk({},b.imports,d.imports,tc),h=Ah(g),i=B(g,h),j=0,k=b.interpolate||Ab,l="__p += '",m=Qi((b.escape||Ab).source+"|"+k.source+"|"+(k===hb?rb:Ab).source+"|"+(b.evaluate||Ab).source+"|$","g"),n="//# sourceURL="+("sourceURL"in b?b.sourceURL:"lodash.templateSources["+ ++Yb+"]")+"\n";a.replace(m,function(b,c,d,g,h,i){return d||(d=g),l+=a.slice(j,i).replace(Bb,K),c&&(e=!0,l+="' +\n__e("+c+") +\n'"),h&&(f=!0,l+="';\n"+h+";\n__p += '"),d&&(l+="' +\n((__t = ("+d+")) == null ? '' : __t) +\n'"),j=i+b.length,b}),l+="';\n";var o=b.variable;o||(l="with (obj) {\n"+l+"\n}\n"),l=(f?l.replace($a,""):l).replace(_a,"$1").replace(ab,"$1;"),l="function("+(o||"obj")+") {\n"+(o?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(e?", __e = _.escape":"")+(f?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+l+"return __p\n}";var p=Xk(function(){return Function(h,n+"return "+l).apply(W,i)});if(p.source=l,Ig(p))throw p;return p}function gi(a){return nh(a).toLowerCase()}function hi(a){return nh(a).toUpperCase()}function ii(a,b,c){if(!(a=nh(a)))return a;if(c||b===W)return a.replace(nb,"");if(!(b+=""))return a;var d=T(a),e=T(b);return d.slice(C(d,e),D(d,e)+1).join("")}function ji(a,b,c){if(!(a=nh(a)))return a;if(c||b===W)return a.replace(pb,"");if(!(b+=""))return a;var d=T(a);return d.slice(0,D(d,T(b))+1).join("")}function ki(a,b,c){if(!(a=nh(a)))return a;if(c||b===W)return a.replace(ob,"");if(!(b+=""))return a;var d=T(a);return d.slice(C(d,T(b))).join("")}function li(a,b){var c=ma,d=na;if(Ng(b)){var e="separator"in b?b.separator:e;c="length"in b?ih(b.length):c,d="omission"in b?nh(b.omission):d}a=nh(a);var f=a.length;if(Tb.test(a)){var g=T(a);f=g.length}if(c>=f)return a;var h=c-S(d);if(h<1)return d;var i=g?g.slice(0,h).join(""):a.slice(0,h);if(e===W)return i+d;if(g&&(h+=i.length-h),Yg(e)){if(a.slice(h).search(e)){var j,k=i;for(e.global||(e=Qi(e.source,nh(sb.exec(e))+"g")),e.lastIndex=0;j=e.exec(k);)var l=j.index;i=i.slice(0,l===W?h:l)}}else if(a.indexOf(e,h)!=h){var m=i.lastIndexOf(e);m>-1&&(i=i.slice(0,m))}return i+d}function mi(a){return a=nh(a),a&&db.test(a)?a.replace(bb,U):a}function ni(a,b,c){return a=nh(a),b=c?W:b,b===W&&(b=Wb.test(a)?Vb:Ub),a.match(b)||[]}function oi(a){var b=a?a.length:0,d=le();return a=b?l(a,function(a){if("function"!=typeof a[1])throw new Ri(Z);return[d(a[0]),a[1]]}):[],lg(function(d){for(var e=-1;++e<b;){var f=a[e];if(c(f[0],this,d))return c(f[1],this,d)}})}function pi(a){return Ec(Dc(a,!0))}function qi(a){return function(){return a}}function ri(a){return a}function si(a){return $c("function"==typeof a?a:Dc(a,!0))}function ti(a){return cd(Dc(a,!0))}function ui(a,b){return dd(a,Dc(b,!0))}function vi(a,b,c){var d=Ah(b),e=Pc(b,d);null!=c||Ng(b)&&(e.length||!d.length)||(c=b,b=a,a=this,e=Pc(b,Ah(b)));var g=!(Ng(c)&&"chain"in c)||c.chain,h=Kg(a);return f(e,function(c){var d=b[c];a[c]=d,h&&(a.prototype[c]=function(){var b=this.__chain__;if(g||b){var c=a(this.__wrapped__);return(c.__actions__=Md(this.__actions__)).push({func:d,args:arguments,thisArg:a}),c.__chain__=b,c}return d.apply(a,m([this.value()],arguments))})}),a}function wi(){return nc._===this&&(nc._=Zi),this}function xi(){}function yi(a){return a=ih(a),function(){return arguments[a]}}function zi(a){return xe(a)?jd(a):kd(a)}function Ai(a){return function(b){return null==a?W:Qc(a,b)}}function Bi(a,b){if((a=ih(a))<1||a>ua)return[];var c=xa,d=sj(a,xa);b=Ac(b),a-=xa;for(var e=y(d,b);++c<a;)b(c);return e}function Ci(a){return zk(a)?l(a,String):Ge(a)}function Di(a){var b=++Wi;return nh(a)+b}function Ei(a,b){var c;return a===W&&b===W?0:(a!==W&&(c=a),b!==W&&(c=c===W?b:c+b),c)}function Fi(a){return a&&a.length?q(a,ri,wg):W}function Gi(a,b){return a&&a.length?q(a,le(b),wg):W}function Hi(a){return Li(a)/(a?a.length:0)}function Ii(a){return a&&a.length?q(a,ri,fh):W}function Ji(a,b){return a&&a.length?q(a,le(b),fh):W}function Ki(a,b){var c;return a===W&&b===W?0:(a!==W&&(c=a),b!==W&&(c=c===W?b:c-b),c)}function Li(a){return a&&a.length?x(a,ri):0}function Mi(a,b){return a&&a.length?x(a,le(b)):0}E=E?oc.defaults({},E,oc.pick(nc,Xb)):nc;var Ni=E.Date,Oi=E.Error,Pi=E.Math,Qi=E.RegExp,Ri=E.TypeError,Si=E.Array.prototype,Ti=E.Object.prototype,Ui=E.Function.prototype.toString,Vi=Ti.hasOwnProperty,Wi=0,Xi=Ui.call(Object),Yi=Ti.toString,Zi=nc._,$i=Qi("^"+Ui.call(Vi).replace(lb,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_i=ic?E.Buffer:W,aj=E.Reflect,bj=E.Symbol,cj=E.Uint8Array,dj=E.clearTimeout,ej=aj?aj.enumerate:W,fj=Object.getPrototypeOf,gj=Object.getOwnPropertySymbols,hj="symbol"==typeof(hj=bj&&bj.iterator)?hj:W,ij=Object.create,jj=Ti.propertyIsEnumerable,kj=E.setTimeout,lj=Si.splice,mj=Pi.ceil,nj=Pi.floor,oj=E.isFinite,pj=Si.join,qj=Object.keys,rj=Pi.max,sj=Pi.min,tj=E.parseInt,uj=Pi.random,vj=Si.reverse,wj=ne(E,"Map"),xj=ne(E,"Set"),yj=ne(E,"WeakMap"),zj=ne(Object,"create"),Aj=yj&&new yj,Bj=!jj.call({valueOf:1},"valueOf"),Cj={},Dj=wj?Ui.call(wj):"",Ej=xj?Ui.call(xj):"",Fj=yj?Ui.call(yj):"",Gj=bj?bj.prototype:W,Hj=Gj?Gj.valueOf:W,Ij=Gj?Gj.toString:W;yb.templateSettings={escape:fb,evaluate:gb,interpolate:hb,variable:"",imports:{_:yb}};var Jj=Sd(Nc),Kj=Sd(Oc,!0),Lj=Td(),Mj=Td(!0);ej&&!jj.call({valueOf:1},"valueOf")&&(ad=function(a){return O(ej(a))});var Nj=Aj?function(a,b){return Aj.set(a,b),a}:ri,Oj=xj&&2===new xj([1,2]).size?function(a){return new xj(a)}:xi,Pj=Aj?function(a){return Aj.get(a)}:xi,Qj=jd("length"),Rj=gj||function(){return[]};(wj&&pe(new wj)!=Ha||xj&&pe(new xj)!=La||yj&&pe(new yj)!=Oa)&&(pe=function(a){var b=Yi.call(a),c=b==Ja?a.constructor:null,d="function"==typeof c?Ui.call(c):"";if(d)switch(d){case Dj:return Ha;case Ej:return La;case Fj:return Oa}return b});var Sj=function(){var a=0,b=0;return function(c,d){var e=qk(),f=pa-(e-b);if(b=e,f>0){if(++a>=oa)return c}else a=0;return Nj(c,d)}}(),Tj=lg(function(a,b){return zk(a)||(a=null==a?[]:[Object(a)]),b=Lc(b,1),e(a,b)}),Uj=lg(function(a,b){return Bg(a)?Hc(a,Lc(b,1,!0)):[]}),Vj=lg(function(a,b){var c=Ze(b);return Bg(c)&&(c=W),Bg(a)?Hc(a,Lc(b,1,!0),le(c)):[]}),Wj=lg(function(a,b){var c=Ze(b);return Bg(c)&&(c=W),Bg(a)?Hc(a,Lc(b,1,!0),W,c):[]}),Xj=lg(function(a){var b=l(a,zc);return b.length&&b[0]===a[0]?Uc(b):[]}),Yj=lg(function(a){var b=Ze(a),c=l(a,zc);return b===Ze(c)?b=W:c.pop(),c.length&&c[0]===a[0]?Uc(c,le(b)):[]}),Zj=lg(function(a){var b=Ze(a),c=l(a,zc);return b===Ze(c)?b=W:c.pop(),c.length&&c[0]===a[0]?Uc(c,W,b):[]}),$j=lg(_e),_j=lg(function(a,b){b=l(Lc(b,1),String);var c=yc(a,b);return md(a,b.sort(F)),c}),ak=lg(function(a){return wd(Lc(a,1,!0))}),bk=lg(function(a){var b=Ze(a);return Bg(b)&&(b=W),wd(Lc(a,1,!0),le(b))}),ck=lg(function(a){var b=Ze(a);return Bg(b)&&(b=W),wd(Lc(a,1,!0),W,b)}),dk=lg(function(a,b){return Bg(a)?Hc(a,b):[]}),ek=lg(function(a){return Bd(i(a,Bg))}),fk=lg(function(a){var b=Ze(a);return Bg(b)&&(b=W),Bd(i(a,Bg),le(b))}),gk=lg(function(a){var b=Ze(a);return Bg(b)&&(b=W),Bd(i(a,Bg),W,b)}),hk=lg(wf),ik=lg(function(a){var b=a.length,c=b>1?a[b-1]:W;return c="function"==typeof c?(a.pop(),c):W,xf(a,c)}),jk=lg(function(a){a=Lc(a,1);var b=a.length,c=b?a[0]:0,d=this.__wrapped__,e=function(b){return yc(b,a)};return!(b>1||this.__actions__.length)&&d instanceof Eb&&N(c)?(d=d.slice(c,+c+(b?1:0)),d.__actions__.push({func:Cf,args:[e],thisArg:W}),new Db(d,this.__chain__).thru(function(a){return b&&!a.length&&a.push(W),a})):this.thru(e)}),kk=Qd(function(a,b,c){Vi.call(a,c)?++a[c]:a[c]=1}),lk=Qd(function(a,b,c){Vi.call(a,c)?a[c].push(b):a[c]=[b]}),mk=lg(function(a,b,d){var e=-1,f="function"==typeof b,g=xe(b),h=Ag(a)?Array(a.length):[];return Jj(a,function(a){var i=f?b:g&&null!=a?a[b]:W;h[++e]=i?c(i,a,d):Wc(a,b,d)}),h}),nk=Qd(function(a,b,c){a[c]=b}),ok=Qd(function(a,b,c){a[c?0:1].push(b)},function(){return[[],[]]}),pk=lg(function(a,b){if(null==a)return[];var c=b.length;return c>1&&we(a,b[0],b[1])?b=[]:c>2&&we(b[0],b[1],b[2])&&(b.length=1),gd(a,Lc(b,1),[])}),qk=Ni.now,rk=lg(function(a,b,c){var d=aa;if(c.length){var e=Q(c,oe(rk));d|=fa}return ge(a,d,b,c,e)}),sk=lg(function(a,b,c){var d=aa|ba;if(c.length){var e=Q(c,oe(sk));d|=fa}return ge(b,d,a,c,e)}),tk=lg(function(a,b){return Gc(a,1,b)}),uk=lg(function(a,b,c){return Gc(a,kh(b)||0,c)}),vk=lg(function(a,b){b=l(Lc(b,1),le());var d=b.length;return lg(function(e){for(var f=-1,g=sj(e.length,d);++f<g;)e[f]=b[f].call(this,e[f]);return c(a,this,e)})}),wk=lg(function(a,b){var c=Q(b,oe(wk));return ge(a,fa,W,b,c)}),xk=lg(function(a,b){var c=Q(b,oe(xk));return ge(a,ga,W,b,c)}),yk=lg(function(a,b){return ge(a,ia,W,W,W,Lc(b,1))}),zk=Array.isArray,Ak=_i?function(a){return a instanceof _i}:qi(!1),Bk=Rd(function(a,b){if(Bj||Ae(b)||Ag(b))return void Nd(b,Ah(b),a);for(var c in b)Vi.call(b,c)&&vc(a,c,b[c])}),Ck=Rd(function(a,b){if(Bj||Ae(b)||Ag(b))return void Nd(b,Bh(b),a);for(var c in b)vc(a,c,b[c])}),Dk=Rd(function(a,b,c,d){Od(b,Bh(b),a,d)}),Ek=Rd(function(a,b,c,d){Od(b,Ah(b),a,d)}),Fk=lg(function(a,b){return yc(a,Lc(b,1))}),Gk=lg(function(a){return a.push(W,tc),c(Dk,W,a)}),Hk=lg(function(a){return a.push(W,De),c(Mk,W,a)}),Ik=_d(function(a,b,c){a[b]=c},qi(ri)),Jk=_d(function(a,b,c){Vi.call(a,b)?a[b].push(c):a[b]=[c]},le),Kk=lg(Wc),Lk=Rd(function(a,b,c){ed(a,b,c)}),Mk=Rd(function(a,b,c,d){ed(a,b,c,d)}),Nk=lg(function(a,b){return null==a?{}:(b=l(Lc(b,1),String),hd(a,Hc(Bh(a),b)))}),Ok=lg(function(a,b){return null==a?{}:hd(a,Lc(b,1))}),Pk=Wd(function(a,b,c){return b=b.toLowerCase(),a+(c?Uh(b):b)}),Qk=Wd(function(a,b,c){return a+(c?"-":"")+b.toLowerCase()}),Rk=Wd(function(a,b,c){return a+(c?" ":"")+b.toLowerCase()}),Sk=Vd("toLowerCase"),Tk=Vd("toUpperCase"),Uk=Wd(function(a,b,c){return a+(c?"_":"")+b.toLowerCase()}),Vk=Wd(function(a,b,c){return a+(c?" ":"")+Uh(b)}),Wk=Wd(function(a,b,c){return a+(c?" ":"")+b.toUpperCase()}),Xk=lg(function(a,b){try{return c(a,W,b)}catch(a){return Ig(a)?a:new Oi(a)}}),Yk=lg(function(a,b){return f(Lc(b,1),function(b){a[b]=rk(a[b],a)}),a}),Zk=Zd(),$k=Zd(!0),_k=lg(function(a,b){return function(c){return Wc(c,a,b)}}),al=lg(function(a,b){return function(c){return Wc(a,c,b)}}),bl=ae(l),cl=ae(h),dl=ae(p),el=de(),fl=de(!0),gl=fe("ceil"),hl=fe("floor"),il=fe("round");return yb.prototype=Cb.prototype,yb.prototype.constructor=yb,Db.prototype=Fc(Cb.prototype),Db.prototype.constructor=Db,Eb.prototype=Fc(Cb.prototype),Eb.prototype.constructor=Eb,Ib.prototype=zj?zj(null):Ti,Nb.prototype.clear=Ob,Nb.prototype.delete=Pb,Nb.prototype.get=Qb,Nb.prototype.has=Sb,Nb.prototype.set=_b,ac.prototype.push=cc,dc.prototype.clear=gc,dc.prototype.delete=hc,dc.prototype.get=jc,dc.prototype.has=kc,dc.prototype.set=lc,ig.Cache=Nb,yb.after=bg,yb.ary=cg,yb.assign=Bk,yb.assignIn=Ck,yb.assignInWith=Dk,yb.assignWith=Ek,yb.at=Fk,yb.before=dg,yb.bind=rk,yb.bindAll=Yk,yb.bindKey=sk,yb.castArray=qg,yb.chain=Af,yb.chunk=Ie,yb.compact=Je,yb.concat=Tj,yb.cond=oi,yb.conforms=pi,yb.constant=qi,yb.countBy=kk,yb.create=oh,yb.curry=eg,yb.curryRight=fg,yb.debounce=gg,yb.defaults=Gk,yb.defaultsDeep=Hk,yb.defer=tk,yb.delay=uk,yb.difference=Uj,yb.differenceBy=Vj,yb.differenceWith=Wj,yb.drop=Ke,yb.dropRight=Le,yb.dropRightWhile=Me,yb.dropWhile=Ne,yb.fill=Oe,yb.filter=Mf,yb.flatMap=Pf,yb.flatten=Re,yb.flattenDeep=Se,yb.flattenDepth=Te,yb.flip=hg,yb.flow=Zk,yb.flowRight=$k,yb.fromPairs=Ue,yb.functions=vh,yb.functionsIn=wh,yb.groupBy=lk,yb.initial=Xe,yb.intersection=Xj,yb.intersectionBy=Yj,yb.intersectionWith=Zj,yb.invert=Ik,yb.invertBy=Jk,yb.invokeMap=mk,yb.iteratee=si,yb.keyBy=nk,yb.keys=Ah,yb.keysIn=Bh,yb.map=Tf,yb.mapKeys=Ch,yb.mapValues=Dh,yb.matches=ti,yb.matchesProperty=ui,yb.memoize=ig,yb.merge=Lk,yb.mergeWith=Mk,yb.method=_k,yb.methodOf=al,yb.mixin=vi,yb.negate=jg,yb.nthArg=yi,yb.omit=Nk,yb.omitBy=Eh,yb.once=kg,yb.orderBy=Uf,yb.over=bl,yb.overArgs=vk,yb.overEvery=cl,yb.overSome=dl,yb.partial=wk,yb.partialRight=xk,yb.partition=ok,yb.pick=Ok,yb.pickBy=Fh,yb.property=zi,yb.propertyOf=Ai,yb.pull=$j,yb.pullAll=_e,yb.pullAllBy=af,yb.pullAllWith=bf,yb.pullAt=_j,yb.range=el,yb.rangeRight=fl,yb.rearg=yk,yb.reject=Xf,yb.remove=cf,yb.rest=lg,yb.reverse=df,yb.sampleSize=Zf,yb.set=Hh,yb.setWith=Ih,yb.shuffle=$f,yb.slice=ef,yb.sortBy=pk,yb.sortedUniq=mf,yb.sortedUniqBy=nf,yb.split=di,yb.spread=mg,yb.tail=of,yb.take=pf,yb.takeRight=qf,yb.takeRightWhile=rf,yb.takeWhile=sf,yb.tap=Bf,yb.throttle=ng,yb.thru=Cf,yb.toArray=hh,yb.toPairs=Jh,yb.toPairsIn=Kh,yb.toPath=Ci,yb.toPlainObject=lh,yb.transform=Lh,yb.unary=og,yb.union=ak,yb.unionBy=bk,yb.unionWith=ck,yb.uniq=tf,yb.uniqBy=uf,yb.uniqWith=vf,yb.unset=Mh,yb.unzip=wf,yb.unzipWith=xf,yb.update=Nh,yb.updateWith=Oh,yb.values=Ph,yb.valuesIn=Qh,yb.without=dk,yb.words=ni,yb.wrap=pg,yb.xor=ek,yb.xorBy=fk,yb.xorWith=gk,yb.zip=hk,yb.zipObject=yf,yb.zipObjectDeep=zf,yb.zipWith=ik,yb.extend=Ck,yb.extendWith=Dk,vi(yb,yb),yb.add=Ei,yb.attempt=Xk,yb.camelCase=Pk,yb.capitalize=Uh,yb.ceil=gl,yb.clamp=Rh,yb.clone=rg,yb.cloneDeep=tg,yb.cloneDeepWith=ug,yb.cloneWith=sg,yb.deburr=Vh,yb.endsWith=Wh,yb.eq=vg,yb.escape=Xh,yb.escapeRegExp=Yh,yb.every=Lf,yb.find=Nf,yb.findIndex=Pe,yb.findKey=ph,yb.findLast=Of,yb.findLastIndex=Qe,yb.findLastKey=qh,yb.floor=hl,yb.forEach=Qf,yb.forEachRight=Rf,yb.forIn=rh,yb.forInRight=sh,yb.forOwn=th,yb.forOwnRight=uh,yb.get=xh,yb.gt=wg,yb.gte=xg,yb.has=yh,yb.hasIn=zh,yb.head=Ve,yb.identity=ri,yb.includes=Sf,yb.indexOf=We,yb.inRange=Sh,yb.invoke=Kk,yb.isArguments=yg,yb.isArray=zk,yb.isArrayBuffer=zg,yb.isArrayLike=Ag,yb.isArrayLikeObject=Bg,yb.isBoolean=Cg,yb.isBuffer=Ak,yb.isDate=Dg,yb.isElement=Eg,yb.isEmpty=Fg,yb.isEqual=Gg,yb.isEqualWith=Hg,yb.isError=Ig,yb.isFinite=Jg,yb.isFunction=Kg,yb.isInteger=Lg,yb.isLength=Mg,yb.isMap=Pg,yb.isMatch=Qg,yb.isMatchWith=Rg,yb.isNaN=Sg,yb.isNative=Tg,yb.isNil=Vg,yb.isNull=Ug,yb.isNumber=Wg,yb.isObject=Ng,yb.isObjectLike=Og,yb.isPlainObject=Xg,yb.isRegExp=Yg,yb.isSafeInteger=Zg,yb.isSet=$g,yb.isString=_g,yb.isSymbol=ah,yb.isTypedArray=bh,yb.isUndefined=ch,yb.isWeakMap=dh,yb.isWeakSet=eh,yb.join=Ye,yb.kebabCase=Qk,yb.last=Ze,yb.lastIndexOf=$e,yb.lowerCase=Rk,yb.lowerFirst=Sk,yb.lt=fh,yb.lte=gh,yb.max=Fi,yb.maxBy=Gi,yb.mean=Hi,yb.min=Ii,yb.minBy=Ji,yb.noConflict=wi,yb.noop=xi,yb.now=qk,yb.pad=Zh,yb.padEnd=$h,yb.padStart=_h,yb.parseInt=ai,yb.random=Th,yb.reduce=Vf,yb.reduceRight=Wf,yb.repeat=bi,yb.replace=ci,yb.result=Gh,yb.round=il,yb.runInContext=V,yb.sample=Yf,yb.size=_f,yb.snakeCase=Uk,yb.some=ag,yb.sortedIndex=ff,yb.sortedIndexBy=gf,yb.sortedIndexOf=hf,yb.sortedLastIndex=jf,yb.sortedLastIndexBy=kf,yb.sortedLastIndexOf=lf,yb.startCase=Vk,yb.startsWith=ei,yb.subtract=Ki,yb.sum=Li,yb.sumBy=Mi,yb.template=fi,yb.times=Bi,yb.toInteger=ih,yb.toLength=jh,yb.toLower=gi,yb.toNumber=kh,yb.toSafeInteger=mh,yb.toString=nh,yb.toUpper=hi,yb.trim=ii,yb.trimEnd=ji,yb.trimStart=ki,yb.truncate=li,yb.unescape=mi,yb.uniqueId=Di,yb.upperCase=Wk,yb.upperFirst=Tk,yb.each=Qf,yb.eachRight=Rf,yb.first=Ve,vi(yb,function(){var a={};return Nc(yb,function(b,c){Vi.call(yb.prototype,c)||(a[c]=b)}),a}(),{chain:!1}),yb.VERSION=X,f(["bind","bindKey","curry","curryRight","partial","partialRight"],function(a){yb[a].placeholder=yb}),f(["drop","take"],function(a,b){Eb.prototype[a]=function(c){var d=this.__filtered__;if(d&&!b)return new Eb(this);c=c===W?1:rj(ih(c),0);var e=this.clone();return d?e.__takeCount__=sj(c,e.__takeCount__):e.__views__.push({size:sj(c,xa),type:a+(e.__dir__<0?"Right":"")}),e},Eb.prototype[a+"Right"]=function(b){return this.reverse()[a](b).reverse()}}),f(["filter","map","takeWhile"],function(a,b){var c=b+1,d=c==qa||c==sa;Eb.prototype[a]=function(a){var b=this.clone();return b.__iteratees__.push({iteratee:le(a,3),type:c}),b.__filtered__=b.__filtered__||d,b}}),f(["head","last"],function(a,b){var c="take"+(b?"Right":"");Eb.prototype[a]=function(){return this[c](1).value()[0]}}),f(["initial","tail"],function(a,b){var c="drop"+(b?"":"Right");Eb.prototype[a]=function(){return this.__filtered__?new Eb(this):this[c](1)}}),Eb.prototype.compact=function(){return this.filter(ri)},Eb.prototype.find=function(a){return this.filter(a).head()},Eb.prototype.findLast=function(a){return this.reverse().find(a)},Eb.prototype.invokeMap=lg(function(a,b){return"function"==typeof a?new Eb(this):this.map(function(c){return Wc(c,a,b)})}),Eb.prototype.reject=function(a){return a=le(a,3),this.filter(function(b){return!a(b)})},Eb.prototype.slice=function(a,b){a=ih(a);var c=this;return c.__filtered__&&(a>0||b<0)?new Eb(c):(a<0?c=c.takeRight(-a):a&&(c=c.drop(a)),b!==W&&(b=ih(b),c=b<0?c.dropRight(-b):c.take(b-a)),c)},Eb.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()},Eb.prototype.toArray=function(){return this.take(xa)},Nc(Eb.prototype,function(a,b){var c=/^(?:filter|find|map|reject)|While$/.test(b),d=/^(?:head|last)$/.test(b),e=yb[d?"take"+("last"==b?"Right":""):b],f=d||/^find/.test(b);e&&(yb.prototype[b]=function(){var b=this.__wrapped__,g=d?[1]:arguments,h=b instanceof Eb,i=g[0],j=h||zk(b),k=function(a){var b=e.apply(yb,m([a],g));return d&&l?b[0]:b};j&&c&&"function"==typeof i&&1!=i.length&&(h=j=!1);var l=this.__chain__,n=!!this.__actions__.length,o=f&&!l,p=h&&!n;if(!f&&j){b=p?b:new Eb(this);var q=a.apply(b,g);return q.__actions__.push({func:Cf,args:[k],thisArg:W}),new Db(q,l)}return o&&p?a.apply(this,g):(q=this.thru(k),o?d?q.value()[0]:q.value():q)})}),f(["pop","push","shift","sort","splice","unshift"],function(a){var b=Si[a],c=/^(?:push|sort|unshift)$/.test(a)?"tap":"thru",d=/^(?:pop|shift)$/.test(a);yb.prototype[a]=function(){var a=arguments;return d&&!this.__chain__?b.apply(this.value(),a):this[c](function(c){return b.apply(c,a)})}}),Nc(Eb.prototype,function(a,b){var c=yb[b];if(c){var d=c.name+"";(Cj[d]||(Cj[d]=[])).push({name:b,func:c})}}),Cj[$d(W,ba).name]=[{name:"wrapper",func:W}],Eb.prototype.clone=Fb,Eb.prototype.reverse=Gb,Eb.prototype.value=Hb,yb.prototype.at=jk,yb.prototype.chain=Df,yb.prototype.commit=Ef,yb.prototype.flatMap=Ff,yb.prototype.next=Gf,yb.prototype.plant=If,yb.prototype.reverse=Jf,yb.prototype.toJSON=yb.prototype.valueOf=yb.prototype.value=Kf,hj&&(yb.prototype[hj]=Hf),yb}var W,X="4.6.1",Y=200,Z="Expected a function",$="__lodash_hash_undefined__",_="__lodash_placeholder__",aa=1,ba=2,ca=4,da=8,ea=16,fa=32,ga=64,ha=128,ia=256,ja=512,ka=1,la=2,ma=30,na="...",oa=150,pa=16,qa=1,ra=2,sa=3,ta=1/0,ua=9007199254740991,va=1.7976931348623157e308,wa=NaN,xa=4294967295,ya=xa-1,za=xa>>>1,Aa="[object Arguments]",Ba="[object Array]",Ca="[object Boolean]",Da="[object Date]",Ea="[object Error]",Fa="[object Function]",Ga="[object GeneratorFunction]",Ha="[object Map]",Ia="[object Number]",Ja="[object Object]",Ka="[object RegExp]",La="[object Set]",Ma="[object String]",Na="[object Symbol]",Oa="[object WeakMap]",Pa="[object WeakSet]",Qa="[object ArrayBuffer]",Ra="[object Float32Array]",Sa="[object Float64Array]",Ta="[object Int8Array]",Ua="[object Int16Array]",Va="[object Int32Array]",Wa="[object Uint8Array]",Xa="[object Uint8ClampedArray]",Ya="[object Uint16Array]",Za="[object Uint32Array]",$a=/\b__p \+= '';/g,_a=/\b(__p \+=) '' \+/g,ab=/(__e\(.*?\)|\b__t\)) \+\n'';/g,bb=/&(?:amp|lt|gt|quot|#39|#96);/g,cb=/[&<>"'`]/g,db=RegExp(bb.source),eb=RegExp(cb.source),fb=/<%-([\s\S]+?)%>/g,gb=/<%([\s\S]+?)%>/g,hb=/<%=([\s\S]+?)%>/g,ib=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,jb=/^\w*$/,kb=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,lb=/[\\^$.*+?()[\]{}|]/g,mb=RegExp(lb.source),nb=/^\s+|\s+$/g,ob=/^\s+/,pb=/\s+$/,qb=/\\(\\)?/g,rb=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,sb=/\w*$/,tb=/^0x/i,ub=/^[-+]0x[0-9a-f]+$/i,vb=/^0b[01]+$/i,wb=/^\[object .+?Constructor\]$/,xb=/^0o[0-7]+$/i,yb=/^(?:0|[1-9]\d*)$/,zb=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Ab=/($^)/,Bb=/['\n\r\u2028\u2029\\]/g,Cb="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2018\\u2019\\u201c\\u201d \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Db="["+Cb+"]",Eb="[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]",Fb="[a-z\\xdf-\\xf6\\xf8-\\xff]",Gb="[^\\ud800-\\udfff"+Cb+"\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Hb="\\ud83c[\\udffb-\\udfff]",Ib="(?:\\ud83c[\\udde6-\\uddff]){2}",Jb="[\\ud800-\\udbff][\\udc00-\\udfff]",Kb="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Lb="(?:"+Fb+"|"+Gb+")",Mb="(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?",Nb="(?:\\u200d(?:"+["[^\\ud800-\\udfff]",Ib,Jb].join("|")+")[\\ufe0e\\ufe0f]?"+Mb+")*",Ob="[\\ufe0e\\ufe0f]?"+Mb+Nb,Pb="(?:"+["[\\u2700-\\u27bf]",Ib,Jb].join("|")+")"+Ob,Qb="(?:"+["[^\\ud800-\\udfff]"+Eb+"?",Eb,Ib,Jb,"[\\ud800-\\udfff]"].join("|")+")",Rb=RegExp(Eb,"g"),Sb=RegExp(Hb+"(?="+Hb+")|"+Qb+Ob,"g"),Tb=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0\\ufe0e\\ufe0f]"),Ub=/[a-zA-Z0-9]+/g,Vb=RegExp([Kb+"?"+Fb+"+(?="+[Db,Kb,"$"].join("|")+")","(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2018\\u2019\\u201c\\u201d \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?="+[Db,Kb+Lb,"$"].join("|")+")",Kb+"?"+Lb+"+",Kb+"+","\\d+",Pb].join("|"),"g"),Wb=/[a-z][A-Z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Xb=["Array","Buffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Reflect","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Yb=-1,Zb={};Zb[Ra]=Zb[Sa]=Zb[Ta]=Zb[Ua]=Zb[Va]=Zb[Wa]=Zb[Xa]=Zb[Ya]=Zb[Za]=!0,Zb[Aa]=Zb[Ba]=Zb[Qa]=Zb[Ca]=Zb[Da]=Zb[Ea]=Zb[Fa]=Zb[Ha]=Zb[Ia]=Zb[Ja]=Zb[Ka]=Zb[La]=Zb[Ma]=Zb[Oa]=!1;var $b={};$b[Aa]=$b[Ba]=$b[Qa]=$b[Ca]=$b[Da]=$b[Ra]=$b[Sa]=$b[Ta]=$b[Ua]=$b[Va]=$b[Ha]=$b[Ia]=$b[Ja]=$b[Ka]=$b[La]=$b[Ma]=$b[Na]=$b[Wa]=$b[Xa]=$b[Ya]=$b[Za]=!0,$b[Ea]=$b[Fa]=$b[Oa]=!1;var _b={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},ac={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},bc={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},cc={function:!0,object:!0},dc={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ec=parseFloat,fc=parseInt,gc=cc[typeof exports]&&exports&&!exports.nodeType?exports:W,hc=cc[typeof module]&&module&&!module.nodeType?module:W,ic=hc&&hc.exports===gc?gc:W,jc=E(gc&&hc&&"object"==typeof global&&global),kc=E(cc[typeof self]&&self),lc=E(cc[typeof window]&&window),mc=E(cc[typeof this]&&this),nc=jc||lc!==(mc&&mc.window)&&lc||kc||mc||Function("return this")(),oc=V();(lc||kc||{})._=oc,"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return oc}):gc&&hc?(ic&&((hc.exports=oc)._=oc),gc._=oc):nc._=oc}).call(this),function(a){!function(a,b){function c(a){this.grid=a}var d=function(a,b,c,d){var e=function(){return console.warn("gridstack.js: Function `"+b+"` is deprecated in "+d+" and has been replaced with `"+c+"`. It will be **completely** removed in v1.0"),a.apply(this,arguments)};return e.prototype=a.prototype,e},e=function(a,b,c,d){void 0!==a[b]&&(a[c]=a[b],console.warn("gridstack.js: Option `"+b+"` is deprecated in "+d+" and has been replaced with `"+c+"`. It will be **completely** removed in v1.0"))},f=function(a,b,c,d){void 0!==a[b]&&console.warn("gridstack.js: Option `"+b+"` is deprecated in "+c+d)},g=function(a,b,c,d){var e=a.attr(b);void 0!==e&&(a.attr(c,e),console.warn("gridstack.js: attribute `"+b+"`="+e+" is deprecated on this object in "+d+" and has been replaced with `"+c+"`. It will be **completely** removed in v1.0"))},h={isIntercepted:function(a,b){return!(a.x+a.width<=b.x||b.x+b.width<=a.x||a.y+a.height<=b.y||b.y+b.height<=a.y)},sort:function(a,b,c){
if(!c){var d=a.map(function(a){return a.x+a.width});c=Math.max.apply(Math,d)}return-1===b?h.sortBy(a,function(a){return-(a.x+a.y*c)}):h.sortBy(a,function(a){return a.x+a.y*c})},createStylesheet:function(a,b){var c=document.createElement("style");return c.setAttribute("type","text/css"),c.setAttribute("data-gs-style-id",a),c.styleSheet?c.styleSheet.cssText="":c.appendChild(document.createTextNode("")),b||(b=document.getElementsByTagName("head")[0]),b.insertBefore(c,b.firstChild),c.sheet},removeStylesheet:function(b){a("STYLE[data-gs-style-id="+b+"]").remove()},insertCSSRule:function(a,b,c,d){"function"==typeof a.insertRule?a.insertRule(b+"{"+c+"}",d):"function"==typeof a.addRule&&a.addRule(b,c,d)},toBool:function(a){return"boolean"==typeof a?a:"string"==typeof a?!(""===(a=a.toLowerCase())||"no"===a||"false"===a||"0"===a):Boolean(a)},_collisionNodeCheck:function(a){return a!==this.node&&h.isIntercepted(a,this.nn)},_didCollide:function(a){return h.isIntercepted({x:this.n.x,y:this.newY,width:this.n.width,height:this.n.height},a)},_isAddNodeIntercepted:function(a){return h.isIntercepted({x:this.x,y:this.y,width:this.node.width,height:this.node.height},a)},parseHeight:function(a){var b=a,c="px";if(b&&"string"==typeof b){var d=b.match(/^(-[0-9]+\.[0-9]+|[0-9]*\.[0-9]+|-[0-9]+|[0-9]+)(px|em|rem|vh|vw|%)?$/);if(!d)throw new Error("Invalid height");c=d[2]||"px",b=parseFloat(d[1])}return{height:b,unit:c}},without:function(a,b){var c=a.indexOf(b);return-1!==c&&(a=a.slice(0),a.splice(c,1)),a},sortBy:function(a,b){return a.slice(0).sort(function(a,c){var d=b(a),e=b(c);return e===d?0:d>e?1:-1})},defaults:function(a){return Array.prototype.slice.call(arguments,1).forEach(function(b){for(var c in b)!Object.prototype.hasOwnProperty.call(b,c)||Object.prototype.hasOwnProperty.call(a,c)&&void 0!==a[c]||(a[c]=b[c])}),a},clone:function(b){return a.extend({},b)},throttle:function(a,b){var c=!1;return function(){c||(a.apply(this,arguments),c=!0,setTimeout(function(){c=!1},b))}},removePositioningStyles:function(a){var b=a[0].style;b.position&&b.removeProperty("position"),b.left&&b.removeProperty("left"),b.top&&b.removeProperty("top"),b.width&&b.removeProperty("width"),b.height&&b.removeProperty("height")},getScrollParent:function(a){return null===a?null:a.scrollHeight>a.clientHeight?a:h.getScrollParent(a.parentNode)},updateScrollPosition:function(a,b,c){var d=a.getBoundingClientRect(),e=window.innerHeight||document.documentElement.clientHeight;if(d.top<0||d.bottom>e){var f=d.bottom-e,g=d.top,i=h.getScrollParent(a);if(null!==i){var j=i.scrollTop;d.top<0&&c<0?a.offsetHeight>e?i.scrollTop+=c:i.scrollTop+=Math.abs(g)>Math.abs(c)?c:g:c>0&&(a.offsetHeight>e?i.scrollTop+=c:i.scrollTop+=f>c?c:f),b.position.top+=i.scrollTop-j}}}};c.registeredPlugins=[],c.registerPlugin=function(a){c.registeredPlugins.push(a)},c.prototype.resizable=function(a,b){return this},c.prototype.draggable=function(a,b){return this},c.prototype.droppable=function(a,b){return this},c.prototype.isDroppable=function(a){return!1},c.prototype.on=function(a,b,c){return this};var i=0,j=function(a,b,c,d,e){this.column=a||12,this.float=c||!1,this.maxRow=d||0,this.nodes=e||[],this.onchange=b||function(){},this._addedNodes=[],this._removedNodes=[],this._batchMode=!1};j.prototype.batchUpdate=function(){this._batchMode||(this._batchMode=!0,this._prevFloat=this.float,this.float=!0)},j.prototype.commit=function(){this._batchMode&&(this._batchMode=!1,this.float=this._prevFloat,delete this._prevFloat,this._packNodes(),this._notify())},j.prototype.getNodeDataByDOMEl=function(a){return this.nodes.find(function(b){return a===b.el})},j.prototype._fixCollisions=function(a){this._sortNodes(-1);var b=a,c=Boolean(this.nodes.find(function(a){return a.locked}));for(this.float||c||(b={x:0,y:a.y,width:this.column,height:a.height});;){var d=this.nodes.find(h._collisionNodeCheck,{node:a,nn:b});if(!d)return;if(!(d.locked?this.moveNode(a,a.x,d.y+d.height,a.width,a.height,!0):this.moveNode(d,d.x,a.y+a.height,d.width,d.height,!0)))return}},j.prototype.isAreaEmpty=function(a,b,c,d){var e={x:a||0,y:b||0,width:c||1,height:d||1};return!this.nodes.find(function(a){return h.isIntercepted(a,e)})},j.prototype._sortNodes=function(a){this.nodes=h.sort(this.nodes,a,this.column)},j.prototype._packNodes=function(){this._sortNodes(),this.float?this.nodes.forEach(function(a,b){if(!a._updating&&void 0!==a._packY&&a.y!==a._packY)for(var c=a.y;c>=a._packY;){var d=this.nodes.slice(0,b).find(h._didCollide,{n:a,newY:c});d||(a._dirty=!0,a.y=c),--c}},this):this.nodes.forEach(function(a,b){if(!a.locked)for(;a.y>0;){var c=a.y-1,d=0===b;if(b>0){var e=this.nodes.slice(0,b).find(h._didCollide,{n:a,newY:c});d=void 0===e}if(!d)break;a._dirty=a.y!==c,a.y=c}},this)},j.prototype._prepareNode=function(a,b){a=a||{},void 0!==a.x&&void 0!==a.y&&null!==a.x&&null!==a.y||(a.autoPosition=!0);var c={width:1,height:1,x:0,y:0};return a=h.defaults(a,c),a.x=parseInt(a.x),a.y=parseInt(a.y),a.width=parseInt(a.width),a.height=parseInt(a.height),a.autoPosition=a.autoPosition||!1,a.noResize=a.noResize||!1,a.noMove=a.noMove||!1,Number.isNaN(a.x)&&(a.x=c.x,a.autoPosition=!0),Number.isNaN(a.y)&&(a.y=c.y,a.autoPosition=!0),Number.isNaN(a.width)&&(a.width=c.width),Number.isNaN(a.height)&&(a.height=c.height),void 0!==a.maxWidth&&(a.width=Math.min(a.width,a.maxWidth)),void 0!==a.maxHeight&&(a.height=Math.min(a.height,a.maxHeight)),void 0!==a.minWidth&&(a.width=Math.max(a.width,a.minWidth)),void 0!==a.minHeight&&(a.height=Math.max(a.height,a.minHeight)),a.width>this.column?a.width=this.column:a.width<1&&(a.width=1),this.maxRow&&a.height>this.maxRow?a.height=this.maxRow:a.height<1&&(a.height=1),a.x<0&&(a.x=0),a.y<0&&(a.y=0),a.x+a.width>this.column&&(b?a.width=this.column-a.x:a.x=this.column-a.width),this.maxRow&&a.y+a.height>this.maxRow&&(b?a.height=this.maxRow-a.y:a.y=this.maxRow-a.height),a},j.prototype._notify=function(){if(!this._batchMode){var a=Array.prototype.slice.call(arguments,0);a[0]=void 0===a[0]?[]:Array.isArray(a[0])?a[0]:[a[0]],a[1]=void 0===a[1]||a[1];var b=a[0].concat(this.getDirtyNodes());this.onchange(b,a[1])}},j.prototype.cleanNodes=function(){this._batchMode||this.nodes.forEach(function(a){delete a._dirty})},j.prototype.getDirtyNodes=function(a){if(a){var b=[];return this.nodes.forEach(function(a){a._dirty&&(a.y===a._origY&&a.x===a._origX&&a.width===a._origW&&a.height===a._origH?delete a._dirty:b.push(a))}),b}return this.nodes.filter(function(a){return a._dirty})},j.prototype.addNode=function(a,b){if(a=this._prepareNode(a),a._id=a._id||++i,a.autoPosition){this._sortNodes();for(var c=0;;++c){var d=c%this.column,e=Math.floor(c/this.column);if(!(d+a.width>this.column)&&!this.nodes.find(h._isAddNodeIntercepted,{x:d,y:e,node:a})){a.x=d,a.y=e,delete a.autoPosition;break}}}return this.nodes.push(a),b&&this._addedNodes.push(a),this._fixCollisions(a),this._packNodes(),this._notify(),a},j.prototype.removeNode=function(a,b){b=void 0===b||b,this._removedNodes.push(a),a._id=null,this.nodes=h.without(this.nodes,a),this._packNodes(),this._notify(a,b)},j.prototype.removeAll=function(a){delete this._layouts,0!==this.nodes.length&&(a=void 0===a||a,this.nodes.forEach(function(a){a._id=null}),this._removedNodes=this.nodes,this.nodes=[],this._notify(this._removedNodes,a))},j.prototype.canMoveNode=function(b,c,d,e,f){if(!this.isNodeChangedPosition(b,c,d,e,f))return!1;var g=Boolean(this.nodes.find(function(a){return a.locked}));if(!this.maxRow&&!g)return!0;var h,i=new j(this.column,null,this.float,0,this.nodes.map(function(c){return c===b?h=a.extend({},c):a.extend({},c)}));if(!h)return!0;i.moveNode(h,c,d,e,f);var k=!0;return g&&(k&=!Boolean(i.nodes.find(function(a){return a!==h&&Boolean(a.locked)&&Boolean(a._dirty)}))),this.maxRow&&(k&=i.getRow()<=this.maxRow),k},j.prototype.canBePlacedWithRespectToHeight=function(b){if(!this.maxRow)return!0;var c=new j(this.column,null,this.float,0,this.nodes.map(function(b){return a.extend({},b)}));return c.addNode(b),c.getRow()<=this.maxRow},j.prototype.isNodeChangedPosition=function(a,b,c,d,e){return"number"!=typeof b&&(b=a.x),"number"!=typeof c&&(c=a.y),"number"!=typeof d&&(d=a.width),"number"!=typeof e&&(e=a.height),void 0!==a.maxWidth&&(d=Math.min(d,a.maxWidth)),void 0!==a.maxHeight&&(e=Math.min(e,a.maxHeight)),void 0!==a.minWidth&&(d=Math.max(d,a.minWidth)),void 0!==a.minHeight&&(e=Math.max(e,a.minHeight)),a.x!==b||a.y!==c||a.width!==d||a.height!==e},j.prototype.moveNode=function(a,b,c,d,e,f){if(a.locked)return null;"number"!=typeof b&&(b=a.x),"number"!=typeof c&&(c=a.y),"number"!=typeof d&&(d=a.width),"number"!=typeof e&&(e=a.height);var g=a.width!==d||a.height!==e,h={x:b,y:c,width:d,height:e,maxWidth:a.maxWidth,maxHeight:a.maxHeight,minWidth:a.minWidth,minHeight:a.minHeight};return h=this._prepareNode(h,g),a.x===h.x&&a.y===h.y&&a.width===h.width&&a.height===h.height?null:(a._dirty=!0,a.x=a.lastTriedX=h.x,a.y=a.lastTriedY=h.y,a.width=a.lastTriedWidth=h.width,a.height=a.lastTriedHeight=h.height,this._fixCollisions(a),f||(this._packNodes(),this._notify()),a)},j.prototype.getRow=function(){return this.nodes.reduce(function(a,b){return Math.max(a,b.y+b.height)},0)},j.prototype.beginUpdate=function(a){a._updating||(a._updating=!0,this.nodes.forEach(function(a){a._packY=a.y}))},j.prototype.endUpdate=function(){var a=this.nodes.find(function(a){return a._updating});a&&(a._updating=!1,this.nodes.forEach(function(a){delete a._packY}))};var k=function(b,d){var i,k=this;d=d||{},this.$el=a(b),this.el=this.$el.get(0),e(d,"width","column","v0.5.3"),e(d,"height","maxRow","v0.5.3"),f(d,"oneColumnModeClass","v0.6.3",". Use class `.grid-stack-1` instead"),g(this.$el,"data-gs-width","data-gs-column","v0.5.3"),g(this.$el,"data-gs-height","data-gs-max-row","v0.5.3"),g(this.$el,"data-gs-current-height","data-gs-current-row","v1.0.0"),d.itemClass=d.itemClass||"grid-stack-item";var l=this.$el.closest("."+d.itemClass).length>0;d.row&&(d.minRow=d.maxRow=d.row,delete d.row);var m=parseInt(this.$el.attr("data-gs-row"));if(this.opts=h.defaults(d,{column:parseInt(this.$el.attr("data-gs-column"))||12,minRow:m||(parseInt(this.$el.attr("data-gs-min-row"))||0),maxRow:m||(parseInt(this.$el.attr("data-gs-max-row"))||0),itemClass:"grid-stack-item",placeholderClass:"grid-stack-placeholder",placeholderText:"",handle:".grid-stack-item-content",handleClass:null,styleInHead:!1,cellHeight:60,verticalMargin:20,auto:!0,minWidth:768,float:!1,staticGrid:!1,_class:"grid-stack-instance-"+(1e4*Math.random()).toFixed(0),animate:Boolean(this.$el.attr("data-gs-animate"))||!1,alwaysShowResizeHandle:d.alwaysShowResizeHandle||!1,resizable:h.defaults(d.resizable||{},{autoHide:!d.alwaysShowResizeHandle,handles:"se"}),draggable:h.defaults(d.draggable||{},{handle:(d.handleClass?"."+d.handleClass:d.handle?d.handle:"")||".grid-stack-item-content",scroll:!1,appendTo:"body"}),disableDrag:d.disableDrag||!1,disableResize:d.disableResize||!1,rtl:"auto",removable:!1,removableOptions:h.defaults(d.removableOptions||{},{accept:"."+d.itemClass}),removeTimeout:2e3,verticalMarginUnit:"px",cellHeightUnit:"px",disableOneColumnMode:d.disableOneColumnMode||!1,oneColumnModeDomSort:d.oneColumnModeDomSort,ddPlugin:null}),!1===this.opts.ddPlugin?this.opts.ddPlugin=c:null===this.opts.ddPlugin&&(this.opts.ddPlugin=c.registeredPlugins[0]||c),this.dd=new this.opts.ddPlugin(this),"auto"===this.opts.rtl&&(this.opts.rtl="rtl"===this.$el.css("direction")),this.opts.rtl&&this.$el.addClass("grid-stack-rtl"),this.opts.isNested=l,i="auto"===this.opts.cellHeight,i?k.cellHeight(k.cellWidth(),!0):this.cellHeight(this.opts.cellHeight,!0),this.verticalMargin(this.opts.verticalMargin,!0),this.$el.addClass(this.opts._class),this._setStaticClass(),l&&this.$el.addClass("grid-stack-nested"),this._initStyles(),this.engine=new j(this.opts.column,function(b,c){c=void 0===c||c;var d=0;this.nodes.forEach(function(a){d=Math.max(d,a.y+a.height)}),b.forEach(function(b){c&&null===b._id?b.el&&a(b.el).remove():a(b.el).attr("data-gs-x",b.x).attr("data-gs-y",b.y).attr("data-gs-width",b.width).attr("data-gs-height",b.height)}),k._updateStyles(d+10)},this.opts.float,this.opts.maxRow),this.opts.auto){var n=[],o=this;this.$el.children("."+this.opts.itemClass+":not(."+this.opts.placeholderClass+")").each(function(b,c){c=a(c);var d=parseInt(c.attr("data-gs-x")),e=parseInt(c.attr("data-gs-y"));n.push({el:c.get(0),i:(Number.isNaN(d)?1e3:d)+(Number.isNaN(e)?1e3:e)*o.opts.column})}),h.sortBy(n,function(a){return a.i}).forEach(function(a){this._prepareElement(a.el)},this)}if(this.engine._saveInitial(),this.setAnimation(this.opts.animate),this.placeholder=a('<div class="'+this.opts.placeholderClass+" "+this.opts.itemClass+'"><div class="placeholder-content">'+this.opts.placeholderText+"</div></div>").hide(),this._updateContainerHeight(),this._updateHeightsOnResize=h.throttle(function(){k.cellHeight(k.cellWidth(),!1)},100),this.onResizeHandler=function(){if(i&&k._updateHeightsOnResize(),!k.opts.disableOneColumnMode&&(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<=k.opts.minWidth){if(k.oneColumnMode)return;k.oneColumnMode=!0,k.column(1)}else{if(!k.oneColumnMode)return;k.oneColumnMode=!1,k.column(k._prevColumn)}},a(window).resize(this.onResizeHandler),this.onResizeHandler(),!k.opts.staticGrid&&"string"==typeof k.opts.removable){var p=a(k.opts.removable);this.dd.isDroppable(p)||this.dd.droppable(p,k.opts.removableOptions),this.dd.on(p,"dropover",function(b,c){var d=a(c.draggable),e=d.data("_gridstack_node");e&&e._grid===k&&(d.data("inTrashZone",!0),k._setupRemovingTimeout(d))}).on(p,"dropout",function(b,c){var d=a(c.draggable),e=d.data("_gridstack_node");e&&e._grid===k&&(d.data("inTrashZone",!1),k._clearRemovingTimeout(d))})}if(!k.opts.staticGrid&&k.opts.acceptWidgets){var q=null,r=function(a,b){var c=q,d=c.data("_gridstack_node"),e=k.getCellFromPixel({left:a.pageX,top:a.pageY},!0),f=Math.max(0,e.x),g=Math.max(0,e.y);d._added||(d._added=!0,d.el=c.get(0),d.autoPosition=!0,d.x=f,d.y=g,k.engine.cleanNodes(),k.engine.beginUpdate(d),k.engine.addNode(d),k.$el.append(k.placeholder),k.placeholder.attr("data-gs-x",d.x).attr("data-gs-y",d.y).attr("data-gs-width",d.width).attr("data-gs-height",d.height).show(),d.el=k.placeholder.get(0),d._beforeDragX=d.x,d._beforeDragY=d.y,k._updateContainerHeight()),k.engine.canMoveNode(d,f,g)&&(k.engine.moveNode(d,f,g),k._updateContainerHeight())};this.dd.droppable(k.$el,{accept:function(b){b=a(b);var c=b.data("_gridstack_node");return(!c||c._grid!==k)&&b.is(!0===k.opts.acceptWidgets?".grid-stack-item":k.opts.acceptWidgets)}}).on(k.$el,"dropover",function(b,c){var d,e,f=a(c.draggable),g=f.data("_gridstack_node");if(!g||!g.width||!g.height){var h=parseInt(f.attr("data-gs-width"));h>0&&(g=g||{},g.width=h);var i=parseInt(f.attr("data-gs-height"));i>0&&(g=g||{},g.height=i)}var j=k.cellWidth(),l=k.cellHeight(),m=k.opts.verticalMargin;d=g&&g.width?g.width:Math.ceil(f.outerWidth()/j),e=g&&g.height?g.height:Math.round((f.outerHeight()+m)/(l+m)),q=f;var n=k.engine._prepareNode({width:d,height:e,_added:!1,_temporary:!0});return n.isOutOfGrid=!0,f.data("_gridstack_node",n),f.data("_gridstack_node_orig",g),f.on("drag",r),!1}).on(k.$el,"dropout",function(b,c){var d=a(c.draggable);if(d.data("_gridstack_node")){var e=d.data("_gridstack_node");if(e.isOutOfGrid)return d.unbind("drag",r),e.el=null,k.engine.removeNode(e),k.placeholder.detach(),k._updateContainerHeight(),d.data("_gridstack_node",d.data("_gridstack_node_orig")),!1}}).on(k.$el,"drop",function(b,c){k.placeholder.detach();var d=a(c.draggable).data("_gridstack_node");d.isOutOfGrid=!1,d._grid=k;var e=a(c.draggable).clone(!1);e.data("_gridstack_node",d);var f=a(c.draggable).data("_gridstack_node_orig");return void 0!==f&&void 0!==f._grid&&f._grid._triggerRemoveEvent(),a(c.helper).remove(),d.el=e.get(0),k.placeholder.hide(),h.removePositioningStyles(e),e.find("div.ui-resizable-handle").remove(),e.attr("data-gs-x",d.x).attr("data-gs-y",d.y).attr("data-gs-width",d.width).attr("data-gs-height",d.height).addClass(k.opts.itemClass).enableSelection().removeData("draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled").unbind("drag",r),k.$el.append(e),k._prepareElementsByNode(e,d),k._updateContainerHeight(),k.engine._addedNodes.push(d),k._triggerAddEvent(),k._triggerChangeEvent(),k.engine.endUpdate(),a(c.draggable).unbind("drag",r),a(c.draggable).removeData("_gridstack_node"),a(c.draggable).removeData("_gridstack_node_orig"),k.$el.trigger("dropped",[f,d]),!1})}};k.prototype._triggerChangeEvent=function(){if(!this.engine._batchMode){var a=this.engine.getDirtyNodes(!0);a&&a.length&&(this.engine._layoutsNodesChange(a),this._triggerEvent("change",a)),this.engine._saveInitial()}},k.prototype._triggerAddEvent=function(){this.engine._batchMode||this.engine._addedNodes&&this.engine._addedNodes.length>0&&(this.engine._layoutsNodesChange(this.engine._addedNodes),this.engine._addedNodes.forEach(function(a){delete a._dirty}),this._triggerEvent("added",this.engine._addedNodes),this.engine._addedNodes=[])},k.prototype._triggerRemoveEvent=function(){this.engine._batchMode||this.engine._removedNodes&&this.engine._removedNodes.length>0&&(this._triggerEvent("removed",this.engine._removedNodes),this.engine._removedNodes=[])},k.prototype._triggerEvent=function(a,b){var c=new CustomEvent(a,{detail:b});this.el.dispatchEvent(c)},k.prototype._initStyles=function(){this._stylesId&&h.removeStylesheet(this._stylesId),this._stylesId="gridstack-style-"+(1e5*Math.random()).toFixed();var a=this.opts.styleInHead?void 0:this.el.parentNode;this._styles=h.createStylesheet(this._stylesId,a),null!==this._styles&&(this._styles._max=0)},k.prototype._updateStyles=function(a){if(null!==this._styles&&void 0!==this._styles){var b,c="."+this.opts._class+" ."+this.opts.itemClass,d=this;if(void 0===a&&(a=this._styles._max),this._initStyles(),this._updateContainerHeight(),this.opts.cellHeight&&!(0!==this._styles._max&&a<=this._styles._max)&&(b=this.opts.verticalMargin&&this.opts.cellHeightUnit!==this.opts.verticalMarginUnit?function(a,b){return a&&b?"calc("+(d.opts.cellHeight*a+d.opts.cellHeightUnit)+" + "+(d.opts.verticalMargin*b+d.opts.verticalMarginUnit)+")":d.opts.cellHeight*a+d.opts.verticalMargin*b+d.opts.cellHeightUnit}:function(a,b){return d.opts.cellHeight*a+d.opts.verticalMargin*b+d.opts.cellHeightUnit},0===this._styles._max&&h.insertCSSRule(this._styles,c,"min-height: "+b(1,0)+";",0),a>this._styles._max)){for(var e=this._styles._max;e<a;++e)h.insertCSSRule(this._styles,c+'[data-gs-height="'+(e+1)+'"]',"height: "+b(e+1,e)+";",e),h.insertCSSRule(this._styles,c+'[data-gs-min-height="'+(e+1)+'"]',"min-height: "+b(e+1,e)+";",e),h.insertCSSRule(this._styles,c+'[data-gs-max-height="'+(e+1)+'"]',"max-height: "+b(e+1,e)+";",e),h.insertCSSRule(this._styles,c+'[data-gs-y="'+e+'"]',"top: "+b(e,e)+";",e);this._styles._max=a}}},k.prototype._updateContainerHeight=function(){if(!this.engine._batchMode){var a=this.engine.getRow();a<this.opts.minRow&&(a=this.opts.minRow);var b=parseInt(this.$el.css("min-height"));if(b>0){var c=this.opts.verticalMargin,d=Math.round((b+c)/(this.cellHeight()+c));a<d&&(a=d)}this.$el.attr("data-gs-current-row",a),this.opts.cellHeight&&(this.opts.verticalMargin?this.opts.cellHeightUnit===this.opts.verticalMarginUnit?this.$el.css("height",a*(this.opts.cellHeight+this.opts.verticalMargin)-this.opts.verticalMargin+this.opts.cellHeightUnit):this.$el.css("height","calc("+(a*this.opts.cellHeight+this.opts.cellHeightUnit)+" + "+(a*(this.opts.verticalMargin-1)+this.opts.verticalMarginUnit)+")"):this.$el.css("height",a*this.opts.cellHeight+this.opts.cellHeightUnit))}},k.prototype._setupRemovingTimeout=function(b){var c=this,d=a(b).data("_gridstack_node");!d._removeTimeout&&c.opts.removable&&(d._removeTimeout=setTimeout(function(){b.addClass("grid-stack-item-removing"),d._isAboutToRemove=!0},c.opts.removeTimeout))},k.prototype._clearRemovingTimeout=function(b){var c=a(b).data("_gridstack_node");c._removeTimeout&&(clearTimeout(c._removeTimeout),c._removeTimeout=null,b.removeClass("grid-stack-item-removing"),c._isAboutToRemove=!1)},k.prototype._prepareElementsByNode=function(b,c){var d,e,f=this,g=function(g,i){var j,k,l=Math.round(i.position.left/d),m=Math.floor((i.position.top+e/2)/e);if("drag"===g.type){var n=i.position.top-c._prevYPix;if(c._prevYPix=i.position.top,h.updateScrollPosition(b[0],i,n),b.data("inTrashZone")||l<0||l>=f.engine.column||m<0||!f.engine.float&&m>f.engine.getRow()){if(c._temporaryRemoved)return;!0===f.opts.removable&&f._setupRemovingTimeout(b),l=c._beforeDragX,m=c._beforeDragY,f.placeholder.detach(),f.placeholder.hide(),f.engine.removeNode(c),f._updateContainerHeight(),c._temporaryRemoved=!0}else f._clearRemovingTimeout(b),c._temporaryRemoved&&(f.engine.addNode(c),f.placeholder.attr("data-gs-x",l).attr("data-gs-y",m).attr("data-gs-width",j).attr("data-gs-height",k).show(),f.$el.append(f.placeholder),c.el=f.placeholder.get(0),c._temporaryRemoved=!1)}else if("resize"===g.type){if(l<0)return;j=Math.round(i.size.width/d),k=Math.round((i.size.height+f.verticalMargin())/e)}var o=void 0!==j?j:c.lastTriedWidth,p=void 0!==k?k:c.lastTriedHeight;!f.engine.canMoveNode(c,l,m,j,k)||c.lastTriedX===l&&c.lastTriedY===m&&c.lastTriedWidth===o&&c.lastTriedHeight===p||(c.lastTriedX=l,c.lastTriedY=m,c.lastTriedWidth=j,c.lastTriedHeight=k,f.engine.moveNode(c,l,m,j,k),f._updateContainerHeight(),"resize"===g.type&&a(g.target).trigger("gsresize",c))},i=function(g,h){f.$el.append(f.placeholder);var i=a(this);f.engine.cleanNodes(),f.engine.beginUpdate(c),d=f.cellWidth();var j=f.cellHeight();e=(f.$el.height()+f.verticalMargin())/parseInt(f.$el.attr("data-gs-current-row")),f.placeholder.attr("data-gs-x",i.attr("data-gs-x")).attr("data-gs-y",i.attr("data-gs-y")).attr("data-gs-width",i.attr("data-gs-width")).attr("data-gs-height",i.attr("data-gs-height")).show(),c.el=f.placeholder.get(0),c._beforeDragX=c.x,c._beforeDragY=c.y,c._prevYPix=h.position.top;var k=c.minHeight||1,l=f.opts.verticalMargin;f.dd.resizable(b,"option","minWidth",d*(c.minWidth||1)),f.dd.resizable(b,"option","minHeight",j*k+(k-1)*l),"resizestart"===g.type&&i.find(".grid-stack-item").trigger("resizestart")},j=function(d,e){var g=a(this);if(g.data("_gridstack_node")){if(f.placeholder.detach(),c.el=g.get(0),f.placeholder.hide(),c._isAboutToRemove){b.data("_gridstack_node")._grid._triggerRemoveEvent(),b.removeData("_gridstack_node"),b.remove()}else f._clearRemovingTimeout(b),c._temporaryRemoved?(h.removePositioningStyles(g),g.attr("data-gs-x",c._beforeDragX).attr("data-gs-y",c._beforeDragY).attr("data-gs-width",c.width).attr("data-gs-height",c.height),c.x=c._beforeDragX,c.y=c._beforeDragY,c._temporaryRemoved=!1,f.engine.addNode(c)):(h.removePositioningStyles(g),g.attr("data-gs-x",c.x).attr("data-gs-y",c.y).attr("data-gs-width",c.width).attr("data-gs-height",c.height));f._updateContainerHeight(),f._triggerChangeEvent(),f.engine.endUpdate();var i=g.find(".grid-stack");i.length&&"resizestop"===d.type&&(i.each(function(a,b){b.gridstack.onResizeHandler()}),g.find(".grid-stack-item").trigger("resizestop"),g.find(".grid-stack-item").trigger("gsresizestop")),"resizestop"===d.type&&f.$el.trigger("gsresizestop",g)}};this.dd.draggable(b,{start:i,stop:j,drag:g}).resizable(b,{start:i,stop:j,resize:g}),(c.noMove||this.opts.disableDrag||this.opts.staticGrid)&&this.dd.draggable(b,"disable"),(c.noResize||this.opts.disableResize||this.opts.staticGrid)&&this.dd.resizable(b,"disable"),this._writeAttr(b,c)},k.prototype._prepareElement=function(b,c){c=void 0!==c&&c;var d=this;b=a(b),b.addClass(this.opts.itemClass);var e=this._readAttr(b,{el:b.get(0),_grid:d});e=d.engine.addNode(e,c),b.data("_gridstack_node",e),this._prepareElementsByNode(b,e)},k.prototype._writeAttr=function(b,c){c&&(b=a(b),void 0!==c.x&&b.attr("data-gs-x",c.x),void 0!==c.y&&b.attr("data-gs-y",c.y),void 0!==c.width&&b.attr("data-gs-width",c.width),void 0!==c.height&&b.attr("data-gs-height",c.height),void 0!==c.autoPosition&&b.attr("data-gs-auto-position",!!c.autoPosition||null),void 0!==c.minWidth&&b.attr("data-gs-min-width",c.minWidth),void 0!==c.maxWidth&&b.attr("data-gs-max-width",c.maxWidth),void 0!==c.minHeight&&b.attr("data-gs-min-height",c.minHeight),void 0!==c.maxHeight&&b.attr("data-gs-max-height",c.maxHeight),void 0!==c.noResize&&b.attr("data-gs-no-resize",!!c.noResize||null),void 0!==c.noMove&&b.attr("data-gs-no-move",!!c.noMove||null),void 0!==c.locked&&b.attr("data-gs-locked",!!c.locked||null),void 0!==c.resizeHandles&&b.attr("data-gs-resize-handles",c.resizeHandles),void 0!==c.id&&b.attr("data-gs-id",c.id))},k.prototype._readAttr=function(b,c){return b=a(b),c=c||{},c.x=b.attr("data-gs-x"),c.y=b.attr("data-gs-y"),c.width=b.attr("data-gs-width"),c.height=b.attr("data-gs-height"),c.autoPosition=h.toBool(b.attr("data-gs-auto-position")),c.maxWidth=b.attr("data-gs-max-width"),c.minWidth=b.attr("data-gs-min-width"),c.maxHeight=b.attr("data-gs-max-height"),c.minHeight=b.attr("data-gs-min-height"),c.noResize=h.toBool(b.attr("data-gs-no-resize")),c.noMove=h.toBool(b.attr("data-gs-no-move")),c.locked=h.toBool(b.attr("data-gs-locked")),c.resizeHandles=b.attr("data-gs-resize-handles"),c.id=b.attr("data-gs-id"),c},k.prototype.setAnimation=function(a){a?this.$el.addClass("grid-stack-animate"):this.$el.removeClass("grid-stack-animate")},k.prototype.addWidget=function(b,c,d,e,f,g,i,j,k,l,m){if(void 0!==c&&"object"!=typeof c)return this.addWidget(b,{x:c,y:d,width:e,height:f,autoPosition:g,minWidth:i,maxWidth:j,minHeight:k,maxHeight:l,id:m});if(b=a(b),c){var n=this._readAttr(b);h.defaults(c,n),this.engine._prepareNode(c)}return this._writeAttr(b,c),this.$el.append(b),this.makeWidget(b)},k.prototype.makeWidget=function(b){return b=a(b),this._prepareElement(b,!0),this._updateContainerHeight(),this._triggerAddEvent(),this._triggerChangeEvent(!0),b.get(0)},k.prototype.willItFit=function(a,b,c,d,e){var f={x:a,y:b,width:c,height:d,autoPosition:e};return this.engine.canBePlacedWithRespectToHeight(f)},k.prototype.removeWidget=function(b,c){b=a(b);var d=b.data("_gridstack_node");d||(d=this.engine.getNodeDataByDOMEl(b.get(0))),d&&d.el.parentElement===this.el&&(b.removeData("_gridstack_node"),this.dd.draggable(b,"destroy").resizable(b,"destroy"),this.engine.removeNode(d,c),this._triggerRemoveEvent(),this._triggerChangeEvent(!0))},k.prototype.removeAll=function(b){this.engine.nodes.forEach(function(b){var c=a(b.el);c.removeData("_gridstack_node"),this.dd.draggable(c,"destroy").resizable(c,"destroy")},this),this.engine.removeAll(b),this._triggerRemoveEvent()},k.prototype.destroy=function(b){a(window).off("resize",this.onResizeHandler),!1===b?(this.removeAll(!1),this.$el.removeClass(this.opts._class),delete this.$el.get(0).gridstack):this.$el.remove(),h.removeStylesheet(this._stylesId),this.engine&&(this.engine=null)},k.prototype.resizable=function(b,c){var d=this;return b=a(b),b.each(function(b,e){e=a(e);var f=e.data("_gridstack_node");f&&(f.noResize=!c,f.noResize?d.dd.resizable(e,"disable"):d.dd.resizable(e,"enable"))}),this},k.prototype.movable=function(b,c){var d=this;return b=a(b),b.each(function(b,e){e=a(e);var f=e.data("_gridstack_node");f&&(f.noMove=!c,f.noMove?(d.dd.draggable(e,"disable"),e.removeClass("ui-draggable-handle")):(d.dd.draggable(e,"enable"),e.addClass("ui-draggable-handle")))}),this},k.prototype.enableMove=function(a,b){this.movable(this.$el.children("."+this.opts.itemClass),a),b&&(this.opts.disableDrag=!a)},k.prototype.enableResize=function(a,b){this.resizable(this.$el.children("."+this.opts.itemClass),a),b&&(this.opts.disableResize=!a)},k.prototype.disable=function(){this.movable(this.$el.children("."+this.opts.itemClass),!1),this.resizable(this.$el.children("."+this.opts.itemClass),!1),this.$el.trigger("disable")},k.prototype.enable=function(){this.movable(this.$el.children("."+this.opts.itemClass),!0),this.resizable(this.$el.children("."+this.opts.itemClass),!0),this.$el.trigger("enable")},k.prototype.locked=function(b,c){return b=a(b),b.each(function(b,d){d=a(d);var e=d.data("_gridstack_node");e&&(e.locked=c||!1,d.attr("data-gs-locked",e.locked?"yes":null))}),this},k.prototype.maxHeight=function(b,c){return b=a(b),b.each(function(b,d){d=a(d);var e=d.data("_gridstack_node");e&&(isNaN(c)||(e.maxHeight=c||!1,d.attr("data-gs-max-height",c)))}),this},k.prototype.minHeight=function(b,c){return b=a(b),b.each(function(b,d){d=a(d);var e=d.data("_gridstack_node");e&&(isNaN(c)||(e.minHeight=c||!1,d.attr("data-gs-min-height",c)))}),this},k.prototype.maxWidth=function(b,c){return b=a(b),b.each(function(b,d){d=a(d);var e=d.data("_gridstack_node");e&&(isNaN(c)||(e.maxWidth=c||!1,d.attr("data-gs-max-width",c)))}),this},k.prototype.minWidth=function(b,c){return b=a(b),b.each(function(b,d){d=a(d);var e=d.data("_gridstack_node");e&&(isNaN(c)||(e.minWidth=c||!1,d.attr("data-gs-min-width",c)))}),this},k.prototype._updateElement=function(b,c){b=a(b).first();var d=b.data("_gridstack_node");if(d){var e=this;e.engine.cleanNodes(),e.engine.beginUpdate(d),c.call(this,b,d),e._updateContainerHeight(),e._triggerChangeEvent(),e.engine.endUpdate()}},k.prototype.resize=function(a,b,c){this._updateElement(a,function(a,d){b=null!==b&&void 0!==b?b:d.width,c=null!==c&&void 0!==c?c:d.height,this.engine.moveNode(d,d.x,d.y,b,c)})},k.prototype.move=function(a,b,c){this._updateElement(a,function(a,d){b=null!==b&&void 0!==b?b:d.x,c=null!==c&&void 0!==c?c:d.y,this.engine.moveNode(d,b,c,d.width,d.height)})},k.prototype.update=function(a,b,c,d,e){this._updateElement(a,function(a,f){b=null!==b&&void 0!==b?b:f.x,c=null!==c&&void 0!==c?c:f.y,d=null!==d&&void 0!==d?d:f.width,e=null!==e&&void 0!==e?e:f.height,this.engine.moveNode(f,b,c,d,e)})},k.prototype.compact=function(){if(0!==this.engine.nodes.length){this.batchUpdate(),this.engine._sortNodes();var a=this.engine.nodes;this.engine.nodes=[],a.forEach(function(a){a.noMove||a.locked||(a.autoPosition=!0),this.engine.addNode(a,!1),a._dirty=!0},this),this.commit()}},k.prototype.verticalMargin=function(a,b){if(void 0===a)return this.opts.verticalMargin;var c=h.parseHeight(a);this.opts.verticalMarginUnit===c.unit&&this.opts.maxRow===c.height||(this.opts.verticalMarginUnit=c.unit,this.opts.verticalMargin=c.height,b||this._updateStyles())},k.prototype.cellHeight=function(a,b){if(void 0===a){if(this.opts.cellHeight&&"auto"!==this.opts.cellHeight)return this.opts.cellHeight;var c=this.$el.children("."+this.opts.itemClass).first(),d=c.attr("data-gs-height"),e=this.opts.verticalMargin;return Math.round((c.outerHeight()-(d-1)*e)/d)}var f=h.parseHeight(a);this.opts.cellHeightUnit===f.unit&&this.opts.cellHeight===f.height||(this.opts.cellHeightUnit=f.unit,this.opts.cellHeight=f.height,b||this._updateStyles())},k.prototype.cellWidth=function(){return Math.round(this.$el.outerWidth()/this.opts.column)},k.prototype.getCellFromPixel=function(a,b){var c=void 0!==b&&b?this.$el.offset():this.$el.position(),d=a.left-c.left,e=a.top-c.top,f=Math.floor(this.$el.width()/this.opts.column),g=Math.floor(this.$el.height()/parseInt(this.$el.attr("data-gs-current-row")));return{x:Math.floor(d/f),y:Math.floor(e/g)}},k.prototype.batchUpdate=function(){this.engine.batchUpdate()},k.prototype.commit=function(){this.engine.commit(),this._triggerRemoveEvent(),this._triggerAddEvent(),this._triggerChangeEvent()},k.prototype.isAreaEmpty=function(a,b,c,d){return this.engine.isAreaEmpty(a,b,c,d)},k.prototype.setStatic=function(a){this.opts.staticGrid=!0===a,this.enableMove(!a),this.enableResize(!a),this._setStaticClass()},k.prototype._setStaticClass=function(){!0===this.opts.staticGrid?this.$el.addClass("grid-stack-static"):this.$el.removeClass("grid-stack-static")},j.prototype._layoutsNodesChange=function(a){this._layouts&&!this._ignoreLayoutsNodeChange&&this._layouts.forEach(function(b,c){b&&c!==this.column&&(c<this.column?this._layouts[c]=void 0:a.forEach(function(a){var d=b.find(function(b){return b._id===a._id});if(d){var e=c/this.column;a.y!==a._origY&&(d.y+=a.y-a._origY),a.x!==a._origX&&(d.x=Math.round(a.x*e)),a.width!==a._origW&&(d.width=Math.round(a.width*e))}
},this))},this)},j.prototype._updateNodeWidths=function(a,b,c){if(this.nodes.length&&a!==b){var d=[this.nodes.length];if(this.nodes.forEach(function(a,b){d[b]={x:a.x,y:a.y,width:a.width,_id:a._id}}),this._layouts=this._layouts||[],this._layouts[a]=d,1===b&&c&&c.length){var e=0;c.forEach(function(a){a.x=0,a.width=1,a.y=Math.max(a.y,e),e=a.y+a.height})}else c=h.sort(this.nodes,-1,a);var f=this._layouts[b]||[],g=this._layouts.length-1;0===f.length&&b>a&&b<g&&(f=this._layouts[g]||[],f.length&&(a=g,f.forEach(function(a){var b=c.findIndex(function(b){return b&&b._id===a._id});-1!==b&&(c[b].x=a.x,c[b].y=a.y,c[b].width=a.width)}),f=[]));var i=[];f.forEach(function(a){var b=c.findIndex(function(b){return b&&b._id===a._id});-1!==b&&(c[b].x=a.x,c[b].y=a.y,c[b].width=a.width,i.push(c[b]),c[b]=null)});var j=b/a;c.forEach(function(c){c&&(c.x=1===b?0:Math.round(c.x*j),c.width=1===b||1===a?1:Math.round(c.width*j)||1,i.push(c))}),i=h.sort(i,-1,b),this._ignoreLayoutsNodeChange=!0,this.batchUpdate(),this.nodes=[],i.forEach(function(a){this.addNode(a,!1),a._dirty=!0},this),this.commit(),delete this._ignoreLayoutsNodeChange}},j.prototype._saveInitial=function(){this.nodes.forEach(function(a){a._origX=a.x,a._origY=a.y,a._origW=a.width,a._origH=a.height,delete a._dirty})},k.prototype.column=function(b,c){if(void 0===b)return this.opts.column;if(this.opts.column!==b){var d=this.opts.column;if(1===b?this._prevColumn=d:delete this._prevColumn,this.$el.removeClass("grid-stack-"+d),this.$el.addClass("grid-stack-"+b),this.opts.column=this.engine.column=b,!0!==c){var e;this.opts.oneColumnModeDomSort&&1===b&&(e=[],this.$el.children("."+this.opts.itemClass).each(function(b,c){var d=a(c).data("_gridstack_node");d&&e.push(d)}),e.length||(e=void 0)),this.engine._updateNodeWidths(d,b,e),this.engine._ignoreLayoutsNodeChange=!0,this._triggerChangeEvent(),delete this.engine._ignoreLayoutsNodeChange}}},k.prototype.float=function(a){if(void 0===a)return this.opts.float||!1;this.opts.float!==a&&(this.opts.float=this.engine.float=a||!1,a||(this.engine._packNodes(),this.engine._notify(),this._triggerChangeEvent()))},k.prototype.getRow=function(){return this.engine.getRow()},k.prototype.on=function(a,b){if(-1!==a.indexOf(" ")){return void a.split(" ").forEach(function(a){this.on(a,b)},this)}"change"===a||"added"===a||"removed"===a?(this._gsEventHandler=this._gsEventHandler||{},this._gsEventHandler[a]=function(a){b(a,a.detail)},this.el.addEventListener(a,this._gsEventHandler[a])):this.$el.on(a,b)},k.prototype.off=function(a){if(-1!==a.indexOf(" ")){return void a.split(" ").forEach(function(a){this.off(a,callback)},this)}"change"===a||"added"===a||"removed"===a?this._gsEventHandler&&this._gsEventHandler[a]&&(this.el.removeEventListener(a,this._gsEventHandler[a]),delete this._gsEventHandler[a]):this.$el.off(a)},k.prototype.setGridWidth=d(k.prototype.column,"setGridWidth","column","v0.5.3"),k.prototype.setColumn=d(k.prototype.column,"setColumn","column","v0.6.4"),j.prototype.getGridHeight=d(j.prototype.getRow,"getGridHeight","getRow","v1.0.0"),b.GridStack=k,b.GridStack.Utils=h,b.GridStack.Engine=j,b.GridStack.DragDropPlugin=c,k.init=function(b,c){c||(c=".grid-stack");var d=a(c).get(0);if(d)return d.gridstack||(d.gridstack=new k(d,h.clone(b))),d.gridstack},k.initAll=function(b,c){c||(c=".grid-stack");var d=[];return a(c).each(function(a,c){c.gridstack||(c.gridstack=new k(c,h.clone(b))),d.push(c.gridstack)}),d},b.GridStack}(window.jQuery,window)}(),function(a){!function(a,b,c){function d(a){b.DragDropPlugin.call(this,a)}b.DragDropPlugin.registerPlugin(d),d.prototype=Object.create(b.DragDropPlugin.prototype),d.prototype.constructor=d,d.prototype.resizable=function(b,c){if(b=a(b),"disable"===c||"enable"===c||"destroy"===c)b.resizable(c);else if("option"===c){var d=arguments[2],e=arguments[3];b.resizable(c,d,e)}else{var f=b.data("gs-resize-handles")?b.data("gs-resize-handles"):this.grid.opts.resizable.handles;b.resizable(a.extend({},this.grid.opts.resizable,{handles:f},{start:c.start||function(){},stop:c.stop||function(){},resize:c.resize||function(){}}))}return this},d.prototype.draggable=function(b,c){return b=a(b),"disable"===c||"enable"===c||"destroy"===c?b.draggable(c):b.draggable(a.extend({},this.grid.opts.draggable,{containment:this.grid.opts.isNested&&!this.grid.opts.dragOut?this.grid.$el.parent():this.grid.opts.draggable.containment||null,start:c.start||function(){},stop:c.stop||function(){},drag:c.drag||function(){}})),this},d.prototype.droppable=function(b,c){return b=a(b),b.droppable(c),this},d.prototype.isDroppable=function(b,c){return b=a(b),Boolean(b.data("droppable"))},d.prototype.on=function(b,c,d){return a(b).on(c,d),this},c.JQueryUIGridStackDragDropPlugin=d}(jQuery,GridStack,window)}(),function(a,b){"function"==typeof define&&define.amd?define("sifter",b):"object"==typeof exports?module.exports=b():a.Sifter=b()}(this,function(){var a=function(a,b){this.items=a,this.settings=b||{diacritics:!0}};a.prototype.tokenize=function(a){if(!(a=d(String(a||"").toLowerCase()))||!a.length)return[];var b,c,f,h,i=[],j=a.split(/ +/);for(b=0,c=j.length;b<c;b++){if(f=e(j[b]),this.settings.diacritics)for(h in g)g.hasOwnProperty(h)&&(f=f.replace(new RegExp(h,"g"),g[h]));i.push({string:j[b],regex:new RegExp(f,"i")})}return i},a.prototype.iterator=function(a,b){var c;c=f(a)?Array.prototype.forEach||function(a){for(var b=0,c=this.length;b<c;b++)a(this[b],b,this)}:function(a){for(var b in this)this.hasOwnProperty(b)&&a(this[b],b,this)},c.apply(a,[b])},a.prototype.getScoreFunction=function(a,b){var c,d,e,f;c=this,a=c.prepareSearch(a,b),e=a.tokens,d=a.options.fields,f=e.length;var g=function(a,b){var c,d;return a?(a=String(a||""),-1===(d=a.search(b.regex))?0:(c=b.string.length/a.length,0===d&&(c+=.5),c)):0},h=function(){var a=d.length;return a?1===a?function(a,b){return g(b[d[0]],a)}:function(b,c){for(var e=0,f=0;e<a;e++)f+=g(c[d[e]],b);return f/a}:function(){return 0}}();return f?1===f?function(a){return h(e[0],a)}:"and"===a.options.conjunction?function(a){for(var b,c=0,d=0;c<f;c++){if((b=h(e[c],a))<=0)return 0;d+=b}return d/f}:function(a){for(var b=0,c=0;b<f;b++)c+=h(e[b],a);return c/f}:function(){return 0}},a.prototype.getSortFunction=function(a,c){var d,e,f,g,h,i,j,k,l,m,n;if(f=this,a=f.prepareSearch(a,c),n=!a.query&&c.sort_empty||c.sort,l=function(a,b){return"$score"===a?b.score:f.items[b.id][a]},h=[],n)for(d=0,e=n.length;d<e;d++)(a.query||"$score"!==n[d].field)&&h.push(n[d]);if(a.query){for(m=!0,d=0,e=h.length;d<e;d++)if("$score"===h[d].field){m=!1;break}m&&h.unshift({field:"$score",direction:"desc"})}else for(d=0,e=h.length;d<e;d++)if("$score"===h[d].field){h.splice(d,1);break}for(k=[],d=0,e=h.length;d<e;d++)k.push("desc"===h[d].direction?-1:1);return i=h.length,i?1===i?(g=h[0].field,j=k[0],function(a,c){return j*b(l(g,a),l(g,c))}):function(a,c){var d,e,f;for(d=0;d<i;d++)if(f=h[d].field,e=k[d]*b(l(f,a),l(f,c)))return e;return 0}:null},a.prototype.prepareSearch=function(a,b){if("object"==typeof a)return a;b=c({},b);var d=b.fields,e=b.sort,g=b.sort_empty;return d&&!f(d)&&(b.fields=[d]),e&&!f(e)&&(b.sort=[e]),g&&!f(g)&&(b.sort_empty=[g]),{options:b,query:String(a||"").toLowerCase(),tokens:this.tokenize(a),total:0,items:[]}},a.prototype.search=function(a,b){var c,d,e,f,g=this;return d=this.prepareSearch(a,b),b=d.options,a=d.query,f=b.score||g.getScoreFunction(d),a.length?g.iterator(g.items,function(a,e){c=f(a),(!1===b.filter||c>0)&&d.items.push({score:c,id:e})}):g.iterator(g.items,function(a,b){d.items.push({score:1,id:b})}),e=g.getSortFunction(d,b),e&&d.items.sort(e),d.total=d.items.length,"number"==typeof b.limit&&(d.items=d.items.slice(0,b.limit)),d};var b=function(a,b){return"number"==typeof a&&"number"==typeof b?a>b?1:a<b?-1:0:(a=h(String(a||"")),b=h(String(b||"")),a>b?1:b>a?-1:0)},c=function(a,b){var c,d,e,f;for(c=1,d=arguments.length;c<d;c++)if(f=arguments[c])for(e in f)f.hasOwnProperty(e)&&(a[e]=f[e]);return a},d=function(a){return(a+"").replace(/^\s+|\s+$|/g,"")},e=function(a){return(a+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},f=Array.isArray||$&&$.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},g={a:"[aÀÁÂÃÄÅàáâãäåĀāąĄ]",c:"[cÇçćĆčČ]",d:"[dđĐďĎ]",e:"[eÈÉÊËèéêëěĚĒēęĘ]",i:"[iÌÍÎÏìíîïĪī]",l:"[lłŁ]",n:"[nÑñňŇńŃ]",o:"[oÒÓÔÕÕÖØòóôõöøŌō]",r:"[rřŘ]",s:"[sŠšśŚ]",t:"[tťŤ]",u:"[uÙÚÛÜùúûüůŮŪū]",y:"[yŸÿýÝ]",z:"[zŽžżŻźŹ]"},h=function(){var a,b,c,d,e="",f={};for(c in g)if(g.hasOwnProperty(c))for(d=g[c].substring(2,g[c].length-1),e+=d,a=0,b=d.length;a<b;a++)f[d.charAt(a)]=c;var h=new RegExp("["+e+"]","g");return function(a){return a.replace(h,function(a){return f[a]}).toLowerCase()}}();return a}),function(a,b){"function"==typeof define&&define.amd?define("microplugin",b):"object"==typeof exports?module.exports=b():a.MicroPlugin=b()}(this,function(){var a={};a.mixin=function(a){a.plugins={},a.prototype.initializePlugins=function(a){var c,d,e,f=this,g=[];if(f.plugins={names:[],settings:{},requested:{},loaded:{}},b.isArray(a))for(c=0,d=a.length;c<d;c++)"string"==typeof a[c]?g.push(a[c]):(f.plugins.settings[a[c].name]=a[c].options,g.push(a[c].name));else if(a)for(e in a)a.hasOwnProperty(e)&&(f.plugins.settings[e]=a[e],g.push(e));for(;g.length;)f.require(g.shift())},a.prototype.loadPlugin=function(b){var c=this,d=c.plugins,e=a.plugins[b];if(!a.plugins.hasOwnProperty(b))throw new Error('Unable to find "'+b+'" plugin');d.requested[b]=!0,d.loaded[b]=e.fn.apply(c,[c.plugins.settings[b]||{}]),d.names.push(b)},a.prototype.require=function(a){var b=this,c=b.plugins;if(!b.plugins.loaded.hasOwnProperty(a)){if(c.requested[a])throw new Error('Plugin has circular dependency ("'+a+'")');b.loadPlugin(a)}return c.loaded[a]},a.define=function(b,c){a.plugins[b]={name:b,fn:c}}};var b={isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}};return a}),function(a,b){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],b):"object"==typeof exports?module.exports=b(require("jquery"),require("sifter"),require("microplugin")):a.Selectize=b(a.jQuery,a.Sifter,a.MicroPlugin)}(this,function(a,b,c){"use strict";var d=function(a,b){if("string"!=typeof b||b.length){var c="string"==typeof b?new RegExp(b,"i"):b,d=function(a){var b=0;if(3===a.nodeType){var e=a.data.search(c);if(e>=0&&a.data.length>0){var f=a.data.match(c),g=document.createElement("span");g.className="highlight";var h=a.splitText(e),i=(h.splitText(f[0].length),h.cloneNode(!0));g.appendChild(i),h.parentNode.replaceChild(g,h),b=1}}else if(1===a.nodeType&&a.childNodes&&!/(script|style)/i.test(a.tagName))for(var j=0;j<a.childNodes.length;++j)j+=d(a.childNodes[j]);return b};return a.each(function(){d(this)})}},e=function(){};e.prototype={on:function(a,b){this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(b)},off:function(a,b){var c=arguments.length;return 0===c?delete this._events:1===c?delete this._events[a]:(this._events=this._events||{},void(a in this._events!=!1&&this._events[a].splice(this._events[a].indexOf(b),1)))},trigger:function(a){if(this._events=this._events||{},a in this._events!=!1)for(var b=0;b<this._events[a].length;b++)this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))}},e.mixin=function(a){for(var b=["on","off","trigger"],c=0;c<b.length;c++)a.prototype[b[c]]=e.prototype[b[c]]};var f=/Mac/.test(navigator.userAgent),g=f?91:17,h=f?18:17,i=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("form").validity,j=function(a){return void 0!==a},k=function(a){return void 0===a||null===a?null:"boolean"==typeof a?a?"1":"0":a+""},l=function(a){return(a+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},m=function(a){return(a+"").replace(/\$/g,"$$$$")},n={};n.before=function(a,b,c){var d=a[b];a[b]=function(){return c.apply(a,arguments),d.apply(a,arguments)}},n.after=function(a,b,c){var d=a[b];a[b]=function(){var b=d.apply(a,arguments);return c.apply(a,arguments),b}};var o=function(a){var b=!1;return function(){b||(b=!0,a.apply(this,arguments))}},p=function(a,b){var c;return function(){var d=this,e=arguments;window.clearTimeout(c),c=window.setTimeout(function(){a.apply(d,e)},b)}},q=function(a,b,c){var d,e=a.trigger,f={};a.trigger=function(){var c=arguments[0];if(-1===b.indexOf(c))return e.apply(a,arguments);f[c]=arguments},c.apply(a,[]),a.trigger=e;for(d in f)f.hasOwnProperty(d)&&e.apply(a,f[d])},r=function(a,b,c,d){a.on(b,c,function(b){for(var c=b.target;c&&c.parentNode!==a[0];)c=c.parentNode;return b.currentTarget=c,d.apply(this,[b])})},s=function(a){var b={};if("selectionStart"in a)b.start=a.selectionStart,b.length=a.selectionEnd-b.start;else if(document.selection){a.focus();var c=document.selection.createRange(),d=document.selection.createRange().text.length;c.moveStart("character",-a.value.length),b.start=c.text.length-d,b.length=d}return b},t=function(a,b,c){var d,e,f={};if(c)for(d=0,e=c.length;d<e;d++)f[c[d]]=a.css(c[d]);else f=a.css();b.css(f)},u=function(b,c){if(!b)return 0;var d=a("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(b).appendTo("body");t(c,d,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var e=d.width();return d.remove(),e},v=function(a){var b=null,c=function(c,d){var e,f,g,h,i,j,k,l;c=c||window.event||{},d=d||{},c.metaKey||c.altKey||(d.force||!1!==a.data("grow"))&&(e=a.val(),c.type&&"keydown"===c.type.toLowerCase()&&(f=c.keyCode,g=f>=97&&f<=122||f>=65&&f<=90||f>=48&&f<=57||32===f,46===f||8===f?(l=s(a[0]),l.length?e=e.substring(0,l.start)+e.substring(l.start+l.length):8===f&&l.start?e=e.substring(0,l.start-1)+e.substring(l.start+1):46===f&&void 0!==l.start&&(e=e.substring(0,l.start)+e.substring(l.start+1))):g&&(j=c.shiftKey,k=String.fromCharCode(c.keyCode),k=j?k.toUpperCase():k.toLowerCase(),e+=k)),h=a.attr("placeholder"),!e&&h&&(e=h),(i=u(e,a)+4)!==b&&(b=i,a.width(i),a.triggerHandler("resize")))};a.on("keydown keyup update blur",c),c()},w=function(c,d){var e,f,g,h,i=this;h=c[0],h.selectize=i;var j=window.getComputedStyle&&window.getComputedStyle(h,null);if(g=j?j.getPropertyValue("direction"):h.currentStyle&&h.currentStyle.direction,g=g||c.parents("[dir]:first").attr("dir")||"",a.extend(i,{order:0,settings:d,$input:c,tabIndex:c.attr("tabindex")||"",tagType:"select"===h.tagName.toLowerCase()?1:2,rtl:/rtl/i.test(g),eventNS:".selectize"+ ++w.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:c.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===d.loadThrottle?i.onSearchChange:p(i.onSearchChange,d.loadThrottle)}),i.sifter=new b(this.options,{diacritics:d.diacritics}),i.settings.options){for(e=0,f=i.settings.options.length;e<f;e++)i.registerOption(i.settings.options[e]);delete i.settings.options}if(i.settings.optgroups){for(e=0,f=i.settings.optgroups.length;e<f;e++)i.registerOptionGroup(i.settings.optgroups[e]);delete i.settings.optgroups}i.settings.mode=i.settings.mode||(1===i.settings.maxItems?"single":"multi"),"boolean"!=typeof i.settings.hideSelected&&(i.settings.hideSelected="multi"===i.settings.mode),i.initializePlugins(i.settings.plugins),i.setupCallbacks(),i.setupTemplates(),i.setup()};return e.mixin(w),c.mixin(w),a.extend(w.prototype,{setup:function(){var b,c,d,e,j,k,l,m,n,o=this,p=o.settings,q=o.eventNS,s=a(window),t=a(document),u=o.$input;if(l=o.settings.mode,m=u.attr("class")||"",b=a("<div>").addClass(p.wrapperClass).addClass(m).addClass(l),c=a("<div>").addClass(p.inputClass).addClass("items").appendTo(b),d=a('<input type="text" autocomplete="off" />').appendTo(c).attr("tabindex",u.is(":disabled")?"-1":o.tabIndex),k=a(p.dropdownParent||b),e=a("<div>").addClass(p.dropdownClass).addClass(l).hide().appendTo(k),j=a("<div>").addClass(p.dropdownContentClass).appendTo(e),o.settings.copyClassesToDropdown&&e.addClass(m),b.css({width:u[0].style.width}),o.plugins.names.length&&(n="plugin-"+o.plugins.names.join(" plugin-"),b.addClass(n),e.addClass(n)),(null===p.maxItems||p.maxItems>1)&&1===o.tagType&&u.attr("multiple","multiple"),o.settings.placeholder&&d.attr("placeholder",p.placeholder),!o.settings.splitOn&&o.settings.delimiter){var w=o.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");o.settings.splitOn=new RegExp("\\s*"+w+"+\\s*")}u.attr("autocorrect")&&d.attr("autocorrect",u.attr("autocorrect")),u.attr("autocapitalize")&&d.attr("autocapitalize",u.attr("autocapitalize")),o.$wrapper=b,o.$control=c,o.$control_input=d,o.$dropdown=e,o.$dropdown_content=j,e.on("mouseenter","[data-selectable]",function(){return o.onOptionHover.apply(o,arguments)}),e.on("mousedown click","[data-selectable]",function(){return o.onOptionSelect.apply(o,arguments)}),r(c,"mousedown","*:not(input)",function(){return o.onItemSelect.apply(o,arguments)}),v(d),c.on({mousedown:function(){return o.onMouseDown.apply(o,arguments)},click:function(){return o.onClick.apply(o,arguments)}}),d.on({mousedown:function(a){a.stopPropagation()},keydown:function(){return o.onKeyDown.apply(o,arguments)},keyup:function(){return o.onKeyUp.apply(o,arguments)},keypress:function(){return o.onKeyPress.apply(o,arguments)},resize:function(){o.positionDropdown.apply(o,[])},blur:function(){return o.onBlur.apply(o,arguments)},focus:function(){return o.ignoreBlur=!1,o.onFocus.apply(o,arguments)},paste:function(){return o.onPaste.apply(o,arguments)}}),t.on("keydown"+q,function(a){o.isCmdDown=a[f?"metaKey":"ctrlKey"],o.isCtrlDown=a[f?"altKey":"ctrlKey"],o.isShiftDown=a.shiftKey}),t.on("keyup"+q,function(a){a.keyCode===h&&(o.isCtrlDown=!1),16===a.keyCode&&(o.isShiftDown=!1),a.keyCode===g&&(o.isCmdDown=!1)}),t.on("mousedown"+q,function(a){if(o.isFocused){if(a.target===o.$dropdown[0]||a.target.parentNode===o.$dropdown[0])return!1;o.$control.has(a.target).length||a.target===o.$control[0]||o.blur(a.target)}}),s.on(["scroll"+q,"resize"+q].join(" "),function(){o.isOpen&&o.positionDropdown.apply(o,arguments)}),s.on("mousemove"+q,function(){o.ignoreHover=!1}),this.revertSettings={$children:u.children().detach(),tabindex:u.attr("tabindex")},u.attr("tabindex",-1).hide().after(o.$wrapper),a.isArray(p.items)&&(o.setValue(p.items),delete p.items),i&&u.on("invalid"+q,function(a){a.preventDefault(),o.isInvalid=!0,o.refreshState()}),o.updateOriginalInput(),o.refreshItems(),o.refreshState(),o.updatePlaceholder(),o.isSetup=!0,u.is(":disabled")&&o.disable(),o.on("change",this.onChange),u.data("selectize",o),u.addClass("selectized"),o.trigger("initialize"),!0===p.preload&&o.onSearchChange("")},setupTemplates:function(){var b=this,c=b.settings.labelField,d=b.settings.optgroupLabelField,e={optgroup:function(a){return'<div class="optgroup">'+a.html+"</div>"},optgroup_header:function(a,b){return'<div class="optgroup-header">'+b(a[d])+"</div>"},option:function(a,b){return'<div class="option">'+b(a[c])+"</div>"},item:function(a,b){return'<div class="item">'+b(a[c])+"</div>"},option_create:function(a,b){return'<div class="create">Add <strong>'+b(a.input)+"</strong>&hellip;</div>"}};b.settings.render=a.extend({},e,b.settings.render)},setupCallbacks:function(){var a,b,c={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(a in c)c.hasOwnProperty(a)&&(b=this.settings[c[a]])&&this.on(a,b)},onClick:function(a){var b=this;b.isFocused||(b.focus(),a.preventDefault())},onMouseDown:function(b){var c=this,d=b.isDefaultPrevented();a(b.target);if(c.isFocused){if(b.target!==c.$control_input[0])return"single"===c.settings.mode?c.isOpen?c.close():c.open():d||c.setActiveItem(null),!1}else d||window.setTimeout(function(){c.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(b){var c=this;c.isFull()||c.isInputHidden||c.isLocked?b.preventDefault():c.settings.splitOn&&setTimeout(function(){for(var b=a.trim(c.$control_input.val()||"").split(c.settings.splitOn),d=0,e=b.length;d<e;d++)c.createItem(b[d])},0)},onKeyPress:function(a){if(this.isLocked)return a&&a.preventDefault();var b=String.fromCharCode(a.keyCode||a.which);return this.settings.create&&"multi"===this.settings.mode&&b===this.settings.delimiter?(this.createItem(),a.preventDefault(),!1):void 0},onKeyDown:function(a){var b=(a.target,this.$control_input[0],this);if(b.isLocked)return void(9!==a.keyCode&&a.preventDefault());switch(a.keyCode){case 65:if(b.isCmdDown)return void b.selectAll();break;case 27:return void(b.isOpen&&(a.preventDefault(),a.stopPropagation(),b.close()));case 78:if(!a.ctrlKey||a.altKey)break;case 40:if(!b.isOpen&&b.hasOptions)b.open();else if(b.$activeOption){b.ignoreHover=!0;var c=b.getAdjacentOption(b.$activeOption,1);c.length&&b.setActiveOption(c,!0,!0)}return void a.preventDefault();case 80:if(!a.ctrlKey||a.altKey)break;case 38:if(b.$activeOption){b.ignoreHover=!0;var d=b.getAdjacentOption(b.$activeOption,-1);d.length&&b.setActiveOption(d,!0,!0)}return void a.preventDefault();case 13:return void(b.isOpen&&b.$activeOption&&(b.onOptionSelect({currentTarget:b.$activeOption}),a.preventDefault()));case 37:return void b.advanceSelection(-1,a);case 39:return void b.advanceSelection(1,a);case 9:return b.settings.selectOnTab&&b.isOpen&&b.$activeOption&&(b.onOptionSelect({currentTarget:b.$activeOption}),b.isFull()||a.preventDefault()),void(b.settings.create&&b.createItem()&&a.preventDefault());case 8:case 46:return void b.deleteSelection(a)}return!b.isFull()&&!b.isInputHidden||(f?a.metaKey:a.ctrlKey)?void 0:void a.preventDefault()},onKeyUp:function(a){var b=this;if(b.isLocked)return a&&a.preventDefault();var c=b.$control_input.val()||"";b.lastValue!==c&&(b.lastValue=c,b.onSearchChange(c),b.refreshOptions(),b.trigger("type",c))},onSearchChange:function(a){var b=this,c=b.settings.load;c&&(b.loadedSearches.hasOwnProperty(a)||(b.loadedSearches[a]=!0,b.load(function(d){c.apply(b,[a,d])})))},onFocus:function(a){var b=this,c=b.isFocused;if(b.isDisabled)return b.blur(),a&&a.preventDefault(),!1;b.ignoreFocus||(b.isFocused=!0,"focus"===b.settings.preload&&b.onSearchChange(""),c||b.trigger("focus"),b.$activeItems.length||(b.showInput(),b.setActiveItem(null),b.refreshOptions(!!b.settings.openOnFocus)),b.refreshState())},onBlur:function(a,b){var c=this;if(c.isFocused&&(c.isFocused=!1,!c.ignoreFocus)){if(!c.ignoreBlur&&document.activeElement===c.$dropdown_content[0])return c.ignoreBlur=!0,void c.onFocus(a);var d=function(){c.close(),c.setTextboxValue(""),c.setActiveItem(null),c.setActiveOption(null),c.setCaret(c.items.length),c.refreshState(),(b||document.body).focus(),c.ignoreFocus=!1,c.trigger("blur")};c.ignoreFocus=!0,c.settings.create&&c.settings.createOnBlur?c.createItem(null,!1,d):d()}},onOptionHover:function(a){this.ignoreHover||this.setActiveOption(a.currentTarget,!1)},onOptionSelect:function(b){var c,d,e=this;b.preventDefault&&(b.preventDefault(),b.stopPropagation()),d=a(b.currentTarget),d.hasClass("create")?e.createItem(null,function(){e.settings.closeAfterSelect&&e.close()}):void 0!==(c=d.attr("data-value"))&&(e.lastQuery=null,e.setTextboxValue(""),e.addItem(c),e.settings.closeAfterSelect?e.close():!e.settings.hideSelected&&b.type&&/mouse/.test(b.type)&&e.setActiveOption(e.getOption(c)))},onItemSelect:function(a){var b=this;b.isLocked||"multi"===b.settings.mode&&(a.preventDefault(),b.setActiveItem(a.currentTarget,a))},load:function(a){var b=this,c=b.$wrapper.addClass(b.settings.loadingClass);b.loading++,a.apply(b,[function(a){b.loading=Math.max(b.loading-1,0),a&&a.length&&(b.addOption(a),b.refreshOptions(b.isFocused&&!b.isInputHidden)),b.loading||c.removeClass(b.settings.loadingClass),b.trigger("load",a)}])},setTextboxValue:function(a){var b=this.$control_input;b.val()!==a&&(b.val(a).triggerHandler("update"),this.lastValue=a)},getValue:function(){return 1===this.tagType&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(a,b){q(this,b?[]:["change"],function(){this.clear(),this.addItems(a,b)})},setActiveItem:function(b,c){var d,e,f,g,h,i,j,k,l=this;if("single"!==l.settings.mode){if(b=a(b),!b.length)return a(l.$activeItems).removeClass("active"),l.$activeItems=[],void(l.isFocused&&l.showInput());if("mousedown"===(d=c&&c.type.toLowerCase())&&l.isShiftDown&&l.$activeItems.length){for(k=l.$control.children(".active:last"),g=Array.prototype.indexOf.apply(l.$control[0].childNodes,[k[0]]),h=Array.prototype.indexOf.apply(l.$control[0].childNodes,[b[0]]),g>h&&(j=g,g=h,h=j),e=g;e<=h;e++)i=l.$control[0].childNodes[e],-1===l.$activeItems.indexOf(i)&&(a(i).addClass("active"),l.$activeItems.push(i));c.preventDefault()}else"mousedown"===d&&l.isCtrlDown||"keydown"===d&&this.isShiftDown?b.hasClass("active")?(f=l.$activeItems.indexOf(b[0]),l.$activeItems.splice(f,1),b.removeClass("active")):l.$activeItems.push(b.addClass("active")[0]):(a(l.$activeItems).removeClass("active"),l.$activeItems=[b.addClass("active")[0]]);l.hideInput(),this.isFocused||l.focus()}},setActiveOption:function(b,c,d){var e,f,g,h,i,k=this;k.$activeOption&&k.$activeOption.removeClass("active"),k.$activeOption=null,b=a(b),b.length&&(k.$activeOption=b.addClass("active"),!c&&j(c)||(e=k.$dropdown_content.height(),f=k.$activeOption.outerHeight(!0),c=k.$dropdown_content.scrollTop()||0,g=k.$activeOption.offset().top-k.$dropdown_content.offset().top+c,h=g,i=g-e+f,g+f>e+c?k.$dropdown_content.stop().animate({scrollTop:i},d?k.settings.scrollDuration:0):g<c&&k.$dropdown_content.stop().animate({scrollTop:h},d?k.settings.scrollDuration:0)))},selectAll:function(){var a=this;"single"!==a.settings.mode&&(a.$activeItems=Array.prototype.slice.apply(a.$control.children(":not(input)").addClass("active")),a.$activeItems.length&&(a.hideInput(),a.close()),a.focus())},hideInput:function(){var a=this;a.setTextboxValue(""),a.$control_input.css({opacity:0,position:"absolute",left:a.rtl?1e4:-1e4}),a.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var a=this;a.isDisabled||(a.ignoreFocus=!0,a.$control_input[0].focus(),window.setTimeout(function(){a.ignoreFocus=!1,a.onFocus()},0))},blur:function(a){this.$control_input[0].blur(),this.onBlur(null,a)},getScoreFunction:function(a){return this.sifter.getScoreFunction(a,this.getSearchOptions())},getSearchOptions:function(){var a=this.settings,b=a.sortField;return"string"==typeof b&&(b=[{field:b}]),{fields:a.searchField,conjunction:a.searchConjunction,sort:b}},search:function(b){var c,d,e,f=this,g=f.settings,h=this.getSearchOptions();if(g.score&&"function"!=typeof(e=f.settings.score.apply(this,[b])))throw new Error('Selectize "score" setting must be a function that returns a function');if(b!==f.lastQuery?(f.lastQuery=b,d=f.sifter.search(b,a.extend(h,{score:e})),f.currentResults=d):d=a.extend(!0,{},f.currentResults),g.hideSelected)for(c=d.items.length-1;c>=0;c--)-1!==f.items.indexOf(k(d.items[c].id))&&d.items.splice(c,1);return d},refreshOptions:function(b){var c,e,f,g,h,i,j,l,m,n,o,p,q,r,s,t;void 0===b&&(b=!0);var u=this,v=a.trim(u.$control_input.val()),w=u.search(v),x=u.$dropdown_content,y=u.$activeOption&&k(u.$activeOption.attr("data-value"));for(g=w.items.length,"number"==typeof u.settings.maxOptions&&(g=Math.min(g,u.settings.maxOptions)),h={},i=[],c=0;c<g;c++)for(j=u.options[w.items[c].id],l=u.render("option",j),m=j[u.settings.optgroupField]||"",n=a.isArray(m)?m:[m],e=0,f=n&&n.length;e<f;e++)m=n[e],u.optgroups.hasOwnProperty(m)||(m=""),h.hasOwnProperty(m)||(h[m]=[],i.push(m)),h[m].push(l);for(this.settings.lockOptgroupOrder&&i.sort(function(a,b){return(u.optgroups[a].$order||0)-(u.optgroups[b].$order||0)}),o=[],c=0,g=i.length;c<g;c++)m=i[c],u.optgroups.hasOwnProperty(m)&&h[m].length?(p=u.render("optgroup_header",u.optgroups[m])||"",p+=h[m].join(""),o.push(u.render("optgroup",a.extend({},u.optgroups[m],{html:p})))):o.push(h[m].join(""));if(x.html(o.join("")),u.settings.highlight&&w.query.length&&w.tokens.length)for(c=0,g=w.tokens.length;c<g;c++)d(x,w.tokens[c].regex);if(!u.settings.hideSelected)for(c=0,g=u.items.length;c<g;c++)u.getOption(u.items[c]).addClass("selected");q=u.canCreate(v),q&&(x.prepend(u.render("option_create",{input:v})),t=a(x[0].childNodes[0])),u.hasOptions=w.items.length>0||q,u.hasOptions?(w.items.length>0?(s=y&&u.getOption(y),s&&s.length?r=s:"single"===u.settings.mode&&u.items.length&&(r=u.getOption(u.items[0])),r&&r.length||(r=t&&!u.settings.addPrecedence?u.getAdjacentOption(t,1):x.find("[data-selectable]:first"))):r=t,u.setActiveOption(r),b&&!u.isOpen&&u.open()):(u.setActiveOption(null),b&&u.isOpen&&u.close())},addOption:function(b){var c,d,e,f=this;if(a.isArray(b))for(c=0,d=b.length;c<d;c++)f.addOption(b[c]);else(e=f.registerOption(b))&&(f.userOptions[e]=!0,f.lastQuery=null,f.trigger("option_add",e,b))},registerOption:function(a){var b=k(a[this.settings.valueField]);return!(!b||this.options.hasOwnProperty(b))&&(a.$order=a.$order||++this.order,this.options[b]=a,b)},registerOptionGroup:function(a){var b=k(a[this.settings.optgroupValueField]);return!!b&&(a.$order=a.$order||++this.order,this.optgroups[b]=a,b)},addOptionGroup:function(a,b){b[this.settings.optgroupValueField]=a,(a=this.registerOptionGroup(b))&&this.trigger("optgroup_add",a,b)},removeOptionGroup:function(a){this.optgroups.hasOwnProperty(a)&&(delete this.optgroups[a],this.renderCache={},this.trigger("optgroup_remove",a))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(b,c){var d,e,f,g,h,i,j,l=this;if(b=k(b),f=k(c[l.settings.valueField]),null!==b&&l.options.hasOwnProperty(b)){if("string"!=typeof f)throw new Error("Value must be set in option data");j=l.options[b].$order,f!==b&&(delete l.options[b],-1!==(g=l.items.indexOf(b))&&l.items.splice(g,1,f)),c.$order=c.$order||j,l.options[f]=c,h=l.renderCache.item,i=l.renderCache.option,h&&(delete h[b],delete h[f]),i&&(delete i[b],delete i[f]),-1!==l.items.indexOf(f)&&(d=l.getItem(b),e=a(l.render("item",c)),d.hasClass("active")&&e.addClass("active"),d.replaceWith(e)),l.lastQuery=null,l.isOpen&&l.refreshOptions(!1)}},removeOption:function(a,b){var c=this;a=k(a);var d=c.renderCache.item,e=c.renderCache.option;d&&delete d[a],e&&delete e[a],delete c.userOptions[a],delete c.options[a],c.lastQuery=null,c.trigger("option_remove",a),c.removeItem(a,b)},clearOptions:function(){var a=this;a.loadedSearches={},a.userOptions={},a.renderCache={},a.options=a.sifter.items={},a.lastQuery=null,a.trigger("option_clear"),a.clear()},getOption:function(a){return this.getElementWithValue(a,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(b,c){var d=this.$dropdown.find("[data-selectable]"),e=d.index(b)+c;return e>=0&&e<d.length?d.eq(e):a()},getElementWithValue:function(b,c){if(void 0!==(b=k(b))&&null!==b)for(var d=0,e=c.length;d<e;d++)if(c[d].getAttribute("data-value")===b)return a(c[d]);return a()},getItem:function(a){return this.getElementWithValue(a,this.$control.children())},addItems:function(b,c){for(var d=a.isArray(b)?b:[b],e=0,f=d.length;e<f;e++)this.isPending=e<f-1,this.addItem(d[e],c)},addItem:function(b,c){q(this,c?[]:["change"],function(){var d,e,f,g,h,i=this,j=i.settings.mode;if(b=k(b),-1!==i.items.indexOf(b))return void("single"===j&&i.close());i.options.hasOwnProperty(b)&&("single"===j&&i.clear(),"multi"===j&&i.isFull()||(d=a(i.render("item",i.options[b])),h=i.isFull(),i.items.splice(i.caretPos,0,b),i.insertAtCaret(d),(!i.isPending||!h&&i.isFull())&&i.refreshState(),
i.isSetup&&(f=i.$dropdown_content.find("[data-selectable]"),i.isPending||(e=i.getOption(b),g=i.getAdjacentOption(e,1).attr("data-value"),i.refreshOptions(i.isFocused&&"single"!==j),g&&i.setActiveOption(i.getOption(g))),!f.length||i.isFull()?i.close():i.positionDropdown(),i.updatePlaceholder(),i.trigger("item_add",b,d),i.updateOriginalInput({silent:c}))))})},removeItem:function(a,b){var c,d,e,f=this;c="object"==typeof a?a:f.getItem(a),a=k(c.attr("data-value")),-1!==(d=f.items.indexOf(a))&&(c.remove(),c.hasClass("active")&&(e=f.$activeItems.indexOf(c[0]),f.$activeItems.splice(e,1)),f.items.splice(d,1),f.lastQuery=null,!f.settings.persist&&f.userOptions.hasOwnProperty(a)&&f.removeOption(a,b),d<f.caretPos&&f.setCaret(f.caretPos-1),f.refreshState(),f.updatePlaceholder(),f.updateOriginalInput({silent:b}),f.positionDropdown(),f.trigger("item_remove",a,c))},createItem:function(b,c){var d=this,e=d.caretPos;b=b||a.trim(d.$control_input.val()||"");var f=arguments[arguments.length-1];if("function"!=typeof f&&(f=function(){}),"boolean"!=typeof c&&(c=!0),!d.canCreate(b))return f(),!1;d.lock();var g="function"==typeof d.settings.create?this.settings.create:function(a){var b={};return b[d.settings.labelField]=a,b[d.settings.valueField]=a,b},h=o(function(a){if(d.unlock(),!a||"object"!=typeof a)return f();var b=k(a[d.settings.valueField]);if("string"!=typeof b)return f();d.setTextboxValue(""),d.addOption(a),d.setCaret(e),d.addItem(b),d.refreshOptions(c&&"single"!==d.settings.mode),f(a)}),i=g.apply(this,[b,h]);return void 0!==i&&h(i),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){var a=this;a.isRequired&&(a.items.length&&(a.isInvalid=!1),a.$control_input.prop("required",void 0)),a.refreshClasses()},refreshClasses:function(){var b=this,c=b.isFull(),d=b.isLocked;b.$wrapper.toggleClass("rtl",b.rtl),b.$control.toggleClass("focus",b.isFocused).toggleClass("disabled",b.isDisabled).toggleClass("required",b.isRequired).toggleClass("invalid",b.isInvalid).toggleClass("locked",d).toggleClass("full",c).toggleClass("not-full",!c).toggleClass("input-active",b.isFocused&&!b.isInputHidden).toggleClass("dropdown-active",b.isOpen).toggleClass("has-options",!a.isEmptyObject(b.options)).toggleClass("has-items",b.items.length>0),b.$control_input.data("grow",!c&&!d)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(a){var b,c,d,e,f=this;if(a=a||{},1===f.tagType){for(d=[],b=0,c=f.items.length;b<c;b++)e=f.options[f.items[b]][f.settings.labelField]||"",d.push('<option value="'+l(f.items[b])+'" selected="selected">'+l(e)+"</option>");d.length||this.$input.attr("multiple")||d.push('<option value="" selected="selected"></option>'),f.$input.html(d.join(""))}else f.$input.val(f.getValue()),f.$input.attr("value",f.$input.val());f.isSetup&&(a.silent||f.trigger("change",f.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var a=this.$control_input;this.items.length?a.removeAttr("placeholder"):a.attr("placeholder",this.settings.placeholder),a.triggerHandler("update",{force:!0})}},open:function(){var a=this;a.isLocked||a.isOpen||"multi"===a.settings.mode&&a.isFull()||(a.focus(),a.isOpen=!0,a.refreshState(),a.$dropdown.css({visibility:"hidden",display:"block"}),a.positionDropdown(),a.$dropdown.css({visibility:"visible"}),a.trigger("dropdown_open",a.$dropdown))},close:function(){var a=this,b=a.isOpen;"single"===a.settings.mode&&a.items.length&&a.hideInput(),a.isOpen=!1,a.$dropdown.hide(),a.setActiveOption(null),a.refreshState(),b&&a.trigger("dropdown_close",a.$dropdown)},positionDropdown:function(){var a=this.$control,b="body"===this.settings.dropdownParent?a.offset():a.position();b.top+=a.outerHeight(!0),this.$dropdown.css({width:a.outerWidth(),top:b.top,left:b.left})},clear:function(a){var b=this;b.items.length&&(b.$control.children(":not(input)").remove(),b.items=[],b.lastQuery=null,b.setCaret(0),b.setActiveItem(null),b.updatePlaceholder(),b.updateOriginalInput({silent:a}),b.refreshState(),b.showInput(),b.trigger("clear"))},insertAtCaret:function(b){var c=Math.min(this.caretPos,this.items.length);0===c?this.$control.prepend(b):a(this.$control[0].childNodes[c]).before(b),this.setCaret(c+1)},deleteSelection:function(b){var c,d,e,f,g,h,i,j,k,l=this;if(e=b&&8===b.keyCode?-1:1,f=s(l.$control_input[0]),l.$activeOption&&!l.settings.hideSelected&&(i=l.getAdjacentOption(l.$activeOption,-1).attr("data-value")),g=[],l.$activeItems.length){for(k=l.$control.children(".active:"+(e>0?"last":"first")),h=l.$control.children(":not(input)").index(k),e>0&&h++,c=0,d=l.$activeItems.length;c<d;c++)g.push(a(l.$activeItems[c]).attr("data-value"));b&&(b.preventDefault(),b.stopPropagation())}else(l.isFocused||"single"===l.settings.mode)&&l.items.length&&(e<0&&0===f.start&&0===f.length?g.push(l.items[l.caretPos-1]):e>0&&f.start===l.$control_input.val().length&&g.push(l.items[l.caretPos]));if(!g.length||"function"==typeof l.settings.onDelete&&!1===l.settings.onDelete.apply(l,[g]))return!1;for(void 0!==h&&l.setCaret(h);g.length;)l.removeItem(g.pop());return l.showInput(),l.positionDropdown(),l.refreshOptions(!0),i&&(j=l.getOption(i),j.length&&l.setActiveOption(j)),!0},advanceSelection:function(a,b){var c,d,e,f,g,h=this;0!==a&&(h.rtl&&(a*=-1),c=a>0?"last":"first",d=s(h.$control_input[0]),h.isFocused&&!h.isInputHidden?(f=h.$control_input.val().length,(a<0?0===d.start&&0===d.length:d.start===f)&&!f&&h.advanceCaret(a,b)):(g=h.$control.children(".active:"+c),g.length&&(e=h.$control.children(":not(input)").index(g),h.setActiveItem(null),h.setCaret(a>0?e+1:e))))},advanceCaret:function(a,b){var c,d,e=this;0!==a&&(c=a>0?"next":"prev",e.isShiftDown?(d=e.$control_input[c](),d.length&&(e.hideInput(),e.setActiveItem(d),b&&b.preventDefault())):e.setCaret(e.caretPos+a))},setCaret:function(b){var c=this;if(b="single"===c.settings.mode?c.items.length:Math.max(0,Math.min(c.items.length,b)),!c.isPending){var d,e,f,g;for(f=c.$control.children(":not(input)"),d=0,e=f.length;d<e;d++)g=a(f[d]).detach(),d<b?c.$control_input.before(g):c.$control.append(g)}c.caretPos=b},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var a=this;a.$input.prop("disabled",!0),a.$control_input.prop("disabled",!0).prop("tabindex",-1),a.isDisabled=!0,a.lock()},enable:function(){var a=this;a.$input.prop("disabled",!1),a.$control_input.prop("disabled",!1).prop("tabindex",a.tabIndex),a.isDisabled=!1,a.unlock()},destroy:function(){var b=this,c=b.eventNS,d=b.revertSettings;b.trigger("destroy"),b.off(),b.$wrapper.remove(),b.$dropdown.remove(),b.$input.html("").append(d.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:d.tabindex}).show(),b.$control_input.removeData("grow"),b.$input.removeData("selectize"),a(window).off(c),a(document).off(c),a(document.body).off(c),delete b.$input[0].selectize},render:function(a,b){var c,d,e="",f=!1,g=this,h=/^[\t \r\n]*<([a-z][a-z0-9\-_]*(?:\:[a-z][a-z0-9\-_]*)?)/i;return"option"!==a&&"item"!==a||(c=k(b[g.settings.valueField]),f=!!c),f&&(j(g.renderCache[a])||(g.renderCache[a]={}),g.renderCache[a].hasOwnProperty(c))?g.renderCache[a][c]:(e=g.settings.render[a].apply(this,[b,l]),"option"!==a&&"option_create"!==a||(e=e.replace(h,"<$1 data-selectable")),"optgroup"===a&&(d=b[g.settings.optgroupValueField]||"",e=e.replace(h,'<$1 data-group="'+m(l(d))+'"')),"option"!==a&&"item"!==a||(e=e.replace(h,'<$1 data-value="'+m(l(c||""))+'"')),f&&(g.renderCache[a][c]=e),e)},clearCache:function(a){var b=this;void 0===a?b.renderCache={}:delete b.renderCache[a]},canCreate:function(a){var b=this;if(!b.settings.create)return!1;var c=b.settings.createFilter;return a.length&&("function"!=typeof c||c.apply(b,[a]))&&("string"!=typeof c||new RegExp(c).test(a))&&(!(c instanceof RegExp)||c.test(a))}}),w.count=0,w.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},a.fn.selectize=function(b){var c=a.fn.selectize.defaults,d=a.extend({},c,b),e=d.dataAttr,f=d.labelField,g=d.valueField,h=d.optgroupField,i=d.optgroupLabelField,j=d.optgroupValueField,l={},m=function(b,c){var h,i,j,k,l=b.attr(e);if(l)for(c.options=JSON.parse(l),h=0,i=c.options.length;h<i;h++)c.items.push(c.options[h][g]);else{var m=a.trim(b.val()||"");if(!d.allowEmptyOption&&!m.length)return;for(j=m.split(d.delimiter),h=0,i=j.length;h<i;h++)k={},k[f]=j[h],k[g]=j[h],c.options.push(k);c.items=j}},n=function(b,c){var m,n,o,p,q=c.options,r=function(a){var b=e&&a.attr(e);return"string"==typeof b&&b.length?JSON.parse(b):null},s=function(b,e){b=a(b);var i=k(b.attr("value"));if(i||d.allowEmptyOption)if(l.hasOwnProperty(i)){if(e){var j=l[i][h];j?a.isArray(j)?j.push(e):l[i][h]=[j,e]:l[i][h]=e}}else{var m=r(b)||{};m[f]=m[f]||b.text(),m[g]=m[g]||i,m[h]=m[h]||e,l[i]=m,q.push(m),b.is(":selected")&&c.items.push(i)}};for(c.maxItems=b.attr("multiple")?null:1,p=b.children(),m=0,n=p.length;m<n;m++)o=p[m].tagName.toLowerCase(),"optgroup"===o?function(b){var d,e,f,g,h;for(b=a(b),f=b.attr("label"),f&&(g=r(b)||{},g[i]=f,g[j]=f,c.optgroups.push(g)),h=a("option",b),d=0,e=h.length;d<e;d++)s(h[d],f)}(p[m]):"option"===o&&s(p[m])};return this.each(function(){if(!this.selectize){var e=a(this),f=this.tagName.toLowerCase(),g=e.attr("placeholder")||e.attr("data-placeholder");g||d.allowEmptyOption||(g=e.children('option[value=""]').text());var h={placeholder:g,options:[],optgroups:[],items:[]};"select"===f?n(e,h):m(e,h),new w(e,a.extend(!0,{},c,h,b))}})},a.fn.selectize.defaults=w.defaults,a.fn.selectize.support={validity:i},w.define("drag_drop",function(b){if(!a.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var c=this;c.lock=function(){var a=c.lock;return function(){var b=c.$control.data("sortable");return b&&b.disable(),a.apply(c,arguments)}}(),c.unlock=function(){var a=c.unlock;return function(){var b=c.$control.data("sortable");return b&&b.enable(),a.apply(c,arguments)}}(),c.setup=function(){var b=c.setup;return function(){b.apply(this,arguments);var d=c.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:c.isLocked,start:function(a,b){b.placeholder.css("width",b.helper.css("width")),d.css({overflow:"visible"})},stop:function(){d.css({overflow:"hidden"});var b=c.$activeItems?c.$activeItems.slice():null,e=[];d.children("[data-value]").each(function(){e.push(a(this).attr("data-value"))}),c.setValue(e),c.setActiveItem(b)}})}}()}}),w.define("dropdown_header",function(b){var c=this;b=a.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(a){return'<div class="'+a.headerClass+'"><div class="'+a.titleRowClass+'"><span class="'+a.labelClass+'">'+a.title+'</span><a href="javascript:void(0)" class="'+a.closeClass+'">&times;</a></div></div>'}},b),c.setup=function(){var d=c.setup;return function(){d.apply(c,arguments),c.$dropdown_header=a(b.html(b)),c.$dropdown.prepend(c.$dropdown_header)}}()}),w.define("optgroup_columns",function(b){var c=this;b=a.extend({equalizeWidth:!0,equalizeHeight:!0},b),this.getAdjacentOption=function(b,c){var d=b.closest("[data-group]").find("[data-selectable]"),e=d.index(b)+c;return e>=0&&e<d.length?d.eq(e):a()},this.onKeyDown=function(){var a=c.onKeyDown;return function(b){var d,e,f,g;return!this.isOpen||37!==b.keyCode&&39!==b.keyCode?a.apply(this,arguments):(c.ignoreHover=!0,g=this.$activeOption.closest("[data-group]"),d=g.find("[data-selectable]").index(this.$activeOption),g=37===b.keyCode?g.prev("[data-group]"):g.next("[data-group]"),f=g.find("[data-selectable]"),e=f.eq(Math.min(f.length-1,d)),void(e.length&&this.setActiveOption(e)))}}();var d=function(){var a,b=d.width,c=document;return void 0===b&&(a=c.createElement("div"),a.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',a=a.firstChild,c.body.appendChild(a),b=d.width=a.offsetWidth-a.clientWidth,c.body.removeChild(a)),b},e=function(){var e,f,g,h,i,j,k;if(k=a("[data-group]",c.$dropdown_content),(f=k.length)&&c.$dropdown_content.width()){if(b.equalizeHeight){for(g=0,e=0;e<f;e++)g=Math.max(g,k.eq(e).height());k.css({height:g})}b.equalizeWidth&&(j=c.$dropdown_content.innerWidth()-d(),h=Math.round(j/f),k.css({width:h}),f>1&&(i=j-h*(f-1),k.eq(f-1).css({width:i})))}};(b.equalizeHeight||b.equalizeWidth)&&(n.after(this,"positionDropdown",e),n.after(this,"refreshOptions",e))}),w.define("remove_button",function(b){if("single"!==this.settings.mode){b=a.extend({label:"&times;",title:"Remove",className:"remove",append:!0},b);var c=this,d='<a href="javascript:void(0)" class="'+b.className+'" tabindex="-1" title="'+l(b.title)+'">'+b.label+"</a>",e=function(a,b){var c=a.search(/(<\/[^>]+>\s*)$/);return a.substring(0,c)+b+a.substring(c)};this.setup=function(){var f=c.setup;return function(){if(b.append){var g=c.settings.render.item;c.settings.render.item=function(a){return e(g.apply(this,arguments),d)}}f.apply(this,arguments),this.$control.on("click","."+b.className,function(b){if(b.preventDefault(),!c.isLocked){var d=a(b.currentTarget).parent();c.setActiveItem(d),c.deleteSelection()&&c.setCaret(c.items.length)}})}}()}}),w.define("restore_on_backspace",function(a){var b=this;a.text=a.text||function(a){return a[this.settings.labelField]},this.onKeyDown=function(){var c=b.onKeyDown;return function(b){var d,e;return 8===b.keyCode&&""===this.$control_input.val()&&!this.$activeItems.length&&(d=this.caretPos-1)>=0&&d<this.items.length?(e=this.options[this.items[d]],this.deleteSelection(b)&&(this.setTextboxValue(a.text.apply(this,[e])),this.refreshOptions(!0)),void b.preventDefault()):c.apply(this,arguments)}}()}),w}),jQuery&&function(a){function b(b,c){var d=a('<div class="minicolors" />'),e=a.minicolors.defaults;b.data("minicolors-initialized")||(c=a.extend(!0,{},e,c),d.addClass("minicolors-theme-"+c.theme).toggleClass("minicolors-with-opacity",c.opacity).toggleClass("minicolors-no-data-uris",!0!==c.dataUris),void 0!==c.position&&a.each(c.position.split(" "),function(){d.addClass("minicolors-position-"+this)}),b.addClass("minicolors-input").data("minicolors-initialized",!1).data("minicolors-settings",c).prop("size",7).wrap(d).after('<div class="minicolors-panel minicolors-slider-'+c.control+'"><div class="minicolors-slider minicolors-sprite"><div class="minicolors-picker"></div></div><div class="minicolors-opacity-slider minicolors-sprite"><div class="minicolors-picker"></div></div><div class="minicolors-grid minicolors-sprite"><div class="minicolors-grid-inner"></div><div class="minicolors-picker"><div></div></div></div></div>'),c.inline||(b.after('<span class="minicolors-swatch minicolors-sprite"><span class="minicolors-swatch-color"></span></span>'),b.next(".minicolors-swatch").on("click",function(a){a.preventDefault(),b.focus()})),b.parent().find(".minicolors-panel").on("selectstart",function(){return!1}).end(),c.inline&&b.parent().addClass("minicolors-inline"),h(b,!1),b.data("minicolors-initialized",!0))}function c(a){var b=a.parent();a.removeData("minicolors-initialized").removeData("minicolors-settings").removeProp("size").removeClass("minicolors-input"),b.before(a).remove()}function d(a){var b=a.parent(),c=b.find(".minicolors-panel"),d=a.data("minicolors-settings");!a.data("minicolors-initialized")||a.prop("disabled")||b.hasClass("minicolors-inline")||b.hasClass("minicolors-focus")||(e(),b.addClass("minicolors-focus"),c.stop(!0,!0).fadeIn(d.showSpeed,function(){d.show&&d.show.call(a.get(0))}))}function e(){a(".minicolors-focus").each(function(){var b=a(this),c=b.find(".minicolors-input"),d=b.find(".minicolors-panel"),e=c.data("minicolors-settings");d.fadeOut(e.hideSpeed,function(){e.hide&&e.hide.call(c.get(0)),b.removeClass("minicolors-focus")})})}function f(a,b,c){var d,e,f,h,i=a.parents(".minicolors").find(".minicolors-input"),j=i.data("minicolors-settings"),k=a.find("[class$=-picker]"),l=a.offset().left,m=a.offset().top,n=Math.round(b.pageX-l),o=Math.round(b.pageY-m),p=c?j.animationSpeed:0;b.originalEvent.changedTouches&&(n=b.originalEvent.changedTouches[0].pageX-l,o=b.originalEvent.changedTouches[0].pageY-m),n<0&&(n=0),o<0&&(o=0),n>a.width()&&(n=a.width()),o>a.height()&&(o=a.height()),a.parent().is(".minicolors-slider-wheel")&&k.parent().is(".minicolors-grid")&&(d=75-n,e=75-o,f=Math.sqrt(d*d+e*e),h=Math.atan2(e,d),h<0&&(h+=2*Math.PI),f>75&&(f=75,n=75-75*Math.cos(h),o=75-75*Math.sin(h)),n=Math.round(n),o=Math.round(o)),a.is(".minicolors-grid")?k.stop(!0).animate({top:o+"px",left:n+"px"},p,j.animationEasing,function(){g(i,a)}):k.stop(!0).animate({top:o+"px"},p,j.animationEasing,function(){g(i,a)})}function g(a,b){function c(a,b){var c,d;return a.length&&b?(c=a.offset().left,d=a.offset().top,{x:c-b.offset().left+a.outerWidth()/2,y:d-b.offset().top+a.outerHeight()/2}):null}var d,e,f,g,h,j,k,m=a.val(),o=a.attr("data-opacity"),p=a.parent(),r=a.data("minicolors-settings"),s=p.find(".minicolors-swatch"),t=p.find(".minicolors-grid"),u=p.find(".minicolors-slider"),v=p.find(".minicolors-opacity-slider"),w=t.find("[class$=-picker]"),x=u.find("[class$=-picker]"),y=v.find("[class$=-picker]"),z=c(w,t),A=c(x,u),B=c(y,v);if(b.is(".minicolors-grid, .minicolors-slider")){switch(r.control){case"wheel":g=t.width()/2-z.x,h=t.height()/2-z.y,j=Math.sqrt(g*g+h*h),k=Math.atan2(h,g),k<0&&(k+=2*Math.PI),j>75&&(j=75,z.x=69-75*Math.cos(k),z.y=69-75*Math.sin(k)),e=n(j/.75,0,100),d=n(180*k/Math.PI,0,360),f=n(100-Math.floor(A.y*(100/u.height())),0,100),m=q({h:d,s:e,b:f}),u.css("backgroundColor",q({h:d,s:e,b:100}));break;case"saturation":d=n(parseInt(z.x*(360/t.width()),10),0,360),e=n(100-Math.floor(A.y*(100/u.height())),0,100),f=n(100-Math.floor(z.y*(100/t.height())),0,100),m=q({h:d,s:e,b:f}),u.css("backgroundColor",q({h:d,s:100,b:f})),p.find(".minicolors-grid-inner").css("opacity",e/100);break;case"brightness":d=n(parseInt(z.x*(360/t.width()),10),0,360),e=n(100-Math.floor(z.y*(100/t.height())),0,100),f=n(100-Math.floor(A.y*(100/u.height())),0,100),m=q({h:d,s:e,b:f}),u.css("backgroundColor",q({h:d,s:e,b:100})),p.find(".minicolors-grid-inner").css("opacity",1-f/100);break;default:d=n(360-parseInt(A.y*(360/u.height()),10),0,360),e=n(Math.floor(z.x*(100/t.width())),0,100),f=n(100-Math.floor(z.y*(100/t.height())),0,100),m=q({h:d,s:e,b:f}),t.css("backgroundColor",q({h:d,s:100,b:100}))}a.val(l(m,r.letterCase))}b.is(".minicolors-opacity-slider")&&(o=r.opacity?parseFloat(1-B.y/v.height()).toFixed(2):1,r.opacity&&a.attr("data-opacity",o)),s.find("SPAN").css({backgroundColor:m,opacity:o}),i(a,m,o)}function h(a,b){var c,d,e,f,g,h,j,k=a.parent(),o=a.data("minicolors-settings"),p=k.find(".minicolors-swatch"),s=k.find(".minicolors-grid"),t=k.find(".minicolors-slider"),u=k.find(".minicolors-opacity-slider"),v=s.find("[class$=-picker]"),w=t.find("[class$=-picker]"),x=u.find("[class$=-picker]");switch(c=l(m(a.val(),!0),o.letterCase),c||(c=l(m(o.defaultValue,!0),o.letterCase)),d=r(c),b||a.val(c),o.opacity&&(e=""===a.attr("data-opacity")?1:n(parseFloat(a.attr("data-opacity")).toFixed(2),0,1),isNaN(e)&&(e=1),a.attr("data-opacity",e),p.find("SPAN").css("opacity",e),g=n(u.height()-u.height()*e,0,u.height()),x.css("top",g+"px")),p.find("SPAN").css("backgroundColor",c),o.control){case"wheel":h=n(Math.ceil(.75*d.s),0,s.height()/2),j=d.h*Math.PI/180,f=n(75-Math.cos(j)*h,0,s.width()),g=n(75-Math.sin(j)*h,0,s.height()),v.css({top:g+"px",left:f+"px"}),g=150-d.b/(100/s.height()),""===c&&(g=0),w.css("top",g+"px"),t.css("backgroundColor",q({h:d.h,s:d.s,b:100}));break;case"saturation":f=n(5*d.h/12,0,150),g=n(s.height()-Math.ceil(d.b/(100/s.height())),0,s.height()),v.css({top:g+"px",left:f+"px"}),g=n(t.height()-d.s*(t.height()/100),0,t.height()),w.css("top",g+"px"),t.css("backgroundColor",q({h:d.h,s:100,b:d.b})),k.find(".minicolors-grid-inner").css("opacity",d.s/100);break;case"brightness":f=n(5*d.h/12,0,150),g=n(s.height()-Math.ceil(d.s/(100/s.height())),0,s.height()),v.css({top:g+"px",left:f+"px"}),g=n(t.height()-d.b*(t.height()/100),0,t.height()),w.css("top",g+"px"),t.css("backgroundColor",q({h:d.h,s:d.s,b:100})),k.find(".minicolors-grid-inner").css("opacity",1-d.b/100);break;default:f=n(Math.ceil(d.s/(100/s.width())),0,s.width()),g=n(s.height()-Math.ceil(d.b/(100/s.height())),0,s.height()),v.css({top:g+"px",left:f+"px"}),g=n(t.height()-d.h/(360/t.height()),0,t.height()),w.css("top",g+"px"),s.css("backgroundColor",q({h:d.h,s:100,b:100}))}a.data("minicolors-initialized")&&i(a,c,e)}function i(a,b,c){var d=a.data("minicolors-settings"),e=a.data("minicolors-lastChange");e&&e.hex===b&&e.opacity===c||(a.data("minicolors-lastChange",{hex:b,opacity:c}),d.change&&(d.changeDelay?(clearTimeout(a.data("minicolors-changeTimeout")),a.data("minicolors-changeTimeout",setTimeout(function(){d.change.call(a.get(0),b,c)},d.changeDelay))):d.change.call(a.get(0),b,c)),a.trigger("change").trigger("input"))}function j(b){var c=m(a(b).val(),!0),d=t(c),e=a(b).attr("data-opacity");return d?(void 0!==e&&a.extend(d,{a:parseFloat(e)}),d):null}function k(b,c){var d=m(a(b).val(),!0),e=t(d),f=a(b).attr("data-opacity");return e?(void 0===f&&(f=1),c?"rgba("+e.r+", "+e.g+", "+e.b+", "+parseFloat(f)+")":"rgb("+e.r+", "+e.g+", "+e.b+")"):null}function l(a,b){return"uppercase"===b?a.toUpperCase():a.toLowerCase()}function m(a,b){return a=a.replace(/[^A-F0-9]/gi,""),3!==a.length&&6!==a.length?"":(3===a.length&&b&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),"#"+a)}function n(a,b,c){return a<b&&(a=b),a>c&&(a=c),a}function o(a){var b={},c=Math.round(a.h),d=Math.round(255*a.s/100),e=Math.round(255*a.b/100);if(0===d)b.r=b.g=b.b=e;else{var f=e,g=(255-d)*e/255,h=c%60*(f-g)/60;360===c&&(c=0),c<60?(b.r=f,b.b=g,b.g=g+h):c<120?(b.g=f,b.b=g,b.r=f-h):c<180?(b.g=f,b.r=g,b.b=g+h):c<240?(b.b=f,b.r=g,b.g=f-h):c<300?(b.b=f,b.g=g,b.r=g+h):c<360?(b.r=f,b.g=g,b.b=f-h):(b.r=0,b.g=0,b.b=0)}return{r:Math.round(b.r),g:Math.round(b.g),b:Math.round(b.b)}}function p(b){var c=[b.r.toString(16),b.g.toString(16),b.b.toString(16)];return a.each(c,function(a,b){1===b.length&&(c[a]="0"+b)}),"#"+c.join("")}function q(a){return p(o(a))}function r(a){var b=s(t(a));return 0===b.s&&(b.h=360),b}function s(a){var b={h:0,s:0,b:0},c=Math.min(a.r,a.g,a.b),d=Math.max(a.r,a.g,a.b),e=d-c;return b.b=d,b.s=0!==d?255*e/d:0,0!==b.s?a.r===d?b.h=(a.g-a.b)/e:a.g===d?b.h=2+(a.b-a.r)/e:b.h=4+(a.r-a.g)/e:b.h=-1,b.h*=60,b.h<0&&(b.h+=360),b.s*=100/255,b.b*=100/255,b}function t(a){return a=parseInt(a.indexOf("#")>-1?a.substring(1):a,16),{r:a>>16,g:(65280&a)>>8,b:255&a}}a.minicolors={defaults:{animationSpeed:50,animationEasing:"swing",change:null,changeDelay:0,control:"hue",dataUris:!0,defaultValue:"",hide:null,hideSpeed:100,inline:!1,letterCase:"lowercase",opacity:!1,position:"bottom left",show:null,showSpeed:100,theme:"default"}},a.extend(a.fn,{minicolors:function(f,g){switch(f){case"destroy":return a(this).each(function(){c(a(this))}),a(this);case"hide":return e(),a(this);case"opacity":return void 0===g?a(this).attr("data-opacity"):(a(this).each(function(){h(a(this).attr("data-opacity",g))}),a(this));case"rgbObject":return j(a(this));case"rgbString":case"rgbaString":return k(a(this),"rgbaString"===f);case"settings":return void 0===g?a(this).data("minicolors-settings"):(a(this).each(function(){var b=a(this).data("minicolors-settings")||{};c(a(this)),a(this).minicolors(a.extend(!0,b,g))}),a(this));case"show":return d(a(this).eq(0)),a(this);case"value":return void 0===g?a(this).val():(a(this).each(function(){h(a(this).val(g))}),a(this));default:return"create"!==f&&(g=f),a(this).each(function(){b(a(this),g)}),a(this)}}}),a(document).on("mousedown.minicolors touchstart.minicolors",function(b){a(b.target).parents().add(b.target).hasClass("minicolors")||e()}).on("mousedown.minicolors touchstart.minicolors",".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider",function(b){var c=a(this);b.preventDefault(),a(document).data("minicolors-target",c),f(c,b,!0)}).on("mousemove.minicolors touchmove.minicolors",function(b){var c=a(document).data("minicolors-target");c&&f(c,b)}).on("mouseup.minicolors touchend.minicolors",function(){a(this).removeData("minicolors-target")}).on("mousedown.minicolors touchstart.minicolors",".minicolors-swatch",function(b){var c=a(this).parent().find(".minicolors-input");b.preventDefault(),d(c)}).on("focus.minicolors",".minicolors-input",function(){var b=a(this);b.data("minicolors-initialized")&&d(b)}).on("blur.minicolors",".minicolors-input",function(){var b=a(this),c=b.data("minicolors-settings");b.data("minicolors-initialized")&&(b.val(m(b.val(),!0)),""===b.val()&&b.val(m(c.defaultValue,!0)),b.val(l(b.val(),c.letterCase)))}).on("keydown.minicolors",".minicolors-input",function(b){var c=a(this);if(c.data("minicolors-initialized"))switch(b.keyCode){case 9:e();break;case 13:case 27:e(),c.blur()}}).on("keyup.minicolors",".minicolors-input",function(){var b=a(this);b.data("minicolors-initialized")&&h(b,!0)}).on("paste.minicolors",".minicolors-input",function(){var b=a(this);b.data("minicolors-initialized")&&setTimeout(function(){h(b,!0)},1)})}(jQuery),function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Clipboard=a()}}(function(){var a;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a,b){for(;a&&a.nodeType!==e;){if(a.matches(b))return a;a=a.parentNode}}var e=9;if(Element&&!Element.prototype.matches){var f=Element.prototype;f.matches=f.matchesSelector||f.mozMatchesSelector||f.msMatchesSelector||f.oMatchesSelector||f.webkitMatchesSelector}b.exports=d},{}],2:[function(a,b,c){function d(a,b,c,d,f){var g=e.apply(this,arguments);return a.addEventListener(c,g,f),{destroy:function(){a.removeEventListener(c,g,f)}}}function e(a,b,c,d){return function(c){c.delegateTarget=f(c.target,b),c.delegateTarget&&d.call(a,c)}}var f=a("./closest");b.exports=d},{"./closest":1}],3:[function(a,b,c){c.node=function(a){return void 0!==a&&a instanceof HTMLElement&&1===a.nodeType},c.nodeList=function(a){var b=Object.prototype.toString.call(a);return void 0!==a&&("[object NodeList]"===b||"[object HTMLCollection]"===b)&&"length"in a&&(0===a.length||c.node(a[0]))},c.string=function(a){return"string"==typeof a||a instanceof String},c.fn=function(a){return"[object Function]"===Object.prototype.toString.call(a)}},{}],4:[function(a,b,c){function d(a,b,c){if(!a&&!b&&!c)throw new Error("Missing required arguments");if(!h.string(b))throw new TypeError("Second argument must be a String");if(!h.fn(c))throw new TypeError("Third argument must be a Function");if(h.node(a))return e(a,b,c);if(h.nodeList(a))return f(a,b,c);if(h.string(a))return g(a,b,c);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function e(a,b,c){return a.addEventListener(b,c),{destroy:function(){a.removeEventListener(b,c)}}}function f(a,b,c){return Array.prototype.forEach.call(a,function(a){a.addEventListener(b,c)}),{destroy:function(){Array.prototype.forEach.call(a,function(a){a.removeEventListener(b,c)})}}}function g(a,b,c){return i(document.body,a,b,c)}var h=a("./is"),i=a("delegate");b.exports=d},{"./is":3,delegate:2}],5:[function(a,b,c){function d(a){var b;if("SELECT"===a.nodeName)a.focus(),b=a.value;else if("INPUT"===a.nodeName||"TEXTAREA"===a.nodeName)a.focus(),a.setSelectionRange(0,a.value.length),b=a.value;else{a.hasAttribute("contenteditable")&&a.focus();var c=window.getSelection(),d=document.createRange();d.selectNodeContents(a),c.removeAllRanges(),c.addRange(d),b=c.toString()}return b}b.exports=d},{}],6:[function(a,b,c){function d(){}d.prototype={on:function(a,b,c){var d=this.e||(this.e={});return(d[a]||(d[a]=[])).push({fn:b,ctx:c}),this},once:function(a,b,c){function d(){e.off(a,d),b.apply(c,arguments)}var e=this;return d._=b,this.on(a,d,c)},emit:function(a){var b=[].slice.call(arguments,1),c=((this.e||(this.e={}))[a]||[]).slice(),d=0,e=c.length;for(d;d<e;d++)c[d].fn.apply(c[d].ctx,b);return this},off:function(a,b){var c=this.e||(this.e={}),d=c[a],e=[];if(d&&b)for(var f=0,g=d.length;f<g;f++)d[f].fn!==b&&d[f].fn._!==b&&e.push(d[f]);return e.length?c[a]=e:delete c[a],this}},b.exports=d},{}],7:[function(b,c,d){!function(e,f){if("function"==typeof a&&a.amd)a(["module","select"],f);else if(void 0!==d)f(c,b("select"));else{var g={exports:{}};f(g,e.select),e.clipboardAction=g.exports}}(this,function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(a){return a&&a.__esModule?a:{default:a}}(b),e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=function(){function a(b){c(this,a),this.resolveOptions(b),this.initSelection()}return f(a,[{key:"resolveOptions",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=a.action,this.emitter=a.emitter,this.target=a.target,this.text=a.text,this.trigger=a.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var a=this,b="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return a.removeFake()},this.fakeHandler=document.body.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[b?"right":"left"]="-9999px";var c=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.addEventListener("focus",window.scrollTo(0,c)),this.fakeElem.style.top=c+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,document.body.appendChild(this.fakeElem),this.selectedText=(0,d.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(document.body.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(document.body.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){
this.selectedText=(0,d.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var a=void 0;try{a=document.execCommand(this.action)}catch(b){a=!1}this.handleResult(a)}},{key:"handleResult",value:function(a){this.emitter.emit(a?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.target&&this.target.blur(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=a,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(a){if(void 0!==a){if(!a||"object"!==(void 0===a?"undefined":e(a))||1!==a.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&a.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(a.hasAttribute("readonly")||a.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=a}},get:function(){return this._target}}]),a}();a.exports=g})},{select:5}],8:[function(b,c,d){!function(e,f){if("function"==typeof a&&a.amd)a(["module","./clipboard-action","tiny-emitter","good-listener"],f);else if(void 0!==d)f(c,b("./clipboard-action"),b("tiny-emitter"),b("good-listener"));else{var g={exports:{}};f(g,e.clipboardAction,e.tinyEmitter,e.goodListener),e.clipboard=g.exports}}(this,function(a,b,c,d){"use strict";function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function i(a,b){var c="data-clipboard-"+a;if(b.hasAttribute(c))return b.getAttribute(c)}var j=e(b),k=e(c),l=e(d),m=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),n=function(a){function b(a,c){f(this,b);var d=g(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return d.resolveOptions(c),d.listenClick(a),d}return h(b,a),m(b,[{key:"resolveOptions",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof a.action?a.action:this.defaultAction,this.target="function"==typeof a.target?a.target:this.defaultTarget,this.text="function"==typeof a.text?a.text:this.defaultText}},{key:"listenClick",value:function(a){var b=this;this.listener=(0,l.default)(a,"click",function(a){return b.onClick(a)})}},{key:"onClick",value:function(a){var b=a.delegateTarget||a.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new j.default({action:this.action(b),target:this.target(b),text:this.text(b),trigger:b,emitter:this})}},{key:"defaultAction",value:function(a){return i("action",a)}},{key:"defaultTarget",value:function(a){var b=i("target",a);if(b)return document.querySelector(b)}},{key:"defaultText",value:function(a){return i("text",a)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}]),b}(k.default);a.exports=n})},{"./clipboard-action":7,"good-listener":4,"tiny-emitter":6}]},{},[8])(8)}),function(a){"use strict";var b=function(c,d){if(this.log("Visual Editor Version: "+b.VERSION),void 0===c)throw new Error("no shortcodes given");this.log("Initializing Visual Editor"),this.log(d),this.shortcodes=c,this.options=a.extend({},b.DEFAULTS,"object"==typeof d&&d),this.$container="string"==typeof this.options.container?a(this.options.container):this.options.container,this.$grid=a(".grid",this.$container),this.$modal="string"==typeof this.options.modal?a(this.options.modal):this.options.modal,this.options.defaultWidgetSize>this.options.gridSize&&(this.options.defaultWidgetSize=this.options.gridSize),this.options.colSize=Math.floor(this.$container.width()/this.options.gridSize)-12,this.options.colWidth=this.options.colSize,this.options.colHeight=this.options.colSize,this.options.colSize<140?this.options.colHeight=140:this.options.colSize>220&&(this.options.colHeight=220),this.initializeGrid(),this.setWidgetSelector(),this.initializePlugins()};b.VERSION="2.0.0",b.DEFAULTS={gridSize:6,gridFrontendSize:12,defaultWidgetSize:1,container:".dd-veditor",modal:".dd-widget-modal",actionLink:null,resourceLink:null},b.WIDGET_DEFAULTS={col:null,row:null,size_x:1,size_y:1},b.DEBUG=!1,b.prototype.timestamp=function(){var a=new Date;return a.getFullYear()+"-"+(a.getMonth()+1<10?"0":"")+(a.getMonth()+1)+"-"+(a.getDate()<10?"0":"")+a.getDate()+" "+(a.getHours()<10?"0":"")+a.getHours()+":"+(a.getMinutes()<10?"0":"")+a.getMinutes()+":"+(a.getSeconds()<10?"0":"")+a.getSeconds()},b.prototype.log=function(a,c,d){b.DEBUG&&(void 0===c&&(c="log"),void 0===d&&(d=!1),"undefined"!=typeof console&&(void 0!==console[c]&&console[c]("[Visual Editor]["+this.timestamp()+"] ",a),d&&console.trace()))},b.prototype.isDebugMode=function(){return b.DEBUG},b.prototype.initializeGrid=function(){this.log("Initializing Grid"),this.log(this.options),this.$grid.css("min-height",this.options.colHeight),this.gridstack=GridStack.init({verticalMargin:10,cellHeight:this.options.colHeight,column:this.options.gridSize,acceptWidgets:!1,resizable:{autoHide:!0,handles:"s, e"}},this.$grid),this.log("Setting Widget events");var b=this;this.$grid.on("click",".dd-veditor-widget .dd-widget-action-delete",function(){var c=a(this).closest(".dd-veditor-widget"),d=c.closest(".nested-grid");d.length&&(b.nestedgridstack=d.get(0).gridstack),ddh.confirm(ddh.translate(c.hasClass("dd-veditor-column")?"DD_VISUAL_EDITOR_WIDGET_DELETE_NESTED_CONFIRM":"DD_VISUAL_EDITOR_WIDGET_DELETE_CONFIRM"),function(){b.remove(c,function(){b.nestedgridstack=null})})}).on("click",".dd-veditor-widget .dd-widget-action-edit",function(){var c=a(this).closest(".dd-veditor-widget"),d=c.closest(".nested-grid");d.length?b.nestedgridstack=d.get(0).gridstack:b.nestedgridstack=null;var e=a(".dd-widget-type-select",b.$modal);c.hasClass("dd-veditor-column")?(e[0].selectize.addOption({value:"column",label:"",area:"dd-type-column"}),e[0].selectize.refreshOptions(!1),e.parent().parent().hide()):(e[0].selectize.removeOption("column"),e.parent().parent().show()),b.editWidget(c,function(){b.nestedgridstack=null})}).on("click",".dd-veditor-widget .dd-widget-action-new-nested",function(){var c=a(this).closest(".dd-veditor-widget"),d=c.find(".nested-grid");b.nestedgridstack=d.get(0).gridstack,b.nestedgridstack.willItFit(1,1,1,1,!0)?b.newWidget(function(){b.nestedgridstack=null}):ddh.alert(ddh.translate("DD_VISUAL_EDITOR_NO_SPACE_WARNING"))}).on("click",".dd-veditor-widget .dd-widget-action-duplicate",function(){var c=a(this).closest(".dd-veditor-widget"),d=c.closest(".nested-grid");d.length?b.nestedgridstack=d.get(0).gridstack:b.nestedgridstack=null,b.duplicateWidget(c,function(){b.nestedgridstack=null})}).on("click",".dd-veditor-widget .dd-widget-action-move",function(){var c=a(this).closest(".dd-veditor-widget"),d=c.closest(".nested-grid");c.length&&(c.hasClass("move-source")?b.deactivateMoveMode():(a(".move-source").length&&b.deactivateMoveMode(),b.log("Moving mode on"),c.addClass("move-source"),b.widgetToMove=c,a(".dd-widget-action-movetarget").removeClass("in-source-grid"),a(".dd-veditor-grid").addClass("move-mode"),d.length&&(a(d).prev(".dd-widget-action-movetarget").addClass("in-source-grid"),b.addMoveTargetWidget())))}),this.gridstack.on("gsresizestop",function(c){var d=a(c.target);if(d.hasClass("dd-veditor-column")){var e=d.data("_gridstack_node"),f=d.find(".nested-grid"),g=Math.floor((b.options.colHeight*e.height-85)/e.height);f.get(0).gridstack.cellHeight(g)}}),a(".dd-veditor-widget-action",this.$container).on("click",function(){var c=a(".dd-widget-type-select",b.$modal);c[0].selectize.removeOption("column"),c.parent().parent().show(),a(this).hasClass("disabled")||b.newWidget()}),a(".dd-veditor-column-action",this.$container).on("click",function(){a(this).hasClass("disabled")||b.add("column")}),a(".dd-veditor-delete-all-action",this.$container).on("click",function(){a(this).hasClass("disabled")||ddh.confirm(ddh.translate("DD_VISUAL_EDITOR_WIDGET_DELETE_ALL_CONFIRM"),function(){b.clear()})}),a(document).on("click",".dd-widget-action-movetarget, .move-target-widget",function(){if(void 0!==b.widgetToMove&&null!=b.widgetToMove){a(this).hasClass("move-target-widget")?b.nestedgridstack=null:b.nestedgridstack=a(this).next(".nested-grid").get(0).gridstack;var c=b.widgetToMove.data("widget"),d=b.widgetToMove.data("widget-params");b.log('Moving Widget "'+c+'"');var e=b.widgetToMove.data("_gridstack_node"),f={size_x:e.width,size_y:e.height};a(".move-target-widget").length?b.removeMoveTargetWidget(function(){b.move(c,d,f)}):b.move(c,d,f)}}),"undefined"!=typeof MediaLibrary?a(".dd-veditor-media-action",this.$container).click(function(){a(this).hasClass("disabled")||MediaLibrary.open(/image\/.*/i,!0,function(c){c.length&&a.each(c,function(){b.add("image",{image:this.file,type:"lightbox",thumbnail:1,thumbnail_size:"medium"})})})}):(this.log("digidesk Media Library not found, hiding media action...","warn"),a(".dd-veditor-media-action",this.$container).hide())},b.prototype.initializeNestedGrid=function(a,b){this.log("Initializing Nested Grid"),this.log(a),this.log(this.options);var c=b.data("_gridstack_node"),d=Math.floor((this.options.colHeight*c.height-85)/c.height);GridStack.init({verticalMargin:10,cellHeight:d,column:this.options.gridSize,acceptWidgets:!1,resizable:{autoHide:!0,handles:"e"},minRow:1},a),this.nestedgridstack=null},b.prototype.initializePlugins=function(){this.log("Initialize 3rd Party plugins");var b=this;if("undefined"!=typeof MediaLibrary?(a(".dd-media-action",this.$modal).on("click",function(){var b=a(a(this).data("target"));MediaLibrary.open(function(a,c){b.val(c).trigger("change")})}),a(".dd-widget-image-add-item",this.$modal).on("click",function(){var c=a(a(this).data("target"));MediaLibrary.open(/image\/.*/i,1==c.data("multi"),function(d){1!=c.data("multi")&&(d=[{file:arguments[1]}]),d.length&&a.each(d,function(a,d){if(!b.addInputImage(d.file,c))return!1})})}),a(".dd-widget-image-delete-item",this.$modal).on("click",function(){b.removeInputImage(a(this).closest(".dd-widget-item-col"),a(a(this).data("target")))})):(this.log("digidesk Media Library not found, disable media actions...","warn"),a(".dd-media-action",this.$modal).attr("disabled","disabled").addClass("disabled")),"function"==typeof a().summernote&&(this.log("Setting summernote editor"),a(".dd-editor",this.$modal).each(function(){a(this).summernote({lang:"de-DE",minHeight:100,toolbar:[["style",["style"]],["formatting",["bold","italic","underline","strikethrough","superscript","clear"]],["fontsize",["fontsize"]],["color",["color"]],["layout",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","videoResponsive","hr"]],["misc",["codeview"]]],dialogsInBody:!0,buttons:{ddmedia:"ddmedia"},disableDragAndDrop:!0,onCreateLink:function(a){return 0===a.indexOf("[{")?a:(a&&(a=/^[A-Za-z][A-Za-z0-9+-.]*\:[\/\/]?/.test(a)?a:"http://"+a),a)},codeviewFilter:!0,codeviewIframeFilter:!0})}),a(".dd-widget-form",this.$modal).on("keypress",".note-image-dialog input, .note-link-dialog input",function(a){13===a.keyCode&&a.preventDefault()})),"function"==typeof a().minicolors&&(this.log("Setting minicolors picker"),a(".dd-color-picker",this.$modal).each(function(){a(this).minicolors({theme:"bootstrap"})})),"function"==typeof a().selectize){this.log("Setting selectize picker/boxes");var c=function(a,b){var c="",d=a.match(/(<i[^>]*class\=('|")fa[^"']*('|")[^>]*>[^<]*<\/i>)(.*)/);return d&&5===d.length&&(c=d[1],a=d[4]),c+b(a)};a(".dd-picker").each(function(){a(this).selectize({searchField:"label",labelField:"label",render:{option:function(a,b){return'<div class="option">'+c(a[this.settings.labelField],b)+"</div>"},item:function(a,b){return'<div class="item">'+c(a[this.settings.labelField],b)+"</div>"}}})})}a('[data-toggle="tooltip"]',this.$modal).length&&(this.log("Setting hint tooltips"),a('[data-toggle="tooltip"]',this.$modal).tooltip()),"function"==typeof a().areaselect&&(this.log("Setting areaselect plugin"),a(".dd-area-select").areaselect()),a(document).on("hidden.bs.modal",function(){a(".modal:visible").length&&a("body").addClass("modal-open")})},b.prototype.setWidgetSelector=function(){this.log("Prepare Widget selector");var b=this;a(".dd-widget-select-box",b.$modal).on("mouseenter",function(){a(this).css({"background-color":a(this).data("color"),"border-color":a(this).data("color"),color:"#fff"})}).on("mouseleave",function(){a(this).css({"background-color":"#f7f7f7","border-color":"#ccc",color:"#333"})}).on("click",function(c){a(".dd-widget-form-select",b.$modal).hide(),a(".dd-widget-form-fields",b.$modal).show(),a(".dd-widget-type-select")[0].selectize.setValue(a(this).data("widget")),a(".dd-tab-form",b.$modal).length&&a(".dd-tab-form .nav-tabs li:visible > a",b.$modal).first().tab("show"),c.preventDefault()})},b.prototype.add=function(c,d,e,f){if(this.log('Adding Widget "'+c+'"'),this.nestedgridstack&&"column"===c)return ddh.alert(ddh.translate("DD_VISUAL_EDITOR_NESTED_COLUMN_WARNING")),void("function"==typeof f&&f.call(this));var g=this;"function"==typeof e&&(f=e,e={}),void 0!==d&&d||(d={}),e=a.extend({},b.WIDGET_DEFAULTS,{size_x:g.options.defaultWidgetSize},"object"==typeof e&&e);var h=!1;e.col&&e.row?(e.col-=1,e.row-=1):(h=null==e.col||null==e.row)&&(e.col=0,e.row=0),this.log(d),this.log(e);var i="dd-veditor-widget",j='<div class="dd-widget-'+("column"===c?"nested-":"")+'data">';if("column"===c&&(j+='<a href="javascript:void(null)" class="dd-widget-action-movetarget" title="'+ddh.translate("DD_VISUAL_EDITOR_WIDGET_MOVETARGET")+'"><i class="fa fa-paste"></i></a>'),this.shortcodes[c])if("column"===c)h&&(e.size_x=this.options.gridSize),i+=" dd-veditor-column dd-widget-type-column",j+='<div class="grid-stack grid-stack-'+this.options.gridSize+' nested-grid"></div>';else{i+=" dd-widget-type-"+c;var k=d[this.shortcodes[c].previewParam],l=a.parseHTML(k,!1);l=a(l).text(),l.length>200&&(l=l.substr(0,197)+"...");var m=document.createElement("DIV");m.textContent=l;var n=m.innerHTML,o=d.icon||this.shortcodes[c].icon;j+='<span class="dd-widget-icon"><i class="fa '+o+'"></i></span>',j+='<span class="dd-widget-name">'+this.shortcodes[c].name+"</span>",j+='<span class="dd-widget-preview">'+n+"</span>"}j+="</div>",j+='<div class="dd-widget-actions">'+("column"===c?'<a href="javascript:void(null)" class="dd-widget-action-new-nested" title="'+ddh.translate("DD_VISUAL_EDITOR_ADD_WIDGET")+'"><i class="fa fa-plus"></i></a>':"")+'  <a href="javascript:void(null)" class="dd-widget-action-edit" title="'+ddh.translate("DD_VISUAL_EDITOR_WIDGET_EDIT")+'"><i class="fa fa-edit"></i></a>'+("column"===c?"":'  <a href="javascript:void(null)" class="dd-widget-action-duplicate" title="'+ddh.translate("DD_VISUAL_EDITOR_WIDGET_DUPLICATE")+'"><i class="fa fa-copy"></i></a>')+("column"===c?"":'  <a href="javascript:void(null)" class="dd-widget-action-move" title="'+ddh.translate("DD_VISUAL_EDITOR_WIDGET_MOVE")+'"><i class="fa fa-cut"></i></a>')+'  <a href="javascript:void(null)" class="dd-widget-action-delete" title="'+ddh.translate("DD_VISUAL_EDITOR_WIDGET_DELETE")+'"><i class="fa fa-trash"></i></a></div>';var p=a('<div class="grid-stack-item '+i+'" data-widget="'+c+'"><div class="grid-stack-item-content dd-widget-inner">'+j+"</div></div>");if(p.data("widget-params",d),this.nestedgridstack)var q=this.nestedgridstack;else var q=this.gridstack;q.addWidget(p,Math.floor(e.col),Math.floor(e.row),Math.floor(e.size_x),Math.floor(e.size_y),h),d.col_class&&g.setGridInfo(p,d.col_class),"column"===c&&(this.initializeNestedGrid(a(".nested-grid",p),p),"object"==typeof e.children&&e.children.length&&(g.nestedgridstack=a(".nested-grid",p).get(0).gridstack,a.each(e.children,function(a,b){g.add(b.widget,b.widget_params,b)}),g.nestedgridstack=null)),"function"==typeof f&&f.call(this,p,c,d)},b.prototype.replace=function(b,c,d,e,f){if("object"==typeof b&&b.length)if(this.log('Replacing Widget "'+c+'"'),this.log(b),b.hasClass("dd-veditor-column"))b.data("widget-params",d),d.col_class&&this.setGridInfo(b,d.col_class);else{var g=b.data("_gridstack_node");e=a.extend({col:g.x+1,row:g.y+1,size_x:g.width,size_y:g.height},"object"==typeof e&&e),this.remove(b),this.add(c,d,e,f)}},b.prototype.remove=function(a,b){this.log("Removing Widget"),this.log(a);var c;c=this.nestedgridstack?this.nestedgridstack:this.gridstack,c.removeWidget(a),"function"==typeof b&&b.call(this)},b.prototype.serialize=function(b){this.log("Serializing Widgets"),void 0===b&&(b=this.$grid);var c=[],d=this;return b.children(".grid-stack-item:visible").each(function(){var b=a(this).data("_gridstack_node"),e=a(this).data("widget"),f=a(this).data("widget-params"),g=[];"column"===e&&(g=d.serialize(a(".nested-grid",this))),c.push({row:b.y+1,col:b.x+1,size_x:b.width,size_y:b.height,widget:e,widget_params:f,children:g})}),c.sort(function(a,b){var c=10*a.row+a.col,d=10*b.row+b.col;return c<d?-1:c>d?1:0}),c},b.prototype.clear=function(){this.log("Clearing all Widgets"),this.gridstack.removeAll()},b.prototype.setGridInfo=function(b,c){if(b.length&&c&&("string"==typeof c&&""!==c||c.length)){"string"==typeof c&&(c=c.split(" ")),this.log("Set Grid info"),this.log(c),a(".dd-widget-col-css",b).length&&a(".dd-widget-col-css",b).remove();var d='<div class="dd-widget-col-css">  <ul class="list-inline">',e={xs:"fa fa-mobile",sm:"fa fa-tablet",md:"fa fa-laptop",lg:"fa fa-desktop"},f={};a.each(c,function(){var a=this.match(/^col\-([a-z]{2})\-([0-9]+)$/);return a?void(f[a[1]]?f[a[1]].match(/text\-danger/)||(f[a[1]]=a[2]+" (Offset "+f[a[1]]+")"):f[a[1]]=a[2]):(a=this.match(/^col\-([a-z]{2})\-offset\-([0-9]+)$/))?void(f[a[1]]?f[a[1]].match(/text\-danger/)||(f[a[1]]=f[a[1]]+" (Offset "+a[2]+")"):f[a[1]]=a[2]):(a=this.match(/^hidden\-([a-z]{2})$/),a?void(f[a[1]]='<span class="text-danger"><i class="fa fa-ban"></i></span>'):void 0)}),a.each(f,function(a){d+='<li><i class="'+e[a]+'"></i> '+this+"</li>"}),d+="</ul></div>",a(".dd-widget-inner",b).append(d)}},b.prototype.addInputImage=function(b,c){var d=a(".dd-widget-image-add-item",c),e=a(".dd-widget-image-item-helper",c).clone(!0).removeClass("dd-widget-image-item-helper"),f=a('<div class="dd-widget-item-col col-sm-2" />').append(e);return a("img",e).attr("src",this.options.resourceLink+b),e.data("file",b),d.parent().before(f),!(c.data("max-length")&&a(".dd-widget-item-col",c).length>=c.data("max-length"))||(d.hide(),!1)},b.prototype.removeInputImage=function(b,c){var d=a(".dd-widget-image-add-item",c);b.remove(),(!c.data("max-length")||a(".dd-widget-item-col",c).length<c.data("max-length"))&&d.show()},b.prototype.clearInputImages=function(b){b&&b.length||(b=this.$modal),a(".dd-widget-item-col",b).remove(),a(".dd-widget-image-add-item",b).show()},b.prototype.serializeInputImages=function(b){var c=[];return 1===b.data("multi")?a(".dd-widget-item-col",b).each(function(){c.push(a(".dd-widget-image-item",this).data("file"))}):c=a(".dd-widget-item-col .dd-widget-image-item",b).first().data("file"),c},b.prototype.addMoveTargetWidget=function(c){this.log("Adding target Widget");var d=this,e=a(".dd-veditor-grid").data("gs-current-row"),f={col:0,row:e+1,size_x:this.options.gridSize};f=a.extend({},b.WIDGET_DEFAULTS,{size_x:d.options.defaultWidgetSize},"object"==typeof f&&f);var g=!1;f.col&&f.row||(g=null==f.col||null==f.row)&&(f.col=0,f.row=0),this.log(f);var h=a('<div class="grid-stack-item move-target-widget"><a href="javascript:void(null)" class="grid-stack-item-content dd-widget-inner" title="'+ddh.translate("DD_VISUAL_EDITOR_WIDGET_MOVETARGET")+'"><i class="fa fa-paste"></i></a></div>');this.gridstack.addWidget(h,Math.floor(f.col),Math.floor(f.row),Math.floor(f.size_x),Math.floor(f.size_y),g),"function"==typeof c&&c.call(this,h)},b.prototype.removeMoveTargetWidget=function(b){this.log("Removing target Widget");var c=a(".move-target-widget");this.log(c),this.gridstack.removeWidget(c),"function"==typeof b&&b.call(this)},b.prototype.move=function(b,c,d){this.add(b,c,d,function(){var b=this.widgetToMove.closest(".nested-grid");b.length?this.nestedgridstack=b.get(0).gridstack:this.nestedgridstack=null,this.remove(this.widgetToMove,function(){this.nestedgridstack=null,this.widgetToMove=null,a(".dd-veditor-grid").removeClass("move-mode"),this.log("Moving mode off")})})},b.prototype.deactivateMoveMode=function(){var b=a(".move-source");b.length&&(this.log("Moving mode off"),b.removeClass("move-source"),this.widgetToMove=null,a(".dd-veditor-grid").removeClass("move-mode"),a(".move-target-widget").length&&this.removeMoveTargetWidget())},b.prototype.newWidget=function(b){this.log("Triggering new Widget"),this.clearModal(),this.modal(function(a,c){this.log("Saving new Widget"),this.add(a,c,b)}),a(".dd-widget-form-select",this.$modal).show(),a(".dd-widget-form-fields",this.$modal).hide()},b.prototype.editWidget=function(b,c){"object"==typeof b&&b.length&&(this.log("Triggering edit Widget"),this.clearModal(),this.fillModal(b.data("widget"),b.data("widget-params")),this.modal(function(a,d){this.log("Saving edited Widget"),this.replace(b,a,d,c)}),a(".dd-widget-form-select",this.$modal).hide(),a(".dd-widget-form-fields",this.$modal).show())},b.prototype.duplicateWidget=function(a,b){if("object"==typeof a&&a.length){var c=a.data("widget"),d=a.data("widget-params");this.log('Duplicating Widget "'+c+'"'),this.log(a);var e=a.data("_gridstack_node"),f={size_x:e.width,size_y:e.height};this.add(c,d,f,b)}},b.prototype.clearModal=function(){this.log("Clearing modal form"),this.clearInputImages(),a("input, textarea, select",this.$modal).not(".dd-widget-type-select").each(function(){if(!1!==a(this).data("editable"))if(a(this).is("input")){switch(a(this).attr("type")){case"checkbox":case"radio":a(this).prop("checked",!1);break;default:a(this).val(""),a(this).data("default-value")&&a(this).val(a(this).data("default-value")),a(this).data("random-value")&&a(this).val(Math.floor(4294967296*(1+Math.random())))}a(this).hasClass("dd-color-picker")&&"function"==typeof a().minicolors&&(a(this).minicolors("value",""),a(this).data("default-value")&&a(this).minicolors("value",a(this).data("default-value"))),this.selectize&&(this.selectize.setValue(""),a(this).data("default-value")&&this.selectize.setValue(a(this).data("default-value")))}else a(this).val(""),a(this).data("default-value")&&a(this).val(a(this).data("default-value")),a(this).data("random-value")&&a(this).val(Math.floor(4294967296*(1+Math.random()))),this.selectize&&(this.selectize.setValue(""),a(this).data("default-value")&&this.selectize.setValue(a(this).data("default-value"))),a(this).hasClass("dd-editor")&&"function"==typeof a().summernote&&(a(this).summernote("code",""),a(this).data("default-value")&&a(this).summernote("code",a(this).data("default-value")),a(this).summernote("codeview.isActivated")&&a(this).summernote("codeview.deactivate"))})},b.prototype.fillModal=function(b,c){var d=this;this.log("Filling modal form"),this.log(b),this.log(c),a(".dd-widget-type-select",this.$modal)[0].selectize.setValue(b),a.each(c,function(c,e){if("class"===c){var f=a(".dd-widget-class",d.$modal)[0].selectize,g=e.split(" ");for(var h in g)f.addOption({label:g[h],value:g[h]});return f.refreshOptions(!1),void f.setValue(g)}if("col_class"===c&&("string"==typeof e&&""!==e||e.length))return"string"==typeof e&&(e=e.split(" ")),void a.each(e,function(){var b=this.match(/^col\-([a-z]{2})\-([0-9]+)$/),c=null;return b?(c=a('*[name="col_size['+b[1]+']"]',d.$modal),void(c.length&&c[0].selectize.setValue(b[2]))):(b=this.match(/^col\-([a-z]{2})\-offset\-([0-9]+)$/))?(c=a('*[name="col_offset['+b[1]+']"]',d.$modal),void(c.length&&c[0].selectize.setValue("0"===b[2]?"none":b[2]))):(b=this.match(/^hidden\-([a-z]{2})$/),b?(c=a('*[name="hide_device['+b[1]+']"]',d.$modal),void(c.length&&c.prop("checked",!0))):void 0)});var i=a('*[name="'+b+"["+c+"]"+("object"==typeof e?"[]":"")+'"]',d.$modal).last();if(!i.length){var j=a("#elm_widget_images_"+b+"_"+c);return void(j.length&&("string"==typeof e&&(e=[e]),a.each(e,function(a,b){d.addInputImage(b,j)})))}if("checkbox"===i.attr("type")?e&&i.prop("checked",!0):i.val(e),i.hasClass("dd-editor")&&"function"==typeof a().summernote){var k=i.data("summernote");i.summernote("code",e),k.invoke("codeview.activate"),k.invoke("codeview.deactivate")}i.hasClass("dd-color-picker")&&"function"==typeof a().minicolors&&i.minicolors("value",e),i[0].selectize&&(i.hasClass("dd-data-picker")?i[0].selectize.load(function(b){a.ajax({url:d.options.actionLink+"&fnc=doShortCodeAction&action="+i.data("action")+"&shortcode="+i.data("shortcode")+"&value="+e,type:"GET",error:function(){b()},success:function(a){b(a),i[0].selectize.setValue(e)}})}):i[0].selectize.setValue(e))})},b.prototype.modal=function(b,c){var d=this;this.log("Showing modal"),"function"==typeof b&&(c=b,b={}),b=a.extend({backdrop:!1,keyboard:!1,show:!0},"object"==typeof b&&b),this.$modal.one("show.bs.modal",function(){d.log("Modal shown"),a(".dd-widget-form",d.$modal).one("submit",function(b){b.preventDefault(),d.log("Triggering form submit");var e={},f=a("#elm_widget_type",this).val(),g=a("#elm_widget_class",this).val(),h=[];a.each(a(this).serializeArray(),function(){var b=this.name.match(new RegExp("^"+f+"\\[([^\\]]*)\\](\\[?)"));if(null!==b&&3===b.length)if(b[2].length)e[b[1]]||(e[b[1]]=[]),e[b[1]].push(this.value);else{var c=a('*[name="'+this.name+'"]');if("function"==typeof a().summernote&&c.hasClass("dd-editor")){var d=c.data("summernote");d.invoke("codeview.isActivated")&&d.invoke("codeview.deactivate"),d.invoke("codeview.activate"),e[b[1]]=c.summernote("code")}else e[b[1]]=this.value}if(""!==this.value){var g=this.name.match(new RegExp(/^(col_offset|col_size|hide_device)\[([^\]]*)\]/));if(null!==g&&3===g.length)switch(g[1]){case"col_size":h.push("col-"+g[2]+"-"+this.value);break;case"col_offset":if("xs"===g[2]&&"none"===this.value)break;h.push("col-"+g[2]+"-offset-"+("none"===this.value?"0":this.value));break;case"hide_device":h.push("hidden-"+g[2])}}}),e.class=g,h.length&&(e.col_class=h.join(" "));var i=a('.dd-widget-image-list[data-input-name^="'+f+'"]');i.length&&i.each(function(){var b=a(this).data("input-name").match(new RegExp("^"+f+"\\[([^\\]]*)\\](\\[?)"));b&&(e[b[1]]=d.serializeInputImages(a(this)))}),"function"==typeof c&&!1===c.call(d,f,e)||d.$modal.modal("hide")})}).one("shown.bs.modal",function(){a(".dd-tab-form",d.$modal).length&&a(".dd-tab-form .nav-tabs li:visible > a",d.$modal).first().tab("show")}).one("hidden.bs.modal",function(){a('a[href="#tab_widget_main"]',d.$modal).parent().show(),a(".dd-widget-form",d.$modal).off("submit"),d.nestedgridstack=null}).modal(b)},window.VisualEditor=b}(jQuery),function(a){"use strict";var b={},c=!1,d=!1,e=null,f=null,g={},h=function(){return null==e&&(e=a("#elm_lang")),e.val()},i=function(){return null==f&&(f=a(".dd-ajax-loader.dd-content-loader")),f},j=function(){if(c){var d=a(".dd-veditor-wrapper",b.$container).height();a("textarea",b.$source).css("height",d+"px")}},k=function(e,f){"function"==typeof e&&(f=e);var g=!1;if("string"!=typeof e?e=a("textarea",b.$source).val():g=!0,d&&(d=!1,a(".dd-veditor-css-action, .dd-veditor-template-action, .dd-veditor-source-action, .dd-veditor-delete-all-action").removeClass("disabled"),a("#elm_edit_hide_title, #elm_edit_islanding, #elm_edit_fullwidth, #elm_edit_cssclass").prop("disabled",!1)),c||g)if(i().show(),c=!1,a(".dd-veditor-widget-action, .dd-veditor-media-action, .dd-veditor-column-action").removeClass("disabled"),a(".dd-veditor-source-action").attr("data-original-title",ddh.translate("DD_VISUAL_EDITOR_SHOW_SOURCE")).html('<i class="fa fa-code"></i>').tooltip("hide"),b.clear(),b.$grid.show(),b.$source.hide(),e){var j=h(),k="&editlanguage="+j+"&source="+encodeURIComponent(e);a.post(b.options.actionLink+"&fnc=getWidgets",k,function(c){a.each(c,function(){b.add(this.widget,this.widget_params,this)}),i().hide(),"function"==typeof f&&f(e,b)})}else i().hide(),"function"==typeof f&&f(e,b);else"function"==typeof f&&f(e,b)},l=function(e){if(d&&(d=!1,a(".dd-veditor-css-action, .dd-veditor-template-action, .dd-veditor-source-action, .dd-veditor-delete-all-action").removeClass("disabled"),a("#elm_edit_hide_title, #elm_edit_islanding, #elm_edit_fullwidth, #elm_edit_cssclass").prop("disabled",!1)),c)"function"==typeof e&&e(a("textarea",b.$source).val(),b);else{i().show(),c=!0;var f=h(),g="&editlanguage="+f;a(".dd-veditor-widget-action, .dd-veditor-media-action, .dd-veditor-column-action").addClass("disabled"),a(".dd-veditor-source-action").attr("data-original-title",ddh.translate("DD_VISUAL_EDITOR_SHOW_WIDGETS")).html('<i class="fa fa-puzzle-piece"></i>').tooltip("hide"),a.each(b.serialize(),function(){g+="&widget["+this.row+"]["+this.col+"]="+encodeURIComponent(JSON.stringify(this))}),b.$grid.hide(),b.$source.show().find("textarea").val(""),g.match(/widget/)?a.post(b.options.actionLink+"&fnc=getSource",g,function(a){b.$source.show().find("textarea").val(a),j(),i().hide(),"function"==typeof e&&e(a,b)}):(j(),i().hide(),"function"==typeof e&&e("",b))}},m=function(a){c?k(a):l(a)},n=function(e){c||l(),d=!0,a(".dd-veditor-css-action, .dd-veditor-template-action, .dd-veditor-source-action, .dd-veditor-delete-all-action").addClass("disabled"),a("#elm_edit_hide_title, #elm_edit_islanding, #elm_edit_fullwidth, #elm_edit_cssclass").prop("disabled",!0),"function"==typeof e&&e(a("textarea",b.$source).val(),b)},o=function(){var b=a("#settings"),c=b.outerHeight()-a(".tab-content",b).position().top-a(".dd-veditor-form-actions",b).outerHeight()-1;a(".tab-content",b).height(c)},p=function(c){var e=h();a("input[name=selectedlanguage]").val(e),b.clear(),a("textarea",b.$source).val("");var f=function(){var f="function"==typeof a().selectize;c&&"object"==typeof c?(i().show(),a.each(c,function(b,c){if(-1===b.indexOf("$")){null==g[b]?g[b]={id:b}:null==g[b].id&&(g[b].id=b);var d=g[b],e="#elm_edit_"+d.id;"date"===d.type&&(c="0000-00-00"===c?"":c);var h=a(e);if(h.length>=1)"checkbox"===d.type?h.prop("checked","1"===c):"select"===d.type&&f?h[0].selectize.setValue(c):h.val(c);else{b in{desc:"",fullurl:"",type:"",fullwidth:"",newinlang:"",fromlang:"",seo:"",url:"",isactive:""}||console.log("element "+e+" ("+b+") not found please check template and field definition/data")}}}),(c.active_from&&"0000-00-00"!=c.active_from||c.active_until&&"0000-00-00"!=c.active_until)&&(a(".dd-veditor-timespan").show(),a(".dd-veditor-timespan-toggle").html(ddh.translate("DD_VISUAL_EDITOR_ACTIVE_TIMESPAN_HIDE"))),a('input[name="editval[oxcontents__oxtype]"][value="'+c.type+'"]').prop("checked",!0),"object"==typeof c.seo&&(a("input#elm_seo_fixed").prop("checked","1"==c.seo.fixed),a("input#elm_seo_url").val(c.seo.url),a("textarea#elm_seo_keywords").val(c.seo.keywords),a("textarea#elm_seo_description").val(c.seo.description)),c.type&&"0"!=c.type?("2"==c.type?a(".dd-cms-cat").show():a(".dd-cms-cat").hide(),a(".dd-cms-url").show(),
c.newinlang?a(".dd-cms-url .form-control-static").html('<code>-</code><br><br><small class="text-info">'+ddh.translate("DD_VISUAL_EDITOR_NO_LANG_INFO").replace("%s",c.fromlang)+"</small>"):a(".dd-cms-url .form-control-static").html('<a href="'+c.fullurl+'" target="_blank"><code>'+c.url+"</code></a>")):a(".dd-cms-url, .dd-cms-cat").hide(),a(".dd-cms-snippet").show(),a("#elm_snippet").val('[{oxcontent ident="'+c.ident+'"}]'),d?a.get(b.options.actionLink+"&fnc=getSource&editlanguage="+e+"&id="+c.id,function(a){b.$source.show().find("textarea").val(a),j(),i().hide()}):a.get(b.options.actionLink+"&fnc=getWidgets&editlanguage="+e+"&id="+c.id,function(c){a.each(c,function(){b.add(this.widget,this.widget_params,this)}),i().hide()}),c&&c.id?a(".dd-delete-action").removeAttr("disabled"):a(".dd-delete-action").attr("disabled",!0)):(a.each(g,function(b,c){var d=c.id?c.id:b;d="#elm_edit_"+d;var e=null==c.defaulValue?c.defaulValue:"",g=a(d);"checkbox"===c.type?g.prop("checked",!1):"select"===c.type&&f?g[0].selectize.setValue(e):g.val(e)}),a(".dd-cms-snippet #elm_snippet").val(""),a(".dd-cms-url .form-control-static").html("<code>-</code>"),a(".dd-cms-url").hide(),a(".dd-veditor-timespan").hide(),a(".dd-veditor-timespan-toggle").html(ddh.translate("DD_VISUAL_EDITOR_ACTIVE_TIMESPAN_SELECT")),a('input[name="editval[oxcontents__oxtype]"][value="0"]').prop("checked",!0),a("input#elm_seo_fixed").prop("checked",!1),a("input#elm_seo_url").val(""),a("textarea#elm_seo_keywords").val(""),a("textarea#elm_seo_description").val(""),a(".dd-veditor-grid ul").css("height","auto"),a(".dd-delete-action").attr("disabled",!0)),o()};c&&"1"===c.plaintext?n(f):k(f)},q=function(c){if(a("#elm_edit_cms").length){var d=a("#elm_edit_cms");d[0].selectize.clearOptions(),d[0].selectize.load(function(e){var f=a("#elm_lang").val();a.ajax({url:b.options.actionLink+"&fnc=searchContents&editlanguage="+f+"&all=1&definition=1",type:"GET",error:function(){e()},success:function(a){a.fields_definition&&(g=a.fields_definition,delete a.fields_definition,a=Object.keys(a).map(function(b){return a[b]})),e(a),c?d[0].selectize.setValue(c):d[0].selectize.setValue("")}})})}},r=function(){ddh.confirm(ddh.translate("DD_VISUAL_EDITOR_LOAD_DEMODATA_INFO"),function(){a.get(b.options.actionLink+"&fnc=searchContents&editlanguage="+h()+"&block=0&ident=oxdemopage",function(a){a&&a.length&&q(a[0].id)})})};a(window).on("load",function(){window.preloadid&&window.history.replaceState({},document.title,location.href.replace(/\&preloadid=[a-z0-9\.\-\_]*/,"")),q(window.preloadid),a(".dd-main-loader").remove(),o()}).on("resize",function(){j(),o()}),a(function(){if(window.shortcodes){if(void 0!==window.debug&&!0===window.debug&&(VisualEditor.DEBUG=!0),"object"==typeof MediaLibrary&&(window.options=window.options||{},window.options.actionLink=MediaLibrary._actionLink?MediaLibrary._actionLink+"&cl=ddoevisualcmsadmin":location.href,window.options.resourceLink=MediaLibrary._resourceLink?MediaLibrary._resourceLink:null),b=new VisualEditor(window.shortcodes,window.options),b.$source=a(".dd-veditor-source",b.$container),window.VisualEditorInstance=b,a("*[data-toggle=tooltip]").tooltip(),"function"==typeof a().selectize){a(".dd-cms-picker").each(function(){a(this).selectize({valueField:"id",labelField:"title",searchField:["title","desc"],create:!1,render:{option:function(a,b){return'<div class="media"><div class="media-left"><i class="fa fa-circle'+(a.isactive?" active":"")+'"></i></div><div class="media-body"><strong class="media-heading name">'+b(a.title)+"</strong><br/><small>"+a.desc+"</small></div></div>"}},load:function(c,d){if(!c.length)return d();var e=h(),f=this.$input.is("#elm_tmpl_timer_cms")?1:0;a.ajax({url:b.options.actionLink+"&fnc=searchContents&editlanguage="+e+"&block="+f+"&search="+encodeURIComponent(c),type:"GET",error:function(){d()},success:function(a){d(a)}})},onChange:function(a){this.$input.is("#elm_edit_cms")&&p.call(this,a&&this.options[a]?this.options[a]:null)}})});var e=a(".dd-article-picker, .dd-category-picker, .dd-manufacturer-picker");e.length&&e.selectize({valueField:"id",labelField:"title",searchField:["title","description"],create:!1,render:{option:function(a,b){return'<div class="media"><div class="media-body"><strong class="media-heading name">'+b(a.title)+"</strong>"+(a.description?"<br/><small>"+b(a.description)+"</small>":"")+"</div></div>"}},load:function(c,d){if(!c.length)return d();var e=a("#elm_lang").val(),f=a("#elm_edit_object_type").val();a.ajax({url:b.options.actionLink+"&fnc=searchObjects&type="+f+"&editlanguage="+e+"&search="+encodeURIComponent(c),type:"GET",error:function(){d()},success:function(a){d(a)}})},onChange:function(c){if(c){var d=a("#elm_edit_block").val(),e=a("#elm_edit_object_type").val(),f=a("#elm_lang").val();a.get(b.options.actionLink+"&fnc=searchBlock&editlanguage="+f+"&block="+d+"&objecttype="+e+"&objectid="+c,function(a){p.call(this,a)})}else p.call(this,null)}}),a(".dd-form-picker").each(function(){a(this).selectize({render:{option:function(a,b){return'<div class="option"'+(a.color?' style="color: '+a.color+'"':"")+">"+b(a[this.settings.labelField])+"</div>"}}})})}if(a("input#elm_edit_new").change(function(){var b=a("input#elm_edit_ident");a(this).is(":checked")?(a(".dd-cms-search, .dd-cms-type-infos").hide(),b.data("old-ident",b.val()),b.val("")):(a(".dd-cms-search, .dd-cms-type-infos").show(),""===b.val()&&b.data("old-ident")&&b.val(b.data("old-ident")))}),a("select#elm_lang").change(function(){var c=a("#elm_edit_cms"),d=c.val(),e=a(this).val(),f=a("#elm_tmpl_timer_cms");if(f.length&&"object"==typeof f[0].selectize&&f[0].selectize.clearOptions(),d){var g=this,h=a('option[value="'+e+'"]',this).text();a.ajax({url:b.options.actionLink+"&fnc=searchContents&editlanguage="+e+"&id="+d,type:"GET",success:function(c){var f=c.length&&c[0].newinlang,i=[{html:'<button type="button" class="btn btn-default" data-dismiss="modal">'+ddh.translate("DD_VISUAL_EDITOR_LANG_CHANGE_CANCEL")+"</button>",action:function(b){b.modal("hide"),a(g).val(a("input[name=selectedlanguage]").val())}},{html:'<button type="button" class="btn btn-warning">'+ddh.translate("DD_VISUAL_EDITOR_LANG_CHANGE_OVERWRITE")+"</button>",action:function(c){var g=a("#myedit");g.one("saved.ve.content",function(a){a.preventDefault(),location.href=b.options.actionLink+"&editlanguage="+e+"&preloadid="+d}),f?(c.modal("hide"),g[0].fnc.value="save",g.submit()):ddh.confirm(ddh.translate("DD_VISUAL_EDITOR_LANG_CHANGE_OVERWRITE_CONFIRM").replace("%s",h),function(){c.modal("hide"),g[0].fnc.value="save",g.submit()})}},{html:'<a href="'+b.options.actionLink+"&editlanguage="+e+"&preloadid="+d+'" class="btn btn-primary">'+ddh.translate("DD_VISUAL_EDITOR_LANG_CHANGE_LOAD")+"</a>"}],j=ddh.translate("DD_VISUAL_EDITOR_LANG_CHANGE_TITLE"),k=ddh.translate("DD_VISUAL_EDITOR_LANG_CHANGE_MSG");ddh._dialog(k,j,i,"md")}})}else location.href=b.options.actionLink+"&editlanguage="+e}),a(".dd-veditor-source-action").on("click",function(){a(this).hasClass("disabled")||m()}),a("#elm_edit_plaintext").on("change",function(){a(this).prop("checked")?n():k()}),a("#myedit").on("submit",function(e){e.preventDefault(),a("button.btn-success",this).attr("disabled",!0),i().show();var f=this,g=a(this).serialize();c?g+="&source="+encodeURIComponent(a(".dd-veditor-source textarea").val()):a.each(b.serialize(),function(){g+="&widget["+this.row+"]["+this.col+"]="+encodeURIComponent(JSON.stringify(this))});var j=h();g+="&editlanguage="+j,a.post(a(this).attr("action"),g,function(b){var c=a.Event("saved.ve.content");if(a(f).trigger(c,[b]),a("button.btn-success",f).removeAttr("disabled"),!c.isDefaultPrevented()){if(b.error)return ddh.alert(b.msg),void i().hide();if(b.url)i().hide(),window.ddcontentpreview&&!window.ddcontentpreview.closed?(window.ddcontentpreview.location.href=b.url,window.ddcontentpreview.focus()):window.ddcontentpreview=window.open(b.url,"_blank","scrollbars=1, width="+.8*screen.width+", height="+.8*screen.height);else{if(!b.id)return q(),void i().hide();var e=function(){b.new&&a("input#elm_edit_new").prop("checked",!1).change(),q(b.id),a(".dd-delete-action").removeAttr("disabled")};d?n(e):k(e)}}})}),"undefined"!=typeof Clipboard){new Clipboard(".dd-clipboard-action").on("success",function(b){var c=a(b.trigger).closest(".form-group");c.addClass("has-feedback"),window.setTimeout(function(){c.removeClass("has-feedback")},2e3)})}a(".dd-block-picker").change(function(){""!==a(this).val()?a(".dd-cms-object-type").show():a(".dd-cms-object-type").hide();var b=a(".dd-block-object-picker").val();if(b)if("empty"!==b){var c=a(".dd-cms-object-id:visible select");c.length&&c[0].selectize&&c[0].selectize.setValue(c.val())}else a(".dd-block-object-picker").trigger("change")}),a(".dd-block-object-picker").change(function(){if("empty"===a(this).val()){var c=a("#elm_lang").val(),d=a("#elm_edit_block").val();a.get(b.options.actionLink+"&fnc=searchBlock&editlanguage="+c+"&block="+d+"&objecttype=empty",function(b){b&&b.id?a(".dd-delete-block-action").removeAttr("disabled"):a(".dd-delete-block-action").attr("disabled",!0),p.call(this,b)})}else""!==a(this).val()?a(".dd-cms-object-id select").each(function(){this.selectize.setValue("")}):p()}),a(".dd-delete-action").on("click",function(b){b.preventDefault(),ddh.confirm(ddh.translate("DD_VISUAL_EDITOR_DELETE_CONFIRM"),function(){a("#myedit").submit()})}),a(".dd-veditor-template-action").on("click",function(){a(this).hasClass("disabled")||a(".dd-templates-modal").modal({backdrop:!1,keyboard:!1,show:!0})}),a(".dd-template-action-save").on("click",function(b){b.preventDefault(),a(".dd-template-form input[name=source]").val(""),a(".dd-template-form input[name=oxid]").val(""),a(".dd-template-form input[name=fnc]").val("save"),a(".dd-template-form").submit()});var f=a(".dd-template-timer-modal");f.modal({backdrop:!1,keyboard:!1,show:!1}),a(".dd-templates-modal").on("click",".dd-template-action-preview",function(c){c.preventDefault();var d=a(this).closest("li").data("oxid");a(".dd-template-form input[name=oxid]").val(d),a(".dd-template-form input[name=fnc]").val("savePreview"),a.get(b.options.actionLink+"&fnc=getTemplate&id="+d,function(b){a(".dd-template-form input[name=source]").val(b),a(".dd-template-form").submit()})}).on("click",".dd-template-action-delete",function(c){c.preventDefault();var d=a(this).closest("li"),e=d.data("oxid");e&&ddh.confirm(ddh.translate("DD_VISUAL_EDITOR_DELETE_TEMPLATE_CONFIRM"),function(){a.get(b.options.actionLink+"&fnc=delete&oxid="+e,function(){d.remove()})})}).on("click",".dd-template-action-apply",function(c){c.preventDefault();var d=a(this).closest("li"),e=d.data("oxid");e&&ddh.confirm(ddh.translate("DD_VISUAL_EDITOR_APPLY_TEMPLATE_CONFIRM"),function(){a.get(b.options.actionLink+"&fnc=getTemplate&id="+e,function(b){k(b,function(){a(".dd-templates-modal").modal("hide")})})})}).on("click",".dd-template-action-timer",function(c){c.preventDefault();var d=a(this).closest("li"),e=d.data("oxid"),g=a(".dd-ajax-loader.dd-template-loader");g.show();var i=a(".dd-ajax-loader.dd-template-timer-loader");i.show();var j=h();a.get(b.options.actionLink+"&fnc=getTemplateData&editlanguage="+j+"&id="+e,function(b){g.hide(),b?(a("#elm_tmpl_timer_oxid").val(b.id),a("#elm_tmpl_timer_name").text(b.title),a("#elm_tmpl_timer_date").val(b.targetdate&&"0000-00-00"!=b.targetdate.substr(0,10)?b.targetdate:""),q(b.targetid?b.targetid:""),i.hide()):i.hide(),f.modal("show")})}),a(".dd-template-form .form-control").on("keypress",function(b){13==b.keyCode&&(a(".dd-template-form input[name=source]").val(""),a(".dd-template-form input[name=oxid]").val(""),a(".dd-template-form input[name=fnc]").val("save"))}),a(".dd-template-timer-form").on("submit",function(b){b.preventDefault();var c=a(this),d=c.serialize();a(".dd-ajax-loader.dd-template-timer-loader").show(),a.post(c.attr("action"),d,function(b){if(!b.error){if(b.tmpl){var c=a('.dd-templates-modal .list-group-item[data-oxid="'+b.tmpl.id+'"]'),d=c.find(".dd-target-active-info");if(b.tmpl.targetid&&"0000-00-00 00:00:00"!=b.tmpl.targetdate){if(!d.length){d=a('<small class="text-muted dd-target-active-info"></small>');var e=c.find(".clearfix > .pull-left");e.append("<br />"),e.append(d)}var f=ddh.translate("DD_VISUAL_EDITOR_TEMPLATE_TIMER_ACTIVE_INFO").replace("%s",b.tmpl.targettitle?b.tmpl.targettitle:b.tmpl.targetident).replace("%s",b.tmpl.targetdate.substr(0,10)).replace("%s",b.tmpl.targetdate.substr(11,5));d.html('<i class="fa fa-check"></i> '+f)}else d.length&&(d.prev().remove(),d.remove())}a(".dd-template-timer-modal").modal("hide")}})}),a(".dd-template-form").on("submit",function(c){c.preventDefault();var d=a(this),e=d.serialize();if("save"==a('input[name="fnc"]',d).val()){if(""===a('input[name="editval[oxcontents__oxtitle]"]',d).val())return;a.each(b.serialize(),function(){e+="&widget["+this.row+"]["+this.col+"]="+encodeURIComponent(JSON.stringify(this))})}var f=a(".dd-ajax-loader.dd-template-loader");f.show();var g=h();e+="&editlanguage="+g,a.post(d.attr("action"),e,function(b){if(b.error)ddh.alert(b.msg);else if(b.url)window.ddcontentpreview&&!window.ddcontentpreview.closed?(window.ddcontentpreview.location.href=b.url,window.ddcontentpreview.focus()):window.ddcontentpreview=window.open(b.url,"_blank","scrollbars=1, width="+.8*screen.width+", height="+.8*screen.height);else if(b.id){var c=a(".dd-templates-modal .dd-veditor-templates");a(".no-data",c).length&&a(".no-data",c).remove();var e=a('<li class="list-group-item" />').attr("data-oxid",b.id),g=a('<div class="clearfix" />').appendTo(e),h=a('<div class="pull-left" />').appendTo(g);h.append("<span>"+b.title+"</span>");var i=a('<div class="pull-right" />').appendTo(g);i.append('<button type="button" class="btn btn-xs btn-link dd-template-action-apply"><i class="fa fa-plus"></i></button>'),i.append('<button type="button" class="btn btn-xs btn-link dd-template-action-timer"><i class="fa fa-clock-o"></i></button>'),i.append('<button type="button" class="btn btn-xs btn-link dd-template-action-preview"><i class="fa fa-external-link"></i></button>'),i.append('<button type="button" class="btn btn-xs btn-link dd-template-action-delete"><i class="fa fa-trash"></i></button>'),c.prepend(e),a('input[name="editval[oxcontents__oxtitle]"]',d).val("")}f.hide()})}),a(".dd-veditor-timespan-toggle").on("click",function(){var b=a(".dd-veditor-timespan");b.is(":visible")?(b.hide(),a(this).html(ddh.translate("DD_VISUAL_EDITOR_ACTIVE_TIMESPAN_SELECT"))):(b.show(),a(this).html(ddh.translate("DD_VISUAL_EDITOR_ACTIVE_TIMESPAN_HIDE"))),o()}),a(".dd-demodata-action").on("click",function(){var c=a(this);c.hasClass("hasDemodata")?r():(c.html('<i class="fa fa-cog fa-spin"></i>'),c.prop("disabled",!0),a.get(b.options.actionLink+"&fnc=installDemodata&editlanguage="+h(),function(a){c.prop("disabled",!1),a&&a.success&&(c.addClass("hasDemodata"),c.html(ddh.translate("DD_VISUAL_EDITOR_LOAD_DEMODATA")),r())}))});var g=ace.edit(a(".dd-less-editor")[0]);g.setTheme("ace/theme/xcode"),g.getSession().setMode("ace/mode/less");var j=a(".dd-css-modal");j.modal({backdrop:!1,keyboard:!1,show:!1}).on("show.bs.modal",function(){g.setValue(a("#elm_edit_css").val())}),a(".dd-css-form").on("submit",function(b){b.preventDefault(),a("#elm_edit_css").val(g.getValue()),j.modal("hide")}),a(".dd-veditor-css-action").on("click",function(){a(this).hasClass("disabled")||j.modal("show")});var l=a(".dd-treeview-modal"),s=a(".dd-treeview-form"),t=a("#dd-treeview-main-inner"),u=a("#dd-treeview-snippets-inner"),v=a(".dd-treeview-search-main"),w=a(".dd-treeview-search-snippets"),x=a(".dd-treeview-main-loader"),y=a(".dd-treeview-snippets-loader"),z=!1,A=!1;if(l.modal({backdrop:!1,keyboard:!1,show:!1}).on("hidden.bs.modal",function(){s.trigger("reset"),t.jstree(!0).clear_search(),t.jstree(!0).close_all(),u.jstree(!0).clear_search(),u.jstree(!0).close_all(),a("#btn_tab_treeview_main").tab("show"),x.hide(),y.hide()}),s.on("submit",function(b){b.preventDefault();var c=a("#elm_edit_treeview_contentid").val();l.modal("hide");var d=a("#elm_edit_cms");d.length&&"object"==typeof d[0].selectize&&d[0].selectize.setValue(c)}),a(".dd-veditor-treeview-action").on("click",function(){a(this).hasClass("disabled")||(t.jstree(!0).refresh(),u.jstree(!0).refresh(),l.modal("show"))}),a("#btn_clear_treeview_search_main").on("click",function(){v.val(""),t.jstree(!0).show_all(),t.jstree(!0).clear_search(),t.jstree(!0).close_all(),a("#btn_clear_treeview_search_main").hide(),x.hide()}),a("#btn_clear_treeview_search_snippets").on("click",function(){w.val(""),u.jstree(!0).show_all(),u.jstree(!0).clear_search(),u.jstree(!0).close_all(),a("#btn_clear_treeview_search_snippets").hide(),y.hide()}),v.on("input",function(){""===v.val()?(a("#btn_clear_treeview_search_main").hide(),t.jstree(!0).clear_search()):a("#btn_clear_treeview_search_main").show()}),w.on("input",function(){""===w.val()?(a("#btn_clear_treeview_search_snippets").hide(),u.jstree(!0).clear_search()):a("#btn_clear_treeview_search_snippets").show()}),t.on("move_node.jstree",function(c,d){a.get(b.options.actionLink+"&fnc=saveTreeviewNode&id="+d.node.id+"&parentid="+d.parent+"&pos="+d.position+"&oldparentid="+d.old_parent+"&oldpos="+d.old_position)}).on("changed.jstree",function(b,c){a("#elm_edit_treeview_contentid").val(""+c.instance.get_node(c.selected[0]).id)}).on("dnd_start.vakata.jstree",function(){a("#jstree-marker").appendTo(".dd-treeview-modal")}).on("search.jstree",function(b,c){x.show(),0===c.nodes.length&&(t.jstree(!0).hide_all(),a(".dd-treeview-main-no-results").show()),x.hide()}).on("clear_search.jstree",function(){x.hide()}).on("show_all.jstree",function(){a(".dd-treeview-main-no-results").hide()}).jstree({core:{animation:250,force_text:!0,check_callback:!0,themes:{name:"default",stripes:!0,dots:!0,responsive:!0},data:{url:b.options.actionLink+"&fnc=getTreeviewNodes&type=main",data:function(a){return{id:a.id}}}},dnd:{copy:!1,inside_pos:"last",large_drop_target:!0},search:{show_only_matches:!0,show_only_matches_children:!0,ajax:{url:b.options.actionLink+"&fnc=searchTreeviewNodes&type=main"}},plugins:["dnd","search"]}),u.on("changed.jstree",function(b,c){a("#elm_edit_treeview_contentid").val(c.instance.get_node(c.selected[0]).id)}).on("search.jstree",function(b,c){y.show(),0===c.nodes.length&&(u.jstree(!0).hide_all(),a(".dd-treeview-snippets-no-results").show()),y.hide()}).on("clear_search.jstree",function(){y.hide()}).on("show_all.jstree",function(){a(".dd-treeview-snippets-no-results").hide()}).jstree({core:{animation:250,check_callback:!0,force_text:!0,themes:{name:"default",stripes:!0,dots:!0,responsive:!0},data:{url:b.options.actionLink+"&fnc=getTreeviewNodes&type=snippets",data:function(a){return{id:a.id}}}},search:{show_only_matches:!0,show_only_matches_children:!0,ajax:{url:b.options.actionLink+"&fnc=searchTreeviewNodes&type=snippets"}},plugins:["search"]}),v.keyup(function(){z&&clearTimeout(z),z=setTimeout(function(){t.jstree(!0).show_all(),x.show(),t.jstree(!0).search(v.val())},250)}),w.keyup(function(){A&&clearTimeout(A),A=setTimeout(function(){u.jstree(!0).show_all(),y.show(),u.jstree(!0).search(w.val())},250)}),"function"==typeof a().selectize){var B=[];if(window.cssclasses&&window.cssclasses.length)for(var C in window.cssclasses)B.push({label:window.cssclasses[C],value:window.cssclasses[C]});a(".dd-widget-class").selectize({delimiter:" ",persist:!1,maxItems:null,valueField:"value",labelField:"label",searchField:["label"],options:B,create:function(a){return{label:a,value:a}}})}}})}(jQuery);
//# sourceMappingURL=backend.min.js.map